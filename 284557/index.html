

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="" prefix="og: http://ogp.me/ns# profile: http://ogp.me/ns/profile#">
    
    
    
    

    
    <head>
        <meta id="CompatabilityMode" http-equiv="X-UA-Compatible" content="IE=edge" />
	    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../assets/StyleSheet.css" id="MasterCss" rel="stylesheet" type="text/css" />
        <link rel="SHORTCUT ICON" href="../assets/favicon.ico" />
        <title>patterns &#38; practices - Unity - How can I create a class instance from inside my method&#63;</title>
        
       
                    <script src="../assets/mscc-0.3.6.min.js"></script>
        
                    <link rel="stylesheet" type="text/css" href="../assets/mscc-0.3.6.min.css" />
        
            <script type="text/javascript">
                var msccHadCookieBannerAtPageStart = true;
            </script>
        

        <!--
        Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code,
        not by Microsoft.  See ASP.NET Ajax CDN Terms of Use â€“ http://www.asp.net/ajaxlibrary/CDN.ashx.
        -->
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.4.4.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery === 'undefined') {
                document.write(unescape("%3Cscript src='https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        <script src="https://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.6/jquery-ui.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery.ui === 'undefined') {
                document.write(unescape("%3Cscript src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        
    <style type="text/css">.SideBar, .SideBarPadding{display:none;}.MainContent{width:auto;}.SiteContentTable{width:100%;}</style>
    <style id="ProjectStyles" type="text/css">
        .SiteHeader, .SiteHeaderLeft {
            height:45px !important;
            overflow:hidden;
        }
        .SiteContent 
        {
            padding: 0 0 1em 0;
            margin-top:0;
            min-height:225px;
            border-right: 1px solid lightgrey;
            border-left: 1px solid lightgrey;
            border-bottom: 1px solid lightgrey;
        }
        .IE table.MinWidthContent
        {
	        table-layout: auto !important;	
        }
    </style>
    
    
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">

    
    
    <meta id="WTProjectName" name="WT.pi" content="unity"/>
    

    <link rel="EditURI" type="application/rsd+xml" title="RSD" href='http://unity.codeplex.com/rsd' />
    <link rel="wlwmanifest" type="application/wlwmanifest+xml" title="WLWManifest" href='/wlwmanifest.xml' />
    
    
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity" url="http://unity.codeplex.com/project/feeds/rss"/>
    
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Discussions" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2funity"/>
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Issues" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2funity"/>
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Downloads" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2funity"/>
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Reviews" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2funity"/>
        
    
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Source&#32;code" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2funity"/>
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Wiki" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2funity"/>
    
        
    
        <meta content="summary" name="twitter:card" /><meta content="@CodePlex" name="twitter:site" /><meta content="http://unity.codeplex.com/discussions/284557?ProjectName=unity" name="twitter:url" /><meta content="patterns &amp;#38; practices - Unity" name="twitter:title" /><meta content="The Unity Application Block &amp;#40;Unity&amp;#41; is officially under new ownership.&amp;#13;&amp;#10;https&amp;#58;&amp;#47;&amp;#47;github.com&amp;#47;unitycontainer&amp;#47;unity" name="twitter:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" name="twitter:image" /><meta content="CodePlex" property="og:site_name" /><meta content="http://unity.codeplex.com/discussions/284557?ProjectName=unity" property="og:url" /><meta content="object" property="og:type" /><meta content="patterns &amp;#38; practices - Unity" property="og:title" /><meta content="The Unity Application Block &amp;#40;Unity&amp;#41; is officially under new ownership.&amp;#13;&amp;#10;https&amp;#58;&amp;#47;&amp;#47;github.com&amp;#47;unitycontainer&amp;#47;unity" property="og:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" property="og:image" />
        

    </head>
    
    <body>
         
            
        <script src="../assets/ScriptLoader.js" type="text/javascript"></script>
        <form id="aspnetForm" autocomplete="off" method="POST" enctype="multipart/form-data">
            <input name="__RequestVerificationToken" type="hidden" value="quA_Q98lRKHG7K-ITvNgp9OybmZZxKPQO51hk4prtNQvsdo9T0eijdI3y0VwG_x6Bx0HrLzyEav6xKOFddErND7nIqkfIvUpY7N5ZOGNQdgmZr2hsU8Xvi23aoh6njZ3TrKciQ2" /><input name="__RequestVerificationToken2" type="hidden" value="__RequestVerificationToken21d06a40b-32fb-4483-a740-bd5aa80e55ee" />
            
            <div id="UpdateProgressPanel" class="loading_animation" style="display:none;">
                <div class="row">
                    <h2 class="anim_h2">
                        <span id="UpdateProgressText">Updating...</span>
                        <span id="animatedLoadingIconContainer">
                            <img id="animatedLoadingIcon" src="../assets/loading_animation.gif" class="anim_img"/>
                        </span>
                    </h2>
                </div>
            </div>
            
            <div style="display:none;">
                
                <img id="BlankImage" style="width:0;height:0;" src="../assets/blank.png" onload="self.logoImageLoaded=true;"/>

                <script language="javascript" type="text/javascript">
                    var date = new Date();
                    var timezoneOffset = date.getTimezoneOffset() / 60 * -1;
                    var timezoneOffsetCookie = getCookie("TimezoneOffset");
                    var firstTimeSetTimezoneCookie = false;

                    if (timezoneOffsetCookie == null || timezoneOffsetCookie != timezoneOffset) {
                        firstTimeSetTimezoneCookie = true;
                        document.cookie = "TimezoneOffset=" + timezoneOffset + '; domain=.codeplex.com;expires=Wed, 10 Oct 2018 05:26:24 UTC';
                    }
                </script>
            </div>
            
            
            <div id="banner">
                <div id="message"><strong>This is an archived copy of the original CodePlex Unity Discussion Forum</strong><br />Unity is now on <a href="https://github.com/unitycontainer/">GitHub</a>
                    
                </div>
            </div>
            

            <div id="header">
                <div id="header_wrap" class="row">
                    <p id="logo"><a href="http://www.codeplex.com">Code<span class="semi">Plex</span></a><span id="tagline">Project Hosting for Open Source Software</span></p>
                    

<ul id="nav">

    <li><a href="/site/register/new" id="registerLink" class="ZoomFix">Register</a></li>
    <li ><a class="SignInLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2funity.codeplex.com%2fdiscussions%2f284557" id="signInLink">Sign In</a></li>
  
    <li class="last"><a class="rss_site_icon" href="http://www.codeplex.com/site/feeds/rss" type="application/rss+xml" rel="Alternate" title="CodePlex Site Activity"></a></li>
</ul>
                    <input id="searchsite" name="searchsite" maxlength="500" type="text" value="" /><span id="search_mag"><a id="submitSearch" name="submitSearch" class="magnify" title="Search" href="#"></a></span>
                    <script>
	$(document).ready(function() {
    var searchButton = $('#submitSearch'),
        searchBar = $('#searchsite');

    // Register our own handler for the search event while we wait for the SearchBox script to load.
    searchButton.bind('click.backupSearchBox', doProjectSearch);
    searchBar.bind('keypress.backupSearchBox', function(e) { if ($keyCode(e) === 13) { doProjectSearch(); return false; } });

    function cleanupSearchEvents() {
        // If the SearchBox was loaded, unregister our handlers.
        if (epx_loaded) {
            searchButton.unbind('.backupSearchBox');
            searchBar.unbind('.backupSearchBox');
        }
    }

    $loadScript('https://i4.services.social.microsoft.com/search/Widgets/SearchBox.jss?appid=1000&scopeid=1&boxId=searchsite&btnId=submitSearch&watermark=Search%20all%20projects&overrideWatermark=true&searchLocation=%2fsite%2fsearch&allowEmptySearch=true&focusOnInit=False&minimumTermLength=3', cleanupSearchEvents);
})
function doProjectSearch() {
    
    var url = '/site/search';

    //If search term is not same as watermark
    if($('#searchsite').val() != 'Search all projects')    
    {        
        url = url + '?query=' + encodeURIComponent($('#searchsite').val());
    }

    
    var callback = '';
    if (callback.length > 0 && eval('typeof ' + callback) != 'undefined')
        url += eval(callback + '()');

    window.location.href = url;
    return false;
}
</script>
                </div>
            </div>
            
            <div id="wrap">
                
    <div id="sub_heading" class="row">
        
        <div id="ProjectHeader">
            <div id="project_title_row" class="row">
                <div id="project_logo">
                    
<a id="AffiliateLink" href="http://msdn.microsoft.com/practices">
    <img id="AffiliateImage" src="../assets/pnp_logo.png" title="patterns&#32;&#38;&#32;practices" />
</a>

    
    <h1 class="text_only"><a href="http://unity.codeplex.com/" id="ProjectTitle1"><div>patterns &#38; practices - Unity</div></a></h1>

                </div>
            </div>
        </div>
        
        <div id="ProjectDetailsDiv">
            
        </div>
		<div class="clear"></div>
        

<ul id="page_box_links">
	<li id="homeTabCell" style="width: 63px;"><a id="homeTab" href="http://unity.codeplex.com/" class="box_home">home</a><div></div></li>
    
	<li id="sourceTabCell" style="width:113px;"><a id="sourceTab" href="http://unity.codeplex.com/SourceControl/latest" class="box_source">source code</a><div></div></li>
    
	<li id="releasesTabCell" style="width:105px;"><a id="releasesTab" href="http://unity.codeplex.com/releases" class="box_downloads">downloads</a><div></div></li>
    
    <li id="documentationTabCell" style="width:143px;"><a id="documentationTab" href="http://unity.codeplex.com/documentation" class="box_documentation">documentation</a><div></div></li>
    
	<li id="discussionTabCell" style="width:112px;"><a id="discussionTab" href="../index.html" class="discussions_active">discussions</a><div></div></li>
    
	<li id="workItemsTabCell" style="width:70px;"><a id="workItemsTab" href="http://unity.codeplex.com/workitem/list/basic" class="box_issue">issues</a><div></div></li>
    
	<li id="peopleTabCell" style="width:70px;"><a id="peopleTab" href="http://unity.codeplex.com/team/view" class="box_people">people</a><div></div></li>
	<li id="licenseTabCell" style="width:70px;"><a id="licenseTab" href="http://unity.codeplex.com/license" class="box_license">license</a><div></div></li>
    
    <span class="stretch"></span>
</ul>

<script type="text/javascript">
    $(document).ready(function () {
        $('#page_box_links').applyLastClassToList();
    });
</script>
		    <div class="clear"></div>
            
     <td>
       

<div>
    
    <div id="actionBar" class="action_bar">
        <ul id="actionBar_ul" class="actionBar_sublinks subtab_right" style="vertical-align: middle;">

            

                <li id="li_actionbar_creatediscussion" data-action-id="actionbar_creatediscussion" data-action-type="Navigate" class="actionBar_sublinks" data-options-id="fbe25bbe-4007-456b-be09-b043196e70df">
                
                    <script class="options" defer="defer" id="fbe25bbe-4007-456b-be09-b043196e70df" type="application/json">{"navigate-url":"http://unity.codeplex.com/discussions/create"}</script> 
                    
                    <div class="actionBar_custom_content"></div>

                    <a href="#" id="actionbar_creatediscussion" title="Start a New Thread" class="action_bar_item_link">
                        <img id="img_actionbar_creatediscussion" class="action_bar_item_image" src="../assets/actionbar_newitem.png" style="vertical-align: middle" />
                        New Thread
                    </a>

                </li>

            

                <li id="li_actionbar_subscribe" data-action-id="actionbar_subscribe" data-action-type="PopUp" class="actionBar_sublinks" data-options-id="6ad88f98-42d3-47f1-95f4-c909f8e8c397">
                
                    <script class="options" defer="defer" id="6ad88f98-42d3-47f1-95f4-c909f8e8c397" type="application/json">{}</script> 
                    
                    <div class="actionBar_custom_content">

<div id="rssHoverDiv" class="HoverPanel LeftHoverWidth" style="display: none">
        <ul id="3_FeedsPanel" class="RssFeedsPanel">
            <li>
                <a id="ProjectRssLink" href="http://unity.codeplex.com/project/feeds/rss" class="ArrowSmall NoUnderline">All Project Updates</a>
            </li>
            
            <li>
                <a id="DiscussionRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2funity" class="ArrowSmall NoUnderline">Discussions</a>
            </li>
            
            <li>
                <a id="IssueTrackerRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2funity" class="ArrowSmall NoUnderline">Issue Tracker</a>
            </li>
            
            <li>
                <a id="ReleasesRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2funity" class="ArrowSmall NoUnderline">Downloads</a>
            </li>
            <li>
                <a id="ReviewsRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2funity" class="ArrowSmall NoUnderline">Reviews</a>
            </li>
            
            <li>
                <a id="SourceControlRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2funity" class="ArrowSmall NoUnderline">Source Code</a>
            </li>
            <li>
                <a id="WikiRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2funity" class="ArrowSmall NoUnderline">Wiki &amp; Documentation</a>
            </li>
        </ul>
</div></div>

                    <a href="#" id="actionbar_subscribe" title="Subscribe to project updates in RSS feeds." class="action_bar_item_link">
                        <img id="img_actionbar_subscribe" class="action_bar_item_image" src="../assets/actionbar_subscribe.png" style="vertical-align: middle" />
                        Subscribe
                    </a>

                </li>

            
        </ul>
    </div>
</div>
     </td>

        

    </div>
    
    
<div class="Threads">
    <div class="ViewThread">
        
        
        
            <h1 class="page_title WordWrapBreakWord">
                How can I create a class instance from inside my method&#63;
            </h1>

            <!-- Private Discussion header -->
            

            <!-- Posts List Header: Topics and Wiki Link -->
            <table class="PostsListHeader">
                <tr>
                    <td>
                     
                    </td>
                    <td>
                        <div class="WikiLink">
                            <span title="Paste this into a wiki page to link to this discussion">
                                Wiki Link: [discussion:284557]
                            </span>
                        </div>
                    </td>
                </tr>
            </table>

            <!-- The list of posts -->
            

<div id="discussionsPostList" data-options-id="29823bd0-1571-46e4-a8b9-1949c7818413">
    <script class="options" defer="defer" id="29823bd0-1571-46e4-a8b9-1949c7818413" type="application/json">{"threadUrl":"http://unity.codeplex.com/discussions/284557","showEditor":false,"checkImageUrl":"../assets/check_answer.png"}</script>

    <div class="Posts" style="margin-top: 10px;">
    

<table cellpadding="0" cellspacing="0" style="width: 100%; margin-bottom: 0px; table-layout:fixed">
    

<tr id="PostPanel" class="Post" d:forid="718601">
    <td id="PostDetailsCell_718601" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post718601"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/RichardAlan">RichardAlan</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="12/30/2011 9:01:19 AM" LocalTimeTicks="1325264479">Dec 30, 2011 at 9:01 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_718601" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;I&#32;have&#32;registered&#32;my&#32;classes&#32;like&#32;this&#58;&#32;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;private&#32;static&#32;IUnityContainer&#32;BuildUnityContainer&#40;&#41;&#32;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;&#123;&#32;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;container.RegisterType&#38;lt&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;IService&#38;lt&#59;Product&#38;gt&#59;,&#32;ProductService&#38;nbsp&#59;&#38;nbsp&#59;&#32;&#38;gt&#59;&#40;&#38;quot&#59;Product&#38;quot&#59;&#41;&#59;&#32;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;&#125;&#32;Normally&#32;I&#32;use&#32;constructor&#32;injection&#32;but&#32;I&#32;have&#32;one&#32;case&#32;where&#32;I&#32;would&#32;like&#32;to&#32;create&#32;an&#32;instance&#32;of&#32;a&#32;class&#32;for&#32;use&#32;inside&#32;a&#32;method.&#32;In&#32;that&#32;method&#32;I&#32;need&#32;to&#32;do&#32;something&#32;like&#32;the&#32;following&#58;&#32;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;public&#32;void&#32;Update&#40;string&#32;serviceClassName&#41;&#32;&#123;&#32;&#32;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;var&#32;serviceClass&#32;&#61;&#32;new&#32;container.Resolve&#38;lt&#59;IService&#38;lt&#59;Product&#38;gt&#59;&#38;gt&#59;&#40;&#41;&#59;&#32;&#32;I&#32;need&#32;to&#32;create&#32;a&#32;service&#32;class&#32;for&#32;a&#32;service&#32;of&#32;type&#32;IService&#38;lt&#59;Product&#38;gt&#59;&#32;if&#32;the&#32;serviceClassName&#32;passed&#32;in&#32;is&#32;&#38;quot&#59;Product&#38;quot&#59;.&#32;I&#32;need&#32;to&#32;create&#32;a&#32;service&#32;class&#32;for&#32;a&#32;service&#32;of&#32;type&#32;IService&#38;lt&#59;Package&#38;gt&#59;&#32;if&#32;the&#32;serviceClassName&#32;passed&#32;in&#32;is&#32;&#38;quot&#59;Package&#38;quot&#59;&#32;I&#32;keep&#32;reading&#32;how&#32;I&#32;should&#32;be&#32;using&#32;Constructor&#32;Injection&#32;but&#32;for&#32;this&#32;case&#32;I&#32;am&#32;not&#32;sure&#32;how&#32;I&#32;can&#32;use&#32;it.&#32;All&#32;I&#32;need&#32;is&#32;a&#32;temporary&#32;copy&#32;of&#32;the&#32;service&#32;instance&#32;just&#32;for&#32;the&#32;lifetime&#32;of&#32;when&#32;my&#32;method&#32;executes.&#32;Can&#32;someone&#32;help&#32;me&#32;out&#32;and&#32;tell&#32;me&#32;how&#32;I&#32;can&#32;do&#32;this.&#38;nbsp&#59;&#32;In&#32;the&#32;above&#32;I&#32;have&#32;two&#32;problems.&#32;Firstly&#32;I&#32;don&#39;t&#32;know&#32;how&#32;to&#32;pass&#32;the&#32;container&#32;to&#32;the&#32;child&#32;and&#32;second&#32;I&#32;want&#32;to&#32;get&#32;a&#32;IService&#38;lt&#59;&#32;passedParameter&#32;&#38;gt&#59;&#38;nbsp&#59;&#32;based&#32;on&#32;the&#32;parameter&#32;passed&#32;to&#32;the&#32;method.&#32;Hope&#32;I&#32;can&#32;get&#32;some&#32;good&#32;advice.&#32;Thanks,&#32;&#38;nbsp&#59;&#32;">
        
<p>I have registered my classes like this:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private static IUnityContainer BuildUnityContainer()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.RegisterType&lt;&nbsp;&nbsp; IService&lt;Product&gt;, ProductService&nbsp;&nbsp; &gt;(&quot;Product&quot;);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>Normally I use constructor injection but I have one case where I would like to create an instance of a class for use inside a method. In that method I need to do something like the following:</p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public</span><span> </span><span>void</span><span>
</span><span>Update</span><span>(</span><span>string</span><span> serviceClassName</span><span>)</span><span>
</span><span>{</span><span> </span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var</span><span> serviceClass
</span><span>=</span><span> </span><span>new</span><span> container</span><span>.</span><span>Resolve</span><span>&lt;</span><span>IService</span><span>&lt;</span><span>Product</span><span>&gt;&gt;();</span></p>
<p><br>
I need to create a service class for a service of type IService&lt;Product&gt; if the serviceClassName passed in is &quot;Product&quot;.<br>
I need to create a service class for a service of type IService&lt;Package&gt; if the serviceClassName passed in is &quot;Package&quot;</p>
<p>I keep reading how I should be using Constructor Injection but for this case I am not sure how I can use it. All I need is a temporary copy of the service instance just for the lifetime of when my method executes.</p>
<p>Can someone help me out and tell me how I can do this.&nbsp; In the above I have two problems. Firstly I don't know how to pass the container to the child and second I want to get a IService&lt; passedParameter &gt;&nbsp; based on the parameter passed to
 the method.</p>
<p>Hope I can get some good advice.</p>
<p>Thanks,</p>
<p>&nbsp;</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_718601" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="718916">
    <td id="PostDetailsCell_718916" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post718916"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/RichardAlan">RichardAlan</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="12/31/2011 3:18:10 AM" LocalTimeTicks="1325330290">Dec 31, 2011 at 3:18 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_718916" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="I&#32;came&#32;up&#32;with&#32;the&#32;following&#32;solution&#32;to&#32;resolve&#32;inside&#32;of&#32;a&#32;method&#32;when&#32;the&#32;class&#32;name&#32;is&#32;given&#32;to&#32;me&#32;by&#32;a&#32;string&#32;parameter&#32;en.&#32;It&#32;does&#32;not&#32;look&#32;to&#32;be&#32;a&#32;very&#32;good&#32;way&#32;to&#32;resolve&#32;but&#32;it&#32;works.&#32;Note&#32;that&#32;this&#32;method&#32;gets&#32;the&#32;assemblyQualifiedName&#32;of&#32;a&#32;known&#32;class&#32;Product&#32;and&#32;the&#32;replaces&#32;the&#32;word&#32;Product&#32;with&#32;the&#32;name&#32;of&#32;class&#32;passed&#32;in&#32;as&#32;a&#32;parameter.&#38;nbsp&#59;&#32;Is&#32;there&#32;anyone&#32;out&#32;there&#32;who&#32;could&#32;verify&#32;if&#32;this&#32;is&#32;a&#32;good&#32;way&#32;to&#32;do&#32;this&#58;&#32;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;public&#32;void&#32;Update&#40;string&#32;en,&#32;string&#32;pk,&#32;string&#32;rk,&#32;string&#32;fld,&#32;string&#32;val&#41;&#32;&#123;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;string&#32;assemblyQualifiedName&#32;&#61;&#32;typeof&#40;Storage.Models.Product&#41;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;.AssemblyQualifiedName&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;.Replace&#40;&#34;Product&#34;,&#32;en&#41;&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;Type&#32;entityType&#32;&#61;&#32;Type.GetType&#40;assemblyQualifiedName,&#32;false,&#32;true&#41;&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;Type&#32;openGenericType&#32;&#61;&#32;typeof&#40;IService&#38;lt&#59;&#38;gt&#59;&#41;&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;Type&#32;myClosedType&#32;&#61;&#32;openGenericType.MakeGenericType&#40;entityType&#41;&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;var&#32;something&#32;&#61;&#32;_container.Resolve&#40;myClosedType&#41;&#59;&#32;This&#32;seems&#32;like&#32;a&#32;very&#32;complicated&#32;way&#32;to&#32;resolve&#32;container.RegisterType&#38;lt&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;IService&#38;lt&#59;Product&#38;gt&#59;,&#32;ProductService&#38;nbsp&#59;&#38;nbsp&#59;&#32;&#38;gt&#59;&#40;&#41;&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;from&#32;inside&#32;a&#32;method.&#32;In&#32;comparison&#32;the&#32;constructor&#32;way&#32;seems&#32;so&#32;easy&#32;but&#32;my&#32;problem&#32;is&#32;that&#32;I&#32;do&#32;not&#32;know&#32;the&#32;type&#32;of&#32;service&#32;I&#32;am&#32;using&#32;until&#32;run&#32;time&#32;so&#32;I&#32;need&#32;to&#32;use&#32;resolve.">
        
<p>I came up with the following solution to resolve inside of a method when the class name is given to me by a string parameter
<strong>en</strong>. It does not look to be a very good way to resolve but it works. Note that this method gets the assemblyQualifiedName of a known class
<strong>Product </strong>and the replaces the word Product with the name of class passed in as a parameter.&nbsp;</p>
<p><strong>Is there anyone out there who could verify if this is a good way to do this:</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Update(string en, string pk, string rk, string fld, string val) {<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string assemblyQualifiedName = typeof(Storage.Models.Product)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .AssemblyQualifiedName<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Replace(&quot;Product&quot;, en);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type entityType = Type.GetType(assemblyQualifiedName, false, true);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type openGenericType = typeof(IService&lt;&gt;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type myClosedType = openGenericType.MakeGenericType(entityType);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var something = _container.Resolve(myClosedType);</p>
<p><br>
This seems like a very complicated way to resolve <strong>container.RegisterType&lt;&nbsp;&nbsp; IService&lt;Product&gt;, ProductService&nbsp;&nbsp; &gt;();</strong>&nbsp;&nbsp; from inside a method. In comparison the constructor way seems so easy but my problem
 is that I do not know the type of service I am using until run time so I need to use resolve.</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_718916" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="718921">
    <td id="PostDetailsCell_718921" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post718921"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/randylevy">randylevy</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="12/31/2011 3:59:54 AM" LocalTimeTicks="1325332794">Dec 31, 2011 at 3:59 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_718921" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Maintaining&#32;a&#32;reference&#32;to&#32;the&#32;container&#32;inside&#32;of&#32;your&#32;classes&#32;is&#32;typically&#32;discouraged.&#32;&#38;nbsp&#59;Ideally&#32;all&#32;dependencies&#32;would&#32;be&#32;injected.&#32;For&#32;your&#32;second&#32;problem&#32;there&#32;is&#32;a&#32;bit&#32;of&#32;a&#32;disconnect&#32;between&#32;using&#32;IService&#38;lt&#59;T&#38;gt&#59;&#32;&#40;e.g.&#32;IService&#38;lt&#59;Product&#38;gt&#59;&#41;&#32;and&#32;IService&#38;lt&#59;passedParameter&#38;gt&#59;.&#32;&#38;nbsp&#59;The&#32;former&#32;is&#32;determined&#32;at&#32;compile&#32;time&#32;whereas&#32;the&#32;latter&#32;is&#32;not&#32;known&#32;until&#32;runtime&#32;when&#32;the&#32;value&#32;of&#32;passedParameter&#32;is&#32;specified.&#32;&#38;nbsp&#59;&#40;IService&#38;lt&#59;passedParameter&#38;gt&#59;&#32;is&#32;actually&#32;not&#32;valid&#32;because&#32;passedParameter&#32;is&#32;not&#32;a&#32;Type.&#41;&#32;&#38;nbsp&#59;Typically&#32;one&#32;would&#32;be&#32;dealing&#32;with&#32;only&#32;one&#32;type&#32;such&#32;as&#32;IService.&#32;&#38;nbsp&#59;One&#32;option&#32;to&#32;handle&#32;the&#32;runtime&#32;requirement&#32;would&#32;be&#32;to&#32;use&#32;reflection.&#32;IService&#38;lt&#59;Product&#38;gt&#59;&#32;and&#32;IService&#38;lt&#59;Package&#38;gt&#59;&#32;are&#32;totally&#32;different&#32;types&#32;so&#32;I&#32;don&#39;t&#32;see&#32;a&#32;need&#32;to&#32;register&#32;them&#32;by&#32;name&#32;&#40;&#38;nbsp&#59;container.RegisterType&#38;lt&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;IService&#38;lt&#59;Product&#38;gt&#59;,&#32;ProductService&#38;nbsp&#59;&#38;nbsp&#59;&#32;&#38;gt&#59;&#40;&#34;Product&#34;&#41;&#59;&#32;&#41;.&#32;Can&#32;you&#32;post&#32;the&#32;code&#32;for&#32;the&#32;Update&#32;method&#32;&#40;or&#32;something&#32;like&#32;how&#32;you&#32;envision&#41;&#32;and&#32;also&#32;IService&#38;lt&#59;T&#38;gt&#59;&#63;&#32;&#38;nbsp&#59;That&#32;might&#32;help.&#32;My&#32;first&#32;thought&#32;was&#32;a&#32;factory&#32;to&#32;abstract&#32;away&#32;the&#32;runtime&#32;instantiation.&#32;&#38;nbsp&#59;Here&#32;is&#32;something&#32;I&#32;wrote&#32;which&#32;probably&#32;doesn&#39;t&#32;work&#32;for&#32;you&#32;because&#32;I&#32;don&#39;t&#32;have&#32;the&#32;full&#32;context&#47;knowledge&#32;of&#32;the&#32;complexities&#32;around&#32;exactly&#32;what&#32;you&#32;are&#32;doing.&#32;&#38;nbsp&#59;Even&#32;so,&#32;hopefully&#32;it&#32;can&#32;help.&#32;&#38;nbsp&#59;There&#32;is&#32;a&#32;factory&#32;that&#32;creates&#32;a&#32;processor&#32;that&#32;the&#32;Update&#32;method&#32;can&#32;use&#32;to&#32;perform&#32;the&#32;update&#58;&#38;nbsp&#59;&#32;&#32;&#32;&#32;&#35;region&#32;Things_I_Have_No_Knowledge_Of&#32;public&#32;class&#32;Product&#32;&#123;&#125;&#32;public&#32;class&#32;Package&#32;&#123;&#125;&#32;public&#32;interface&#32;IService&#38;lt&#59;T&#38;gt&#59;&#32;&#123;&#32;void&#32;DoIt&#40;&#41;&#59;&#32;&#125;&#32;public&#32;class&#32;ProductService&#32;&#58;&#32;IService&#38;lt&#59;Product&#38;gt&#59;&#32;&#123;&#32;public&#32;void&#32;DoIt&#40;&#41;&#32;&#123;&#32;Console.WriteLine&#40;&#34;ProductServices&#32;do&#32;it&#34;&#41;&#59;&#32;&#125;&#32;&#125;&#32;public&#32;class&#32;PackageService&#32;&#58;&#32;IService&#38;lt&#59;Package&#38;gt&#59;&#32;&#123;&#32;public&#32;void&#32;DoIt&#40;&#41;&#32;&#123;&#32;Console.WriteLine&#40;&#34;PackageServices&#32;do&#32;it&#34;&#41;&#59;&#32;&#125;&#32;&#125;&#32;&#35;endregion&#32;public&#32;class&#32;ServiceProcessorFactory&#32;&#123;&#32;&#47;&#47;&#32;Use&#32;Funcs&#32;to&#32;avoid&#32;instantiating&#32;services&#32;that&#32;are&#32;never&#32;used&#32;by&#32;this&#32;ServiceProcessorFactory&#32;instance&#32;private&#32;Func&#38;lt&#59;IService&#38;lt&#59;Product&#38;gt&#59;&#38;gt&#59;&#32;productService&#59;&#32;private&#32;Func&#38;lt&#59;IService&#38;lt&#59;Package&#38;gt&#59;&#38;gt&#59;&#32;packageService&#59;&#32;private&#32;ServiceProcessor&#32;serviceProcessor&#59;&#32;public&#32;ServiceProcessorFactory&#40;Func&#38;lt&#59;IService&#38;lt&#59;Product&#38;gt&#59;&#38;gt&#59;&#32;productService,&#32;Func&#38;lt&#59;IService&#38;lt&#59;Package&#38;gt&#59;&#38;gt&#59;&#32;packageService,&#32;ServiceProcessor&#32;serviceProcessor&#41;&#32;&#123;&#32;this.productService&#32;&#61;&#32;productService&#59;&#32;this.packageService&#32;&#61;&#32;packageService&#59;&#32;this.serviceProcessor&#32;&#61;&#32;serviceProcessor&#59;&#32;&#125;&#32;public&#32;ServiceProcessor&#32;Create&#40;string&#32;serviceClassName&#41;&#32;&#123;&#32;switch&#32;&#40;serviceClassName&#41;&#32;&#123;&#32;case&#32;&#34;Product&#34;&#32;&#58;&#32;serviceProcessor.UpdateAction&#32;&#61;&#32;&#40;&#41;&#32;&#61;&#38;gt&#59;&#32;&#123;&#32;IService&#38;lt&#59;Product&#38;gt&#59;&#32;service&#32;&#61;&#32;productService&#40;&#41;&#59;&#32;service.DoIt&#40;&#41;&#59;&#32;&#125;&#59;&#32;break&#59;&#32;case&#32;&#34;Package&#34;&#32;&#58;&#32;serviceProcessor.UpdateAction&#32;&#61;&#32;&#40;&#41;&#32;&#61;&#38;gt&#59;&#32;&#123;&#32;IService&#38;lt&#59;Product&#38;gt&#59;&#32;service&#32;&#61;&#32;productService&#40;&#41;&#59;&#32;service.DoIt&#40;&#41;&#59;&#32;&#125;&#59;&#32;break&#59;&#32;default&#58;&#32;throw&#32;new&#32;ArgumentOutOfRangeException&#40;&#34;serviceClassName&#34;&#41;&#59;&#32;&#125;&#32;return&#32;serviceProcessor&#59;&#32;&#125;&#32;&#125;&#32;public&#32;class&#32;ServiceProcessor&#32;&#123;&#32;public&#32;Action&#32;UpdateAction&#32;&#123;&#32;private&#32;get&#59;&#32;set&#59;&#32;&#125;&#32;public&#32;void&#32;Update&#40;&#41;&#32;&#123;&#32;UpdateAction&#40;&#41;&#59;&#32;&#125;&#32;&#125;&#32;&#47;&#47;&#32;This&#32;is&#32;the&#32;class&#32;that&#32;you&#32;showed&#32;the&#32;Update&#32;snippet&#32;from&#32;in&#32;your&#32;question&#32;public&#32;class&#32;MyClass&#32;&#123;&#32;private&#32;ServiceProcessorFactory&#32;serviceProcessorFactory&#59;&#32;public&#32;MyClass&#40;ServiceProcessorFactory&#32;serviceFactory&#41;&#32;&#123;&#32;this.serviceProcessorFactory&#32;&#61;&#32;serviceFactory&#59;&#32;&#125;&#32;public&#32;void&#32;Update&#40;string&#32;serviceClassName&#41;&#32;&#123;&#32;var&#32;serviceProcessor&#32;&#61;&#32;serviceProcessorFactory.Create&#40;serviceClassName&#41;&#59;&#32;serviceProcessor.Update&#40;&#41;&#59;&#32;&#125;&#32;&#125;&#32;class&#32;Program&#32;&#123;&#32;static&#32;void&#32;Main&#40;string&#91;&#93;&#32;args&#41;&#32;&#123;&#32;IUnityContainer&#32;container&#32;&#61;&#32;new&#32;UnityContainer&#40;&#41;&#59;&#32;container.RegisterType&#38;lt&#59;IService&#38;lt&#59;Product&#38;gt&#59;,&#32;ProductService&#38;gt&#59;&#40;&#41;&#59;&#32;container.RegisterType&#38;lt&#59;IService&#38;lt&#59;Package&#38;gt&#59;,&#32;PackageService&#38;gt&#59;&#40;&#41;&#59;&#32;var&#32;myClass&#32;&#61;&#32;container.Resolve&#38;lt&#59;MyClass&#38;gt&#59;&#40;&#41;&#59;&#32;myClass.Update&#40;&#34;Product&#34;&#41;&#59;&#32;&#125;&#32;&#125;&#32;&#32;&#32;&#32;&#38;nbsp&#59;&#32;&#38;nbsp&#59;&#32;--&#32;Randy&#32;LevyEnterprise&#32;Library&#32;support&#32;engineerentlib.support&#64;live.com&#38;nbsp&#59;">
        
<p>Maintaining a reference to the container inside of your classes is typically discouraged. &nbsp;Ideally all dependencies would be injected.</p>
<p>For your second problem there is a bit of a disconnect between using IService&lt;T&gt; (e.g. IService&lt;Product&gt;) and IService&lt;passedParameter&gt;. &nbsp;The former is determined at compile time whereas the latter is not known until runtime when the
 value of passedParameter is specified. &nbsp;(IService&lt;passedParameter&gt; is actually not valid because passedParameter is not a Type.) &nbsp;Typically one would be dealing with only one type such as IService. &nbsp;One option to handle the runtime requirement
 would be to use reflection.</p>
<p>IService&lt;Product&gt; and IService&lt;Package&gt; <strong>are totally different types
</strong>so I don't see a need to register them by name (&nbsp;<span>container.RegisterType&lt;&nbsp;&nbsp; IService&lt;Product&gt;, ProductService&nbsp;&nbsp; &gt;(&quot;Product&quot;); ).</span></p>
<p>Can you post the code for the Update method (or something like how you envision) and also IService&lt;T&gt;? &nbsp;That might help.</p>
<p>My first thought was a factory to abstract away the runtime instantiation. &nbsp;Here is something I wrote which probably doesn't work for you because I don't have the full context/knowledge of the complexities around exactly what you are doing. &nbsp;Even
 so, hopefully it can help. &nbsp;There is a factory that creates a processor that the Update method can use to perform the update:&nbsp;</p>
<p></p>
<div style="color:black; background-color:white">
<pre>    <span style="color:blue">#region</span> Things_I_Have_No_Knowledge_Of

    <span style="color:blue">public</span> <span style="color:blue">class</span> Product {}
    <span style="color:blue">public</span> <span style="color:blue">class</span> Package {}

    <span style="color:blue">public</span> <span style="color:blue">interface</span> IService&lt;T&gt;
    {
        <span style="color:blue">void</span> DoIt();
    }

    <span style="color:blue">public</span> <span style="color:blue">class</span> ProductService : IService&lt;Product&gt;
    {
        <span style="color:blue">public</span> <span style="color:blue">void</span> DoIt()
        {
            Console.WriteLine(<span style="color:#a31515">&quot;ProductServices do it&quot;</span>);
        }
    }

    <span style="color:blue">public</span> <span style="color:blue">class</span> PackageService : IService&lt;Package&gt;
    {
        <span style="color:blue">public</span> <span style="color:blue">void</span> DoIt()
        {
            Console.WriteLine(<span style="color:#a31515">&quot;PackageServices do it&quot;</span>);
        }
    }

    <span style="color:blue">#endregion</span>

    <span style="color:blue">public</span> <span style="color:blue">class</span> ServiceProcessorFactory
    {
        <span style="color:green">// Use Funcs to avoid instantiating services that are never used by this ServiceProcessorFactory instance</span>
        <span style="color:blue">private</span> Func&lt;IService&lt;Product&gt;&gt; productService;
        <span style="color:blue">private</span> Func&lt;IService&lt;Package&gt;&gt; packageService;

        <span style="color:blue">private</span> ServiceProcessor serviceProcessor;

        <span style="color:blue">public</span> ServiceProcessorFactory(Func&lt;IService&lt;Product&gt;&gt; productService,
            Func&lt;IService&lt;Package&gt;&gt; packageService, 
            ServiceProcessor serviceProcessor)
        {
            <span style="color:blue">this</span>.productService = productService;
            <span style="color:blue">this</span>.packageService = packageService;

            <span style="color:blue">this</span>.serviceProcessor = serviceProcessor;
        }

        <span style="color:blue">public</span> ServiceProcessor Create(<span style="color:blue">string</span> serviceClassName)
        {
            <span style="color:blue">switch</span> (serviceClassName)
            {
                <span style="color:blue">case</span> <span style="color:#a31515">&quot;Product&quot;</span> :
                    serviceProcessor.UpdateAction = () =&gt;
                        {
                            IService&lt;Product&gt; service = productService();
                            service.DoIt();
                        };
                    <span style="color:blue">break</span>;

                <span style="color:blue">case</span> <span style="color:#a31515">&quot;Package&quot;</span> :
                    serviceProcessor.UpdateAction = () =&gt;
                        {
                            IService&lt;Product&gt; service = productService();
                            service.DoIt();
                        };
                    <span style="color:blue">break</span>;

                <span style="color:blue">default</span>:
                    <span style="color:blue">throw</span> <span style="color:blue">new</span> ArgumentOutOfRangeException(<span style="color:#a31515">&quot;serviceClassName&quot;</span>);
            }

            <span style="color:blue">return</span> serviceProcessor;
        }
    }

    <span style="color:blue">public</span> <span style="color:blue">class</span> ServiceProcessor
    {
        <span style="color:blue">public</span> Action UpdateAction
        {
            <span style="color:blue">private</span> <span style="color:blue">get</span>;
            <span style="color:blue">set</span>;
        }

        <span style="color:blue">public</span> <span style="color:blue">void</span> Update()
        {
            UpdateAction();
        }
    }

    <span style="color:green">// This is the class that you showed the Update snippet from in your question</span>
    <span style="color:blue">public</span> <span style="color:blue">class</span> MyClass
    {
        <span style="color:blue">private</span> ServiceProcessorFactory serviceProcessorFactory;

        <span style="color:blue">public</span> MyClass(ServiceProcessorFactory serviceFactory)
        {
            <span style="color:blue">this</span>.serviceProcessorFactory = serviceFactory;
        }

        <span style="color:blue">public</span> <span style="color:blue">void</span> Update(<span style="color:blue">string</span> serviceClassName)
        {
            <span style="color:blue">var</span> serviceProcessor = serviceProcessorFactory.Create(serviceClassName);
            serviceProcessor.Update();
        }
    }

    <span style="color:blue">class</span> Program
    {
        <span style="color:blue">static</span> <span style="color:blue">void</span> Main(<span style="color:blue">string</span>[] args)
        {
            IUnityContainer container = <span style="color:blue">new</span> UnityContainer();
            container.RegisterType&lt;IService&lt;Product&gt;, ProductService&gt;();
            container.RegisterType&lt;IService&lt;Package&gt;, PackageService&gt;();

            <span style="color:blue">var</span> myClass = container.Resolve&lt;MyClass&gt;();
            myClass.Update(<span style="color:#a31515">&quot;Product&quot;</span>);
        }
    }

</pre>
</div>
<p></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>--</p>
<p>Randy Levy<br>
Enterprise Library support engineer<br>
<a href="mailto:entlib.support@live.com" rel="nofollow">entlib.support@live.com</a>&nbsp;</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_718921" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="719004">
    <td id="PostDetailsCell_719004" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post719004"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/randylevy">randylevy</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="12/31/2011 3:02:37 PM" LocalTimeTicks="1325372557">Dec 31, 2011 at 3:02 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_719004" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="my&#32;problem&#32;is&#32;that&#32;I&#32;do&#32;not&#32;know&#32;the&#32;type&#32;of&#32;service&#32;I&#32;am&#32;using&#32;until&#32;run&#32;time&#32;so&#32;I&#32;need&#32;to&#32;use&#32;resolve.&#32;Yes,&#32;I&#32;agree,&#32;that&#32;is&#32;the&#32;major&#32;issue.&#32;&#38;nbsp&#59;&#32;If&#32;you&#32;are&#32;OK&#32;with&#32;your&#32;current&#32;design&#32;and&#32;OK&#32;using&#32;reflection&#32;and&#32;unbounded&#32;generic&#32;types&#32;then&#32;I&#32;would&#32;still&#32;recommend&#32;encapsulating&#32;that&#32;logic&#32;into&#32;a&#32;factory&#32;and&#32;avoiding&#32;if&#32;possible&#32;maintaining&#32;a&#32;reference&#32;to&#32;the&#32;container.&#32;Another&#32;issue&#32;with&#32;the&#32;reflection&#32;approach&#32;is&#32;that&#32;at&#32;compile&#32;time&#32;the&#32;compiler&#32;has&#32;no&#32;knowledge&#32;about&#32;what&#32;type&#32;&#34;var&#32;something&#34;&#32;is&#32;so&#32;it&#32;treats&#32;it&#32;as&#32;an&#32;object.&#32;&#38;nbsp&#59;If&#32;you&#32;want&#32;to&#32;perform&#32;any&#32;useful&#32;work&#32;you&#32;will&#32;have&#32;to&#32;perform&#32;a&#32;cast&#32;so&#32;you&#32;are&#32;almost&#32;back&#32;where&#32;you&#32;started&#32;from&#32;since&#32;you&#32;now&#32;need&#32;to&#32;know&#32;to&#32;cast&#32;the&#32;object&#32;at&#32;compile&#32;time.&#32;&#38;nbsp&#59;Or&#32;you&#32;could&#32;continue&#32;down&#32;the&#32;reflection&#32;road&#32;to&#32;invoke&#32;methods&#32;on&#32;the&#32;object.&#32;&#38;nbsp&#59;If&#32;you&#32;are&#32;using&#32;C&#35;&#32;4&#32;you&#32;could&#32;also&#32;use&#32;dynamic.&#32;&#38;nbsp&#59;Either&#32;way&#32;I&#32;would&#32;try&#32;to&#32;minimize&#32;use&#32;of&#32;the&#32;container.&#32;&#32;&#32;public&#32;class&#32;MyClass2&#32;&#123;&#32;private&#32;ServiceFactory&#32;factory&#59;&#32;public&#32;MyClass2&#40;ServiceFactory&#32;factory&#41;&#32;&#123;&#32;this.factory&#32;&#61;&#32;factory&#59;&#32;&#125;&#32;public&#32;void&#32;Update&#40;string&#32;serviceName&#41;&#32;&#123;&#32;dynamic&#32;obj&#32;&#61;&#32;factory.Create&#40;serviceName&#41;&#59;&#32;obj.DoIt&#40;&#41;&#59;&#32;&#125;&#32;&#125;&#32;public&#32;class&#32;ServiceFactory&#32;&#123;&#32;IUnityContainer&#32;container&#59;&#32;public&#32;ServiceFactory&#40;IUnityContainer&#32;container&#41;&#32;&#123;&#32;this.container&#32;&#61;&#32;container&#59;&#32;&#125;&#32;public&#32;object&#32;Create&#40;string&#32;name&#41;&#32;&#123;&#32;string&#32;assemblyQualifiedName&#32;&#61;&#32;typeof&#40;Product&#41;&#32;.AssemblyQualifiedName&#32;.Replace&#40;&#34;Product&#34;,&#32;name&#41;&#59;&#32;Type&#32;entityType&#32;&#61;&#32;Type.GetType&#40;assemblyQualifiedName,&#32;false,&#32;true&#41;&#59;&#32;Type&#32;openGenericType&#32;&#61;&#32;typeof&#40;IService&#38;lt&#59;&#38;gt&#59;&#41;&#59;&#32;Type&#32;myClosedType&#32;&#61;&#32;openGenericType.MakeGenericType&#40;entityType&#41;&#59;&#32;return&#32;container.Resolve&#40;myClosedType&#41;&#59;&#32;&#125;&#32;&#125;&#32;&#32;&#32;&#32;--Randy&#32;LevyEnterprise&#32;Library&#32;support&#32;engineerentlib.support&#64;live.com&#38;nbsp&#59;">
        
<p><em>my problem is that I do not know the type of service I am using until run time so I need to use resolve.</em></p>
<p>Yes, I agree, that is the major issue. &nbsp;</p>
<p>If you are OK with your current design and OK using reflection and unbounded generic types then I would still recommend encapsulating that logic into a factory and avoiding if possible maintaining a reference to the container.</p>
<p>Another issue with the reflection approach is that at compile time the compiler has no knowledge about what type &quot;var something&quot; is so it treats it as an object. &nbsp;If you want to perform any useful work you will have to perform a cast so you are almost
 back where you started from since you now need to know to cast the object at compile time. &nbsp;Or you could continue down the reflection road to invoke methods on the object. &nbsp;If you are using C# 4 you could also use dynamic. &nbsp;Either way I would
 try to minimize use of the container.</p>
<div style="color:black; background-color:white">
<pre><div style="color:black; background-color:white"><pre>    <span style="color:blue">public</span> <span style="color:blue">class</span> MyClass2
    {
        <span style="color:blue">private</span> ServiceFactory factory;

        <span style="color:blue">public</span> MyClass2(ServiceFactory factory)
        {
            <span style="color:blue">this</span>.factory = factory;
        }

        <span style="color:blue">public</span> <span style="color:blue">void</span> Update(<span style="color:blue">string</span> serviceName)
        {
            <span style="color:blue">dynamic</span> obj = factory.Create(serviceName);
            obj.DoIt();
        }
    }

    <span style="color:blue">public</span> <span style="color:blue">class</span> ServiceFactory
    {
        IUnityContainer container;

        <span style="color:blue">public</span> ServiceFactory(IUnityContainer container)
        {
            <span style="color:blue">this</span>.container = container;
        }

        <span style="color:blue">public</span> <span style="color:blue">object</span> Create(<span style="color:blue">string</span> name)
        {
            <span style="color:blue">string</span> assemblyQualifiedName = <span style="color:blue">typeof</span>(Product)
                  .AssemblyQualifiedName
                  .Replace(<span style="color:#a31515">&quot;Product&quot;</span>, name);
            Type entityType = Type.GetType(assemblyQualifiedName, <span style="color:blue">false</span>, <span style="color:blue">true</span>);
            Type openGenericType = <span style="color:blue">typeof</span>(IService&lt;&gt;);
            Type myClosedType = openGenericType.MakeGenericType(entityType);
            <span style="color:blue">return</span> container.Resolve(myClosedType);
        }
    }</pre>
</div>
</pre>
</div>
<p>--<br>
Randy Levy<br>
Enterprise Library support engineer<br>
<a href="mailto:entlib.support@live.com" rel="nofollow">entlib.support@live.com</a>&nbsp;</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_719004" class="Options" >
            
        </div>
        
    </td>
</tr>

</table>
    </div>

    
        <div class="StandardMarginTop">
            <a id="SignInToAddCommentLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2funity.codeplex.com%2fdiscussions%2f284557">
                Sign in to post message or set email notifications
            </a>
        </div>
    


    <div id="PostEditorContainer">
        <a name="editor"></a>
        <div id="Editor" style="display: none;">
            

<div class="MarkdownEditor" data-options-id="29e5a006-36a2-446b-8367-c492a1a27f70">
    <script class="options" defer="defer" id="29e5a006-36a2-446b-8367-c492a1a27f70" type="application/json">{"maxLength":10000,"styleSheetLocation":""}</script>

    <div class="MarkdownEditorControls">
        <a href="#" tabindex="-1" class="control md_help" title="Markdown Syntax Guide"></a>
        <div class="control md_divider"></div>
        <a href="#" tabindex="-1" class="control md_header" title="Insert Header (CTRL + H)"></a>
        <a href="#" tabindex="-1" class="control md_code" title="Insert Code (CTRL + K)"></a>
        <a href="#" tabindex="-1" class="control md_quote" title="Insert Quote (CTRL + Q)"></a>
        <a href="#" tabindex="-1" class="control md_img" title="Insert Img (CTRL + G)"></a>
        <a href="#" tabindex="-1" class="control md_link" title="Insert Link (CTRL + L)"></a>
        <a href="#" tabindex="-1" class="control md_ulist" title="Unordered List (CTRL + U)"></a>
        <a href="#" tabindex="-1" class="control md_olist" title="Ordered List (CTRL + O)"></a>
        <a href="#" tabindex="-1" class="control md_italics" title="Italic Text (CTRL + I)"></a>
        <a href="#" tabindex="-1" class="control md_bold" title="Bold Text (CTRL + B)"></a>
    </div>

    

<div class="tab_control">
    <!-- Generate the basic HTML for the tabs. -->
    
        <div id="Compose"
              class="tab selected"
              data-custom-header-id=""
              data-tab-contents-id="compose_contents_94cca698-fe32-4fc4-873f-51d104f874b5">
            Compose
        </div>
    
        <div id="Preview"
              class="tab "
              data-custom-header-id=""
              data-tab-contents-id="preview_contents_3b8ef7dc-9e84-45b4-9ab0-044734bc1bab">
            Preview
        </div>
    
    <div class="clear"></div>
</div>


    <div id="compose_contents_94cca698-fe32-4fc4-873f-51d104f874b5" class="compose_tab_content">
        <textarea class=" MarkdownEditorDimensions" cols="20" id="MarkdownEditor" name="content" rows="2">
</textarea>
        <div class="ClearBoth"></div>

        <div class="markdownGuide" style="display: none">
            <table>
                <tr>
                    <td class="markdownGuideColumn">
                        <h1>Text Formatting</h1>
                        <div># Header 1</div>
                        <div>## Header 2</div>
                        <br />
                        <div>*italics* (or _italics_)</div>
                        <div>**bold** (or __bold__)</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Lists</h1>
                        <div>* Unordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp * SubItem</div>
                        <br />
                        <div>1. Ordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 1. SubItem</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Quotes</h1>
                        <div>> Lorem ipsum</div>
                        <div>dolor sitamet </div>
                        <div>non. Lectus at</div>
                        <div>nam nunc...</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Code</h1>
                        <div>`Inline Code`</div>
                        <br />
                        <div>``` C#</div>
                        <div>if (foo==bar)</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbspbar++</div>
                        <div>```</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>References</h1>
                        <div>[Link Text](URL)</div>
                        <br />
                        <div>![Image](URL)</div>
                        <br />
                        <a class="Reference" target="_blank" href="http://codeplex.codeplex.com/wikipage?title=Markdown&referringTitle=Documentation">Markdown Reference</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div id="preview_contents_3b8ef7dc-9e84-45b4-9ab0-044734bc1bab" class="preview_tab_content markDownOutput">
        
            <div></div>
        
    </div>
    <div class="clear"></div>
</div>

            
            <div class="row" id="recaptcha_row">
                
<script type="text/javascript">
    $(document).ready(function () {
        $('#recaptcha_reload').attr('src', '../assets/recaptcha_refresh.png');
        $('#recaptcha_switch_audio').attr('src', '../assets/recaptcha_audio.png');
        $('#recaptcha_switch_img').attr('src', '../assets/recaptcha_text.png');
        $('#recaptcha_whatsthis').attr('src', '../assets/recaptcha_help.png');
        $('#recaptcha_area tr:first').attr('height', '35');
    });
</script>

                <div class="clear"></div>
                <span id="ReCaptchaError"></span>
            </div>
            <div style="padding-top: 6px;">
                <input type="button" id="SaveButton" value="Save" class="ok" />
                <input type="button" id="CancelButton" value="Cancel" class="cancel" />
                <div class="clear"></div>
            </div>
        </div>
    </div>
</div>

<div id="DeletePostPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Post <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this post? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="ClosePostCancel" value="Cancel" class="cancel" />
            <input type="button" id="ClosePostOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>
        
            <!-- Email notification / Subscription details -->
            
    </div>
</div>
    
<div id="DeleteThreadPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Thread <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this thread? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="CloseThreadCancel" value="Cancel" class="cancel" />
            <input type="button" id="CloseThreadOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>

<script type="text/javascript" language="javascript">
    $(function () {

        $('#recaptcha_response_field')
            .bind('keypress', function (event) { return $submitKeyPressElement(this, event); });


        if ($('#DeleteThreadLink')) {
            $('#DeleteThreadLink').click(function () {
                OpenDialog('#DeleteThreadPanel', true, '41em');
            });
        }
        
        $('#DeleteThreadPanel #CloseThreadOk').click(function () {
            var url = 'http://unity.codeplex.com/discussions/284557';
            $.ajax({
                url: url,
                type: 'DELETE',
                success: function (x) {
                    location.href = x.RedirectUrl;
                }
            });
        });
    });

    workItemMention = new codeplex.ui.WorkItemMention();
    workItemMention.addLinks(".discussionPost");
</script>


        
        
                
                <div class="clear"></div>
                
                <div id="footer">
                    <div class="row">
                        <hr />
                        <ul>
                            <li>Â© 2006-2017 Microsoft</li>
                            <li><a href="http://www.codeplex.com/site/help">Get Help</a></li>
                            <li><a href="/site/legal/privacy">Privacy Statement</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/terms">Terms of Use</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/conduct">Code of Conduct</a></li>
                            <li><a href="http://developermedia.com/" target="_blank">Advertise With Us</a></li>
                            <li>Version 2017.10.3.21062</li>
                        </ul>
                    </div>
                </div>
            </div>
        </form>
    </body>

</html>