

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="" prefix="og: http://ogp.me/ns# profile: http://ogp.me/ns/profile#">
    
    
    
    

    
    <head>
        <meta id="CompatabilityMode" http-equiv="X-UA-Compatible" content="IE=edge" />
	    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../assets/StyleSheet.css" id="MasterCss" rel="stylesheet" type="text/css" />
        <link rel="SHORTCUT ICON" href="../assets/favicon.ico" />
        <title>patterns &#38; practices - Unity - Could not load file or assembly &#39;Microsoft.Practices.Unity.Configuration</title>
        
       
                    <script src="../assets/mscc-0.3.6.min.js"></script>
        
                    <link rel="stylesheet" type="text/css" href="../assets/mscc-0.3.6.min.css" />
        
            <script type="text/javascript">
                var msccHadCookieBannerAtPageStart = true;
            </script>
        

        <!--
        Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code,
        not by Microsoft.  See ASP.NET Ajax CDN Terms of Use â€“ http://www.asp.net/ajaxlibrary/CDN.ashx.
        -->
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.4.4.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery === 'undefined') {
                document.write(unescape("%3Cscript src='https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        <script src="https://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.6/jquery-ui.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery.ui === 'undefined') {
                document.write(unescape("%3Cscript src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        
    <style type="text/css">.SideBar, .SideBarPadding{display:none;}.MainContent{width:auto;}.SiteContentTable{width:100%;}</style>
    <style id="ProjectStyles" type="text/css">
        .SiteHeader, .SiteHeaderLeft {
            height:45px !important;
            overflow:hidden;
        }
        .SiteContent 
        {
            padding: 0 0 1em 0;
            margin-top:0;
            min-height:225px;
            border-right: 1px solid lightgrey;
            border-left: 1px solid lightgrey;
            border-bottom: 1px solid lightgrey;
        }
        .IE table.MinWidthContent
        {
	        table-layout: auto !important;	
        }
    </style>
    
    
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">

    
    
    <meta id="WTProjectName" name="WT.pi" content="unity"/>
    

    <link rel="EditURI" type="application/rsd+xml" title="RSD" href='http://unity.codeplex.com/rsd' />
    <link rel="wlwmanifest" type="application/wlwmanifest+xml" title="WLWManifest" href='/wlwmanifest.xml' />
    
    
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity" url="http://unity.codeplex.com/project/feeds/rss"/>
    
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Discussions" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2funity"/>
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Issues" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2funity"/>
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Downloads" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2funity"/>
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Reviews" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2funity"/>
        
    
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Source&#32;code" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2funity"/>
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Wiki" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2funity"/>
    
        
    
        <meta content="summary" name="twitter:card" /><meta content="@CodePlex" name="twitter:site" /><meta content="http://unity.codeplex.com/discussions/27276?ProjectName=unity" name="twitter:url" /><meta content="patterns &amp;#38; practices - Unity" name="twitter:title" /><meta content="The Unity Application Block &amp;#40;Unity&amp;#41; is officially under new ownership.&amp;#13;&amp;#10;https&amp;#58;&amp;#47;&amp;#47;github.com&amp;#47;unitycontainer&amp;#47;unity" name="twitter:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" name="twitter:image" /><meta content="CodePlex" property="og:site_name" /><meta content="http://unity.codeplex.com/discussions/27276?ProjectName=unity" property="og:url" /><meta content="object" property="og:type" /><meta content="patterns &amp;#38; practices - Unity" property="og:title" /><meta content="The Unity Application Block &amp;#40;Unity&amp;#41; is officially under new ownership.&amp;#13;&amp;#10;https&amp;#58;&amp;#47;&amp;#47;github.com&amp;#47;unitycontainer&amp;#47;unity" property="og:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" property="og:image" />
        

    </head>
    
    <body>
         
            
        <script src="../assets/ScriptLoader.js" type="text/javascript"></script>
        <form id="aspnetForm" autocomplete="off" method="POST" enctype="multipart/form-data">
            <input name="__RequestVerificationToken" type="hidden" value="cHT_p9hQhVF3fWTaDG7IwHWTafHJK3D8tGYZjuMPDrLz2P80VTNrAzJQ3rnKby5O1MiPjscCKjtevBPJpcRrYw2i9YgjqIW3eUT0QzV2i83UyLASIXv6608e62Xe89CLqBplvA2" /><input name="__RequestVerificationToken2" type="hidden" value="__RequestVerificationToken2ad862db1-2b07-4afb-a860-142dae8993af" />
            
            <div id="UpdateProgressPanel" class="loading_animation" style="display:none;">
                <div class="row">
                    <h2 class="anim_h2">
                        <span id="UpdateProgressText">Updating...</span>
                        <span id="animatedLoadingIconContainer">
                            <img id="animatedLoadingIcon" src="../assets/loading_animation.gif" class="anim_img"/>
                        </span>
                    </h2>
                </div>
            </div>
            
            <div style="display:none;">
                
                <img id="BlankImage" style="width:0;height:0;" src="../assets/blank.png" onload="self.logoImageLoaded=true;"/>

                <script language="javascript" type="text/javascript">
                    var date = new Date();
                    var timezoneOffset = date.getTimezoneOffset() / 60 * -1;
                    var timezoneOffsetCookie = getCookie("TimezoneOffset");
                    var firstTimeSetTimezoneCookie = false;

                    if (timezoneOffsetCookie == null || timezoneOffsetCookie != timezoneOffset) {
                        firstTimeSetTimezoneCookie = true;
                        document.cookie = "TimezoneOffset=" + timezoneOffset + '; domain=.codeplex.com;expires=Wed, 10 Oct 2018 05:28:55 UTC';
                    }
                </script>
            </div>
            
            
            <div id="banner">
                <div id="message"><strong>This is an archived copy of the original CodePlex Unity Discussion Forum.</strong> <a href="https://github.com/unitycontainer/">Unity is now on GitHub</a>
                    
                </div>
            </div>
            

            <div id="header">
                <div id="header_wrap" class="row">
                    <p id="logo"><a href="http://www.codeplex.com">Code<span class="semi">Plex</span></a><span id="tagline">Project Hosting for Open Source Software</span></p>
                    

<ul id="nav">

    <li><a href="/site/register/new" id="registerLink" class="ZoomFix">Register</a></li>
    <li ><a class="SignInLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2funity.codeplex.com%2fdiscussions%2f27276" id="signInLink">Sign In</a></li>
  
    <li class="last"><a class="rss_site_icon" href="http://www.codeplex.com/site/feeds/rss" type="application/rss+xml" rel="Alternate" title="CodePlex Site Activity"></a></li>
</ul>
                    <input id="searchsite" name="searchsite" maxlength="500" type="text" value="" /><span id="search_mag"><a id="submitSearch" name="submitSearch" class="magnify" title="Search" href="#"></a></span>
                    <script>
	$(document).ready(function() {
    var searchButton = $('#submitSearch'),
        searchBar = $('#searchsite');

    // Register our own handler for the search event while we wait for the SearchBox script to load.
    searchButton.bind('click.backupSearchBox', doProjectSearch);
    searchBar.bind('keypress.backupSearchBox', function(e) { if ($keyCode(e) === 13) { doProjectSearch(); return false; } });

    function cleanupSearchEvents() {
        // If the SearchBox was loaded, unregister our handlers.
        if (epx_loaded) {
            searchButton.unbind('.backupSearchBox');
            searchBar.unbind('.backupSearchBox');
        }
    }

    $loadScript('https://i4.services.social.microsoft.com/search/Widgets/SearchBox.jss?appid=1000&scopeid=1&boxId=searchsite&btnId=submitSearch&watermark=Search%20all%20projects&overrideWatermark=true&searchLocation=https%3A%2F%2Fwww.codeplex.com%2Fsite%2Fsearch&allowEmptySearch=true&focusOnInit=False&minimumTermLength=3', cleanupSearchEvents);
})
function doProjectSearch() {
    
    var url = 'https://www.codeplex.com/site/search';

    //If search term is not same as watermark
    if($('#searchsite').val() != 'Search all projects')    
    {        
        url = url + '?query=' + encodeURIComponent($('#searchsite').val());
    }

    
    var callback = '';
    if (callback.length > 0 && eval('typeof ' + callback) != 'undefined')
        url += eval(callback + '()');

    window.location.href = url;
    return false;
}
</script>
                </div>
            </div>
            
            <div id="wrap">
                
    <div id="sub_heading" class="row">
        
        <div id="ProjectHeader">
            <div id="project_title_row" class="row">
                <div id="project_logo">
                    
<a id="AffiliateLink" href="http://msdn.microsoft.com/practices">
    <img id="AffiliateImage" src="../assets/pnp_logo.png" title="patterns&#32;&#38;&#32;practices" />
</a>

    
    <h1 class="text_only"><a href="http://unity.codeplex.com/" id="ProjectTitle1"><div>patterns &#38; practices - Unity</div></a></h1>

                </div>
            </div>
        </div>
        
        <div id="ProjectDetailsDiv">
            
        </div>
		<div class="clear"></div>
        

<ul id="page_box_links">
	<li id="homeTabCell" style="width: 63px;"><a id="homeTab" href="http://unity.codeplex.com/" class="box_home">home</a><div></div></li>
    
	<li id="sourceTabCell" style="width:113px;"><a id="sourceTab" href="http://unity.codeplex.com/SourceControl/latest" class="box_source">source code</a><div></div></li>
    
	<li id="releasesTabCell" style="width:105px;"><a id="releasesTab" href="http://unity.codeplex.com/releases" class="box_downloads">downloads</a><div></div></li>
    
    <li id="documentationTabCell" style="width:143px;"><a id="documentationTab" href="http://unity.codeplex.com/documentation" class="box_documentation">documentation</a><div></div></li>
    
	<li id="discussionTabCell" style="width:112px;"><a id="discussionTab" href="../index.html" class="discussions_active">discussions</a><div></div></li>
    
	<li id="workItemsTabCell" style="width:70px;"><a id="workItemsTab" href="http://unity.codeplex.com/workitem/list/basic" class="box_issue">issues</a><div></div></li>
    
	<li id="peopleTabCell" style="width:70px;"><a id="peopleTab" href="http://unity.codeplex.com/team/view" class="box_people">people</a><div></div></li>
	<li id="licenseTabCell" style="width:70px;"><a id="licenseTab" href="http://unity.codeplex.com/license" class="box_license">license</a><div></div></li>
    
    <span class="stretch"></span>
</ul>

<script type="text/javascript">
    $(document).ready(function () {
        $('#page_box_links').applyLastClassToList();
    });
</script>
		    <div class="clear"></div>
            
     <td>
       

<div>
    
    <div id="actionBar" class="action_bar">
        <ul id="actionBar_ul" class="actionBar_sublinks subtab_right" style="vertical-align: middle;">

            

                <li id="li_actionbar_creatediscussion" data-action-id="actionbar_creatediscussion" data-action-type="Navigate" class="actionBar_sublinks" data-options-id="be36cf0e-9ce3-4086-9bba-a34f98c3ca60">
                
                    <script class="options" defer="defer" id="be36cf0e-9ce3-4086-9bba-a34f98c3ca60" type="application/json">{"navigate-url":"http://unity.codeplex.com/discussions/create"}</script> 
                    
                    <div class="actionBar_custom_content"></div>

                    <a href="#" id="actionbar_creatediscussion" title="Start a New Thread" class="action_bar_item_link">
                        <img id="img_actionbar_creatediscussion" class="action_bar_item_image" src="../assets/actionbar_newitem.png" style="vertical-align: middle" />
                        New Thread
                    </a>

                </li>

            

                <li id="li_actionbar_subscribe" data-action-id="actionbar_subscribe" data-action-type="PopUp" class="actionBar_sublinks" data-options-id="5821d4a4-ed18-49ba-bd1b-3f4bf05b51fb">
                
                    <script class="options" defer="defer" id="5821d4a4-ed18-49ba-bd1b-3f4bf05b51fb" type="application/json">{}</script> 
                    
                    <div class="actionBar_custom_content">

<div id="rssHoverDiv" class="HoverPanel LeftHoverWidth" style="display: none">
        <ul id="3_FeedsPanel" class="RssFeedsPanel">
            <li>
                <a id="ProjectRssLink" href="http://unity.codeplex.com/project/feeds/rss" class="ArrowSmall NoUnderline">All Project Updates</a>
            </li>
            
            <li>
                <a id="DiscussionRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2funity" class="ArrowSmall NoUnderline">Discussions</a>
            </li>
            
            <li>
                <a id="IssueTrackerRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2funity" class="ArrowSmall NoUnderline">Issue Tracker</a>
            </li>
            
            <li>
                <a id="ReleasesRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2funity" class="ArrowSmall NoUnderline">Downloads</a>
            </li>
            <li>
                <a id="ReviewsRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2funity" class="ArrowSmall NoUnderline">Reviews</a>
            </li>
            
            <li>
                <a id="SourceControlRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2funity" class="ArrowSmall NoUnderline">Source Code</a>
            </li>
            <li>
                <a id="WikiRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2funity" class="ArrowSmall NoUnderline">Wiki &amp; Documentation</a>
            </li>
        </ul>
</div></div>

                    <a href="#" id="actionbar_subscribe" title="Subscribe to project updates in RSS feeds." class="action_bar_item_link">
                        <img id="img_actionbar_subscribe" class="action_bar_item_image" src="../assets/actionbar_subscribe.png" style="vertical-align: middle" />
                        Subscribe
                    </a>

                </li>

            
        </ul>
    </div>
</div>
     </td>

        

    </div>
    
    
<div class="Threads">
    <div class="ViewThread">
        
        
        
            <h1 class="page_title WordWrapBreakWord">
                Could not load file or assembly &#39;Microsoft.Practices.Unity.Configuration
            </h1>

            <!-- Private Discussion header -->
            

            <!-- Posts List Header: Topics and Wiki Link -->
            <table class="PostsListHeader">
                <tr>
                    <td>
                     
                    </td>
                    <td>
                        <div class="WikiLink">
                            <span title="Paste this into a wiki page to link to this discussion">
                                Wiki Link: [discussion:27276]
                            </span>
                        </div>
                    </td>
                </tr>
            </table>

            <!-- The list of posts -->
            

<div id="discussionsPostList" data-options-id="aee06fc7-1789-4467-a1b4-5fef1b2bf331">
    <script class="options" defer="defer" id="aee06fc7-1789-4467-a1b4-5fef1b2bf331" type="application/json">{"threadUrl":"http://unity.codeplex.com/discussions/27276","showEditor":false,"checkImageUrl":"../assets/check_answer.png"}</script>

    <div class="Posts" style="margin-top: 10px;">
    

<table cellpadding="0" cellspacing="0" style="width: 100%; margin-bottom: 0px; table-layout:fixed">
    

<tr id="PostPanel" class="Post" d:forid="90970">
    <td id="PostDetailsCell_90970" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post90970"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/sanchaykulkarni">sanchaykulkarni</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/7/2008 2:02:45 PM" LocalTimeTicks="1210194165">May 7, 2008 at 2:02 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_90970" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;Hi,I&#32;am&#32;getting&#32;the&#32;error&#32;&#34;An&#32;error&#32;occurred&#32;creating&#32;the&#32;configuration&#32;section&#32;handler&#32;for&#32;unity&#58;&#32;Could&#32;not&#32;load&#32;file&#32;or&#32;assembly&#32;&#39;Microsoft.Practices.Unity.Configuration,&#32;Version&#61;1.0.0.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35&#39;&#32;or&#32;one&#32;of&#32;its&#32;dependencies.&#32;The&#32;system&#32;cannot&#32;find&#32;the&#32;file&#32;specified.&#32;&#40;C&#58;&#92;Projects&#92;bin&#92;MyFile.config&#32;line&#32;4&#41;&#34;The&#32;config&#32;file&#32;is---&#38;lt&#59;&#63;xml&#32;version&#61;&#34;1.0&#34;&#32;encoding&#61;&#34;utf-8&#34;&#32;&#63;&#38;gt&#59;&#38;lt&#59;configuration&#38;gt&#59;&#32;&#38;lt&#59;configSections&#38;gt&#59;&#32;&#38;lt&#59;section&#32;name&#61;&#34;unity&#34;&#32;type&#61;&#34;Microsoft.Practices.Unity.Configuration.UnityConfigurationSection,&#32;Microsoft.Practices.Unity.Configuration,&#32;Version&#61;1.0.0.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35&#34;&#47;&#38;gt&#59;&#32;&#38;lt&#59;&#47;configSections&#38;gt&#59;&#32;&#38;lt&#59;unity&#38;gt&#59;&#32;&#38;lt&#59;containers&#38;gt&#59;---code&#32;used&#32;isExeConfigurationFileMap&#32;map&#32;&#61;&#32;new&#32;ExeConfigurationFileMap&#40;&#41;&#59;&#32;map.ExeConfigFilename&#32;&#61;&#32;&#34;C&#58;&#92;Projects&#92;bin&#92;MyFile.config&#34;&#59;&#32;System.Configuration.Configuration&#32;config&#32;&#61;&#32;ConfigurationManager.OpenMappedExeConfiguration&#40;map,&#32;ConfigurationUserLevel.None&#41;&#59;&#32;UnityConfigurationSection&#32;section&#32;&#61;&#32;new&#32;UnityConfigurationSection&#40;&#41;&#59;&#32;ConfigurationSection&#32;cs&#32;&#61;&#32;config.GetSection&#40;&#34;unity&#34;&#41;&#59;The&#32;last&#32;line&#32;gives&#32;error.">
        Hi,<br>
<br>
I am getting the error <br>
&quot;An error occurred creating the configuration section handler for unity: Could not load file or assembly 'Microsoft.Practices.Unity.Configuration, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system cannot
 find the file specified. (C:\Projects\bin\MyFile.config line 4)&quot;<br>
<br>
The config file is<br>
---<br>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;<br>
&lt;configuration&gt;<br>
&lt;configSections&gt;<br>
&lt;section name=&quot;unity&quot;<br>
type=&quot;Microsoft.Practices.Unity.Configuration.UnityConfigurationSection,<br>
Microsoft.Practices.Unity.Configuration, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;/&gt;<br>
&lt;/configSections&gt;<br>
&lt;unity&gt;<br>
&lt;containers&gt;<br>
---<br>
<br>
code used is<br>
<br>
ExeConfigurationFileMap map = new ExeConfigurationFileMap();<br>
map.ExeConfigFilename = &quot;C:\Projects\bin\MyFile.config&quot;;<br>
System.Configuration.Configuration config<br>
= ConfigurationManager.OpenMappedExeConfiguration(map, ConfigurationUserLevel.None);<br>
UnityConfigurationSection section = new UnityConfigurationSection();<br>
ConfigurationSection cs = config.GetSection(&quot;unity&quot;);<br>
<br>
The last line gives error.<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_90970" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="91078">
    <td id="PostDetailsCell_91078" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post91078"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/pbolduc">pbolduc</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/7/2008 10:25:36 PM" LocalTimeTicks="1210224336">May 7, 2008 at 10:25 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_91078" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;I&#32;have&#32;a&#32;few&#32;questions&#32;for&#32;you.Do&#32;you&#32;have&#32;a&#32;reference&#32;to&#32;Microsoft.Practices.Unity.Configuration.dll&#32;&#63;&#32;I&#32;would&#32;think&#32;so&#32;since&#32;code&#32;wouldn&#39;t&#32;compile.&#32;Are&#32;attempting&#32;to&#32;run&#32;this&#32;from&#32;a&#32;unit&#32;test&#32;or&#32;somewhere&#32;else&#32;where&#32;your&#32;application&#32;base&#32;&#40;ie&#32;working&#32;directory&#41;&#32;would&#32;be&#32;different&#32;than&#32;C&#58;&#92;Projects&#92;bin&#32;&#63;Is&#32;Microsoft.Practices.Unity.Configuration.dll&#32;in&#32;C&#58;&#92;Projects&#92;bin&#32;&#63;sanchaykulkarni&#32;wrote&#58;Hi,I&#32;am&#32;getting&#32;the&#32;error&#32;&#34;An&#32;error&#32;occurred&#32;creating&#32;the&#32;configuration&#32;section&#32;handler&#32;for&#32;unity&#58;&#32;Could&#32;not&#32;load&#32;file&#32;or&#32;assembly&#32;&#39;Microsoft.Practices.Unity.Configuration,&#32;Version&#61;1.0.0.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35&#39;&#32;or&#32;one&#32;of&#32;its&#32;dependencies.&#32;The&#32;system&#32;cannot&#32;find&#32;the&#32;file&#32;specified.&#32;&#40;C&#58;&#92;Projects&#92;bin&#92;MyFile.config&#32;line&#32;4&#41;&#34;The&#32;config&#32;file&#32;is---&#38;lt&#59;&#63;xml&#32;version&#61;&#34;1.0&#34;&#32;encoding&#61;&#34;utf-8&#34;&#32;&#63;&#38;gt&#59;&#38;lt&#59;configuration&#38;gt&#59;&#32;&#38;lt&#59;configSections&#38;gt&#59;&#32;&#38;lt&#59;section&#32;name&#61;&#34;unity&#34;&#32;type&#61;&#34;Microsoft.Practices.Unity.Configuration.UnityConfigurationSection,&#32;Microsoft.Practices.Unity.Configuration,&#32;Version&#61;1.0.0.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35&#34;&#47;&#38;gt&#59;&#32;&#38;lt&#59;&#47;configSections&#38;gt&#59;&#32;&#38;lt&#59;unity&#38;gt&#59;&#32;&#38;lt&#59;containers&#38;gt&#59;---code&#32;used&#32;isExeConfigurationFileMap&#32;map&#32;&#61;&#32;new&#32;ExeConfigurationFileMap&#40;&#41;&#59;&#32;map.ExeConfigFilename&#32;&#61;&#32;&#34;C&#58;&#92;Projects&#92;bin&#92;MyFile.config&#34;&#59;&#32;System.Configuration.Configuration&#32;config&#32;&#61;&#32;ConfigurationManager.OpenMappedExeConfiguration&#40;map,&#32;ConfigurationUserLevel.None&#41;&#59;&#32;UnityConfigurationSection&#32;section&#32;&#61;&#32;new&#32;UnityConfigurationSection&#40;&#41;&#59;&#32;ConfigurationSection&#32;cs&#32;&#61;&#32;config.GetSection&#40;&#34;unity&#34;&#41;&#59;The&#32;last&#32;line&#32;gives&#32;error.">
        I have a few questions for you.<br>
<br>
<ol>
<li>Do you have a reference to Microsoft.Practices.Unity.Configuration.dll ? I would think so since code wouldn't compile.
</li><li>Are attempting to run this from a unit test or somewhere else where your application base (ie working directory) would be different than C:\Projects\bin ?</li><li>Is Microsoft.Practices.Unity.Configuration.dll in C:\Projects\bin ?</li></ol>
<br>
<div style="border:dotted .1em #aaa; border-left:none; border-right:none; font-style:italic; margin:1em 0em 2.5em 3em; padding:.2em">
<br>
sanchaykulkarni wrote:<br>
Hi,<br>
<br>
I am getting the error <br>
&quot;An error occurred creating the configuration section handler for unity: Could not load file or assembly 'Microsoft.Practices.Unity.Configuration, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system cannot
 find the file specified. (C:\Projects\bin\MyFile.config line 4)&quot;<br>
<br>
The config file is<br>
---<br>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;<br>
&lt;configuration&gt;<br>
&lt;configSections&gt;<br>
&lt;section name=&quot;unity&quot;<br>
type=&quot;Microsoft.Practices.Unity.Configuration.UnityConfigurationSection,<br>
Microsoft.Practices.Unity.Configuration, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;/&gt;<br>
&lt;/configSections&gt;<br>
&lt;unity&gt;<br>
&lt;containers&gt;<br>
---<br>
<br>
code used is<br>
<br>
ExeConfigurationFileMap map = new ExeConfigurationFileMap();<br>
map.ExeConfigFilename = &quot;C:\Projects\bin\MyFile.config&quot;;<br>
System.Configuration.Configuration config<br>
= ConfigurationManager.OpenMappedExeConfiguration(map, ConfigurationUserLevel.None);<br>
UnityConfigurationSection section = new UnityConfigurationSection();<br>
ConfigurationSection cs = config.GetSection(&quot;unity&quot;);<br>
<br>
The last line gives error.<br>
<br>
</div>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_91078" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="91086">
    <td id="PostDetailsCell_91086" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post91086"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/yazidarezki">yazidarezki</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/7/2008 11:05:27 PM" LocalTimeTicks="1210226727">May 7, 2008 at 11:05 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_91086" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;Hello,I&#32;tried&#32;this&#32;code&#32;and&#32;it&#32;worked&#32;ExeConfigurationFileMap&#32;map&#32;&#61;&#32;new&#32;ExeConfigurationFileMap&#40;&#41;&#59;&#32;map.ExeConfigFilename&#32;&#61;&#32;&#34;MyFile.config&#34;&#59;&#32;System.Configuration.Configuration&#32;config&#32;&#61;&#32;ConfigurationManager.OpenMappedExeConfiguration&#40;map,&#32;ConfigurationUserLevel.None&#41;&#59;&#32;UnityConfigurationSection&#32;cs&#32;&#61;&#32;&#40;UnityConfigurationSection&#41;&#32;config.GetSection&#40;&#34;unity&#34;&#41;&#59;&#32;CheersYaz">
        Hello,<br>
<br>
I tried this code and it worked<br>
<br>
<pre style="background-color:#ECECEC; border:dashed .1em #3E62A6; font-family:Consolas,Courier New,Courier,Monospace; font-size:1em; margin-top:0; padding:.5em; height:auto; overflow:auto; overflow-x:auto; overflow-y:auto">
ExeConfigurationFileMap map = new ExeConfigurationFileMap();
map.ExeConfigFilename = &quot;MyFile.config&quot;;
System.Configuration.Configuration config
= ConfigurationManager.OpenMappedExeConfiguration(map, ConfigurationUserLevel.None);
UnityConfigurationSection cs = (UnityConfigurationSection) config.GetSection(&quot;unity&quot;);
 
</pre>
<br>
Cheers<br>
Yaz<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_91086" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="91134">
    <td id="PostDetailsCell_91134" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post91134"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/sanchaykulkarni">sanchaykulkarni</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/8/2008 5:49:39 AM" LocalTimeTicks="1210250979">May 8, 2008 at 5:49 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_91134" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;pbolduc&#32;&#58;&#32;&#32;1.&#32;Do&#32;you&#32;have&#32;a&#32;reference&#32;to&#32;Microsoft.Practices.Unity.Configuration.dll&#32;&#63;&#32;I&#32;would&#32;think&#32;so&#32;since&#32;code&#32;wouldn&#39;t&#32;compile.Yes,&#32;Microsoft.Practices.Unity.Configuration.dll,&#32;Microsoft.Practices.ObjectBuilder2.dll,&#32;Microsoft.Practices.Unity.dll&#32;are&#32;referred&#32;in&#32;the&#32;project.&#32;2.&#32;Are&#32;attempting&#32;to&#32;run&#32;this&#32;from&#32;a&#32;unit&#32;test&#32;or&#32;somewhere&#32;else&#32;where&#32;your&#32;application&#32;base&#32;&#40;ie&#32;working&#32;directory&#41;&#32;would&#32;be&#32;different&#32;than&#32;C&#58;&#92;Projects&#92;bin&#32;&#63;Working&#32;directory&#32;is&#32;same.&#32;3.&#32;Is&#32;Microsoft.Practices.Unity.Configuration.dll&#32;in&#32;C&#58;&#92;Projects&#92;bin&#32;&#63;All&#32;the&#32;3&#32;files&#32;along&#32;with&#32;the&#32;config&#32;file&#32;are&#32;in&#32;the&#32;above&#32;folder.---------Yaz&#58;ExeConfigurationFileMap&#32;map&#32;&#61;&#32;new&#32;ExeConfigurationFileMap&#40;&#41;&#59;map.ExeConfigFilename&#32;&#61;&#32;&#34;MyFile.config&#34;&#59;&#47;&#47;This&#32;line&#32;of&#32;code&#32;can&#39;t&#32;find&#32;the&#32;file&#32;&#34;MyFile.config&#34;,&#32;as&#32;the&#32;current&#32;dir.&#32;is&#32;by&#32;default&#32;set&#32;to&#32;&#34;MyDocuments&#34;&#32;folder.System.Configuration.Configuration&#32;config&#61;&#32;ConfigurationManager.OpenMappedExeConfiguration&#40;map,&#32;ConfigurationUserLevel.None&#41;&#59;UnityConfigurationSection&#32;cs&#32;&#61;&#32;&#40;UnityConfigurationSection&#41;&#32;config.GetSection&#40;&#34;unity&#34;&#41;&#59;">
        pbolduc : <br>
<br>
1. Do you have a reference to Microsoft.Practices.Unity.Configuration.dll ? I would think so since code wouldn't compile.<br>
Yes, Microsoft.Practices.Unity.Configuration.dll, Microsoft.Practices.ObjectBuilder2.dll, Microsoft.Practices.Unity.dll are referred in the project.<br>
2. Are attempting to run this from a unit test or somewhere else where your application base (ie working directory) would be different than C:\Projects\bin ?<br>
Working directory is same.<br>
3. Is Microsoft.Practices.Unity.Configuration.dll in C:\Projects\bin ?<br>
All the 3 files along with the config file are in the above folder.<br>
<br>
---------<br>
Yaz:<br>
<br>
ExeConfigurationFileMap map = new ExeConfigurationFileMap();<br>
map.ExeConfigFilename = &quot;MyFile.config&quot;;//This line of code can't find the file &quot;MyFile.config&quot;, as the current dir. is by default set to &quot;MyDocuments&quot; folder.<br>
System.Configuration.Configuration config<br>
= ConfigurationManager.OpenMappedExeConfiguration(map, ConfigurationUserLevel.None);<br>
UnityConfigurationSection cs = (UnityConfigurationSection) config.GetSection(&quot;unity&quot;);<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_91134" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="91156">
    <td id="PostDetailsCell_91156" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post91156"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/yazidarezki">yazidarezki</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/8/2008 8:06:12 AM" LocalTimeTicks="1210259172">May 8, 2008 at 8:06 AM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="5/8/2008 8:29:10 AM" LocalTimeTicks="1210260550">May 8, 2008 at 8:29 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_91156" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;Hello,I&#32;have&#32;tried&#32;with&#32;the&#32;full&#32;path&#32;and&#32;it&#32;works&#32;for&#32;me,&#32;one&#32;question&#32;for&#32;you.&#32;Is&#32;the&#32;DLL&#32;that&#32;runs&#32;the&#32;code&#32;in&#32;C&#58;&#92;projects&#92;bin&#32;folder&#63;CheersYaz">
        Hello,<br>
<br>
I have tried with the full path and it works for me, one question for you. Is the DLL that runs the code in C:\projects\bin folder?<br>
<br>
Cheers<br>
Yaz<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_91156" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="91170">
    <td id="PostDetailsCell_91170" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post91170"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/sanchaykulkarni">sanchaykulkarni</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/8/2008 8:52:17 AM" LocalTimeTicks="1210261937">May 8, 2008 at 8:52 AM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="5/8/2008 8:53:29 AM" LocalTimeTicks="1210262009">May 8, 2008 at 8:53 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_91170" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;Yes,&#32;it&#32;is&#32;there.&#32;Default&#32;project&#32;output&#32;is&#32;not&#32;changed,&#32;hence&#32;its&#32;in&#32;C&#58;&#92;Projects&#92;bin&#32;folder.&#32;Another&#32;thought&#58;As&#32;per&#32;my&#32;knowledge,&#32;Unity&#32;assemblies&#32;need&#32;not&#32;be&#32;put&#32;into&#32;the&#32;GAC,&#32;as&#32;long&#32;as&#32;they&#32;are&#32;available&#32;in&#32;the&#32;execution&#32;folder.&#32;So&#32;is&#32;this&#32;related&#32;to&#32;GAC&#32;in&#32;any&#32;way&#63;">
        Yes, it is there. Default project output is not changed, hence its in C:\Projects\bin folder.
<br>
<br>
Another thought:<br>
As per my knowledge, Unity assemblies need not be put into the GAC, as long as they are available in the execution folder. So is this related to GAC in any way?<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_91170" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="91175">
    <td id="PostDetailsCell_91175" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post91175"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/yazidarezki">yazidarezki</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/8/2008 9:49:38 AM" LocalTimeTicks="1210265378">May 8, 2008 at 9:49 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_91175" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;I&#32;do&#32;not&#32;have&#32;the&#32;Unity&#32;assemblies&#32;in&#32;the&#32;GAC&#32;and&#32;it&#32;works&#32;for&#32;me.Sorry&#32;that&#32;I&#32;am&#32;going&#32;to&#32;ask&#32;you&#32;some&#32;silly&#32;questions.You&#32;have&#32;a&#32;test&#32;project&#32;or&#32;console&#32;application&#32;and&#32;some&#32;code&#32;and&#32;MyFile.config.&#32;In&#32;the&#32;properties&#32;for&#32;the&#32;MyFile.config&#32;file,&#32;you&#32;have&#32;Copy&#32;to&#32;output&#32;directory,&#32;is&#32;this&#32;set&#32;to&#32;Copy&#32;always&#63;CheersYaz">
        I do not have the Unity assemblies in the GAC and it works for me.<br>
<br>
Sorry that I am going to ask you some silly questions.<br>
<br>
You have a test project or console application and some code and MyFile.config. In the properties for the MyFile.config file, you have Copy to output directory, is this set to Copy always?<br>
<br>
Cheers<br>
Yaz<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_91175" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="91176">
    <td id="PostDetailsCell_91176" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post91176"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/sanchaykulkarni">sanchaykulkarni</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/8/2008 10:31:37 AM" LocalTimeTicks="1210267897">May 8, 2008 at 10:31 AM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="5/8/2008 11:00:27 AM" LocalTimeTicks="1210269627">May 8, 2008 at 11:00 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_91176" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;Yes,&#32;the&#32;settings&#32;are&#32;same&#32;as&#32;mentioned&#32;above.I&#32;even&#32;tried&#32;deleting&#32;all&#32;Unity&#32;dlls&#32;and&#32;config&#32;file&#32;from&#32;bin&#32;folder,&#32;and&#32;they&#32;were&#32;again&#32;copied&#32;when&#32;I&#32;executed&#32;the&#32;appilcation.There&#32;is&#32;something&#32;else&#32;tricky&#32;here&#33;&#33;&#33;&#33;UPDATE&#58;I&#32;created&#32;a&#32;new&#32;console&#32;application,&#32;and&#32;its&#32;working&#32;there&#33;&#33;&#33;&#33;&#33;&#33;&#33;&#33;I&#32;am&#32;confused.">
        Yes, the settings are same as mentioned above.<br>
I even tried deleting all Unity dlls and config file from bin folder, and they were again copied when I executed the appilcation.<br>
<br>
There is something else tricky here!!!!<br>
<br>
UPDATE:<br>
I created a new console application, and its working there!!!!!!!!<br>
<br>
I am confused.<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_91176" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="100769">
    <td id="PostDetailsCell_100769" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post100769"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/booba12">booba12</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="6/25/2008 2:07:44 PM" LocalTimeTicks="1214428064">Jun 25, 2008 at 2:07 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_100769" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Are&#32;attempting&#32;to&#32;run&#32;this&#32;from&#32;a&#32;unit&#32;test&#32;or&#32;somewhere&#32;else&#32;where&#32;your&#32;application&#63;&#32;&#32;I&#32;am&#32;getting&#32;the&#32;error&#38;nbsp&#59;&#32;&#32;&#38;quot&#59;System.IO.FileNotFoundException&#58;&#32;Could&#32;not&#32;load&#32;file&#32;or&#32;assembly&#32;&#39;Microsoft.Practices.Unity,&#32;Version&#61;1.1.0.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35&#39;&#32;or&#32;one&#32;of&#32;its&#32;dependencies.&#32;Le&#32;fichier&#32;sp&#233;cifi&#233;&#32;est&#32;introuvable.&#61;&#61;&#61;&#32;Pre-bind&#32;state&#32;information&#32;&#61;&#61;&#61;&#38;quot&#59;&#32;knowing&#32;that&#32;it&#32;was&#32;an&#32;execution&#32;unit&#32;testing.&#32;&#32;What&#32;is&#32;the&#32;problem.&#32;&#32;Best&#32;regards&#32;">
        Are attempting to run this from a<strong> unit test</strong> or somewhere else where your application?<br>
<br>
I am getting the error&nbsp; <br>
&quot;System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.Practices.Unity, Version=1.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. Le fichier spÃ©cifiÃ© est introuvable.=== Pre-bind state information
 ===&quot;<br>
knowing that it was an execution unit testing. <br>
What is the problem. <br>
Best regards<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_100769" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="100927">
    <td id="PostDetailsCell_100927" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post100927"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/sanchaykulkarni">sanchaykulkarni</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="6/26/2008 3:58:40 AM" LocalTimeTicks="1214477920">Jun 26, 2008 at 3:58 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_100927" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="MS&#32;Excel&#32;VBA&#32;is&#32;calling&#32;a&#32;.Net&#32;Assembly&#32;&#40;DLL-1&#41;,&#32;and&#32;this&#32;assembly&#32;is&#32;calling&#32;another&#32;.Net&#32;Assembly&#32;&#40;DLL-2&#41;.&#32;DLL-2&#32;is&#32;referring&#32;to&#32;Unity&#32;dlls.&#32;&#32;When&#32;System.Configuration.Configuration&#32;reads&#32;the&#32;unity&#32;config&#32;file,&#32;it&#32;tries&#32;to&#32;locate&#32;the&#32;unity&#32;DLLs&#32;in&#32;the&#32;same&#32;folder&#32;where&#32;the&#32;Excel.EXE&#32;is&#32;located&#33;&#33;&#33;&#33;&#32;I&#32;verified&#32;this&#32;by&#32;copying&#32;the&#32;3&#32;DLLs&#32;in&#32;Excel.EXE&#32;foler,&#32;and&#32;its&#32;working&#32;fine.&#32;&#32;&#32;Microsoft.Practices.ObjectBuilder2.dll&#32;Microsoft.Practices.Unity.Configuration.dll&#32;Microsoft.Practices.Unity.dll&#32;&#32;BUT&#32;THIS&#32;IS&#32;NOT&#32;A&#32;GOOD&#32;AND&#32;VALID&#32;SOLUTON,&#32;something&#32;better&#32;must&#32;be&#32;done&#32;for&#32;the&#32;same.&#32;&#32;&#32;">
        MS Excel VBA is calling a .Net Assembly (DLL-1), and this assembly is calling another .Net Assembly (DLL-2). DLL-2 is referring to Unity dlls.<br>
<br>
When System.Configuration.Configuration reads the unity config file, it tries to locate the unity DLLs in the same folder where the Excel.EXE is located!!!! I verified this by copying the 3 DLLs in Excel.EXE foler, and its working fine.
<br>
<br>
Microsoft.Practices.ObjectBuilder2.dll<br>
Microsoft.Practices.Unity.Configuration.dll<br>
Microsoft.Practices.Unity.dll<br>
<br>
BUT THIS IS NOT A GOOD AND VALID SOLUTON, something better must be done for the same.<br>
<br>
<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_100927" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="100931">
    <td id="PostDetailsCell_100931" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post100931"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/ctavares">ctavares</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="6/26/2008 4:54:30 AM" LocalTimeTicks="1214481270">Jun 26, 2008 at 4:54 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_100931" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Can&#32;you&#32;run&#32;fuslogvw&#32;and&#32;look&#32;at&#32;everywhere&#32;Excel&#32;is&#32;trying&#32;to&#32;load&#32;the&#32;assemblies&#32;from&#63;&#32;There&#32;may&#32;be&#32;some&#32;more&#32;information&#32;available&#32;there.&#32;&#32;A&#32;sledgehammer&#32;solution&#32;would&#32;be&#32;to&#32;put&#32;the&#32;Unity&#32;assemblies&#32;in&#32;the&#32;GAC&#59;&#32;it&#32;should&#32;look&#32;there&#32;first.&#32;&#32;Otherwise,&#32;if&#32;we&#32;can&#39;t&#32;get&#32;your&#32;VBA&#32;&#38;amp&#59;&#32;excel&#32;to&#32;behave,&#32;you&#32;could&#32;use&#32;OpenMappedExe&#32;to&#32;manually&#32;specify&#32;where&#32;the&#32;configuration&#32;file&#32;is.&#32;&#32;&#32;&#32;">
        Can you run fuslogvw and look at everywhere Excel is trying to load the assemblies from? There may be some more information available there.<br>
<br>
A sledgehammer solution would be to put the Unity assemblies in the GAC; it should look there first.<br>
<br>
Otherwise, if we can't get your VBA &amp; excel to behave, you could use OpenMappedExe to manually specify where the configuration file is.<br>
<br>
<br>
<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_100931" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="100934">
    <td id="PostDetailsCell_100934" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post100934"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/AdeMiller">AdeMiller</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="6/26/2008 5:24:15 AM" LocalTimeTicks="1214483055">Jun 26, 2008 at 5:24 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_100934" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Running&#32;FUSLOGVW&#32;would&#32;certainly&#32;be&#32;a&#32;great&#32;step&#32;to&#32;figuring&#32;out&#32;what&#39;s&#32;being&#32;loaded&#32;where.&#32;The&#32;following&#32;blog&#32;post&#32;has&#32;some&#32;pointers&#32;as&#32;to&#32;how&#32;to&#32;do&#32;this.&#32;http&#58;&#47;&#47;www.ademiller.com&#47;blogs&#47;tech&#47;2008&#47;01&#47;gotchas-fusion-log-viewer-your-best-friend-for-assembly-load-errors&#47;&#32;&#32;If&#32;you&#32;configure&#32;FUSLOGVW&#32;and&#32;rerun&#32;your&#32;application&#32;you&#39;ll&#32;be&#32;able&#32;to&#32;see&#32;the&#32;failed&#32;assembly&#32;loads&#32;and&#32;the&#32;probing&#32;path&#32;that&#32;the&#32;loader&#32;tried&#32;to&#32;use&#32;and&#32;the&#32;AppDomain&#32;root.&#32;&#32;Second&#32;could&#32;you&#32;give&#32;us&#32;more&#32;details&#32;into&#32;what&#32;your&#32;application&#32;actually&#32;looks&#32;like.&#32;The&#32;whole&#32;VBA&#32;thing&#32;came&#32;as&#32;a&#32;bit&#32;of&#32;a&#32;surprise&#32;&#58;&#41;.&#32;Where&#32;are&#32;you&#32;executing&#32;the&#38;nbsp&#59;ExeConfigurationFileMap&#38;nbsp&#59;code&#63;&#32;One&#32;of&#32;the&#32;DLLs&#32;in&#32;your&#32;Projects&#92;bin&#32;folder&#32;right&#63;&#32;Which&#32;version&#32;of&#32;.NET&#32;and&#32;Excel&#32;are&#32;you&#32;using&#32;etc&#63;&#32;In&#32;the&#32;meantime&#32;I&#39;ll&#32;try&#32;and&#32;repro&#32;based&#32;on&#32;the&#32;info&#32;I&#32;have.&#32;Ade&#32;Microsoft&#32;p&#38;amp&#59;p&#32;&#32;http&#58;&#47;&#47;www.ademiller.com&#47;tech&#47;&#32;">
        
<p>Running FUSLOGVW would certainly be a great step to figuring out what's being loaded where. The following blog post has some pointers as to how to do this.</p>
<p><a href="http://www.ademiller.com/blogs/tech/2008/01/gotchas-fusion-log-viewer-your-best-friend-for-assembly-load-errors/" rel="nofollow">http://www.ademiller.com/blogs/tech/2008/01/gotchas-fusion-log-viewer-your-best-friend-for-assembly-load-errors/</a><br>
<br>
If you configure FUSLOGVW and rerun your application you'll be able to see the failed assembly loads and the probing path that the loader tried to use and the AppDomain root.<br>
<br>
Second could you give us more details into what your application actually looks like. The whole VBA thing came as a bit of a surprise :). Where are you executing the&nbsp;ExeConfigurationFileMap&nbsp;code? One of the DLLs in your Projects\bin folder right?
 Which version of .NET and Excel are you using etc?</p>
<p>In the meantime I'll try and repro based on the info I have.</p>
<p>Ade<br>
Microsoft p&amp;p <br>
<a href="http://www.ademiller.com/tech/" rel="nofollow">http://www.ademiller.com/tech/</a></p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_100934" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="100941">
    <td id="PostDetailsCell_100941" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post100941"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/AdeMiller">AdeMiller</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="6/26/2008 6:02:27 AM" LocalTimeTicks="1214485347">Jun 26, 2008 at 6:02 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_100941" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="So&#32;I&#39;m&#32;guessing&#32;you&#39;ll&#32;see&#32;something&#32;like&#32;this&#32;below.&#32;As&#32;various&#32;people&#32;have&#32;speculated&#32;the&#32;AppBase&#32;is&#32;set&#32;to&#32;that&#32;EXCEL&#32;folder.&#32;This&#32;is&#32;actually&#32;he&#32;behavior&#32;I&#39;d&#32;expect.&#32;Out&#32;of&#32;interest&#32;why&#32;are&#32;you&#32;using&#32;this&#32;approach.&#32;Have&#32;you&#32;considered&#32;creating&#32;a&#32;VSTO&#32;solution&#32;and&#32;then&#32;calling&#32;back&#32;into&#32;your&#32;VBA&#32;code.&#32;I&#32;suspect&#32;this&#32;is&#32;a&#32;better&#32;supported&#32;scenario&#32;although&#32;I&#39;ll&#32;follow&#32;up&#32;with&#32;the&#32;VBA&#47;VSTO&#32;team&#32;and&#32;see&#32;what&#32;they&#32;say..&#42;&#42;&#42;&#32;Assembly&#32;Binder&#32;Log&#32;Entry&#32;&#40;6&#47;25&#47;2008&#32;&#64;&#32;10&#58;48&#58;56&#32;PM&#41;&#32;&#42;&#42;&#42;&#32;The&#32;operation&#32;failed.&#32;Bind&#32;result&#58;&#32;hr&#32;&#61;&#32;0x80070002.&#32;The&#32;system&#32;cannot&#32;find&#32;the&#32;file&#32;specified.&#32;Assembly&#32;manager&#32;loaded&#32;from&#58;&#32;c&#58;&#92;WINDOWS&#92;Microsoft.NET&#92;Framework&#92;v2.0.50727&#92;mscorwks.dll&#32;Running&#32;under&#32;executable&#32;C&#58;&#92;Program&#32;Files&#92;Microsoft&#32;Office&#92;OFFICE11&#92;EXCEL.EXE&#32;---&#32;A&#32;detailed&#32;error&#32;log&#32;follows.&#32;&#61;&#61;&#61;&#32;Pre-bind&#32;state&#32;information&#32;&#61;&#61;&#61;&#32;LOG&#58;&#32;User&#32;&#61;&#32;Ade&#32;LOG&#58;&#32;DisplayName&#32;&#61;&#32;Microsoft.Practices.Unity.Configuration,&#32;Version&#61;1.0.0.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35&#32;&#40;Fully-specified&#41;&#32;LOG&#58;&#32;Appbase&#32;&#61;&#32;file&#58;&#47;&#47;&#47;C&#58;&#47;Program&#32;Files&#47;Microsoft&#32;Office&#47;OFFICE11&#47;&#32;LOG&#58;&#32;Initial&#32;PrivatePath&#32;&#61;&#32;NULL&#32;LOG&#58;&#32;Dynamic&#32;Base&#32;&#61;&#32;NULL&#32;LOG&#58;&#32;Cache&#32;Base&#32;&#61;&#32;NULL&#32;LOG&#58;&#32;AppName&#32;&#61;&#32;EXCEL.EXE&#32;Calling&#32;assembly&#32;&#58;&#32;System.Configuration,&#32;Version&#61;2.0.0.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;b03f5f7f11d50a3a.&#32;&#61;&#61;&#61;&#32;LOG&#58;&#32;Start&#32;binding&#32;of&#32;native&#32;image&#32;Microsoft.Practices.Unity.Configuration,&#32;Version&#61;1.0.0.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35.&#32;WRN&#58;&#32;No&#32;matching&#32;native&#32;image&#32;found.&#38;nbsp&#59;&#32;">
        
<pre>So I'm guessing you'll see something like this below. As various people have speculated the AppBase is set to that EXCEL folder. This is actually he behavior I'd expect. Out of interest why are you using this approach. Have you considered creating a VSTO solution and then calling back into your VBA code. I suspect this is a better supported scenario although I'll follow up with the VBA/VSTO team and see what they say.<br>.<br><br><br><br><br><br><br><br><br><br><hr><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>*** Assembly Binder Log Entry  (6/25/2008 @ 10:48:56 PM) ***

The operation failed.
Bind result: hr = 0x80070002. The system cannot find the file specified.

Assembly manager loaded from:  c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
Running under executable  C:\Program Files\Microsoft Office\OFFICE11\EXCEL.EXE
--- A detailed error log follows. 

=== Pre-bind state information ===
LOG: User = Ade
LOG: DisplayName = Microsoft.Practices.Unity.Configuration, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35
 (Fully-specified)
LOG: Appbase = file:///C:/Program Files/Microsoft Office/OFFICE11/
LOG: Initial PrivatePath = NULL
LOG: Dynamic Base = NULL
LOG: Cache Base = NULL
LOG: AppName = EXCEL.EXE
Calling assembly : System.Configuration, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a.
===
LOG: Start binding of native image Microsoft.Practices.Unity.Configuration, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35.
WRN: No matching native image found.&nbsp;</pre>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_100941" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="101043">
    <td id="PostDetailsCell_101043" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post101043"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/AdeMiller">AdeMiller</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="6/26/2008 4:59:57 PM" LocalTimeTicks="1214524797">Jun 26, 2008 at 4:59 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_101043" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="So&#32;I&#39;ve&#32;thought&#32;about&#32;this&#32;some&#32;more&#32;and&#32;this&#32;behavior&#32;is&#32;actually&#32;by&#32;design&#32;and&#32;nothing&#32;to&#32;do&#32;with&#32;Excel,&#32;VBA&#32;or&#32;Unity&#32;for&#32;that&#32;matter.&#32;&#32;This&#32;will&#32;occur&#32;in&#32;any&#32;case&#32;where&#32;you&#32;have&#32;an&#32;unmanaged&#32;application&#32;calling&#32;a&#32;.NET&#32;assembly.&#32;A&#38;nbsp&#59;CCW&#32;gets&#32;created&#32;and&#32;this&#32;&#32;try&#32;and&#32;load&#32;assemblies&#32;from&#32;either&#32;the&#32;GAC&#32;or&#32;the&#32;domain&#39;s&#32;AppBase&#32;&#40;which&#32;is&#32;the&#32;directory&#32;containing&#32;the&#32;unmanaged&#32;&#32;EXE&#41;.&#32;&#32;I&#32;would&#32;seriously&#32;consider&#32;VSTO&#32;as&#32;this&#32;is&#32;one&#32;of&#32;the&#32;key&#32;issues&#32;it&#32;solves&#32;as&#32;the&#32;AppBase&#32;for&#32;a&#32;VSTO&#32;customization&#32;is&#32;the&#32;document&#32;folder&#32;not&#32;the&#32;application&#32;folder&#32;&#40;of&#32;EXCEL.EXE&#41;.&#32;I&#32;realize&#32;that&#32;VSTO&#32;may&#32;not&#32;be&#32;an&#32;option&#32;for&#32;you&#32;but&#32;I&#39;d&#32;like&#32;to&#32;understand&#32;why.&#32;&#32;Putting&#32;stuff&#32;in&#32;the&#32;GAC&#32;would&#32;work&#32;but&#32;you&#32;will&#32;have&#32;to&#32;do&#32;this&#32;for&#32;each&#32;assembly&#32;your&#32;application&#32;loads,&#32;not&#32;just&#32;Unity&#32;but&#32;all&#32;the&#32;other&#32;assemblies&#32;of&#32;types&#32;your&#32;DI&#32;container&#32;refers&#32;to.&#32;There&#32;are&#32;some&#32;other&#32;options&#32;but&#32;I&#39;d&#32;like&#32;to&#32;explore&#32;the&#32;VSTO&#32;one&#32;first.&#32;">
        So I've thought about this some more and this behavior is actually by design and nothing to do with Excel, VBA or Unity for that matter.
<br>
This will occur in any case where you have an unmanaged application calling a .NET assembly. A&nbsp;<a href="http://msdn.microsoft.com/en-us/library/f07c8z1c.aspx" rel="nofollow">CCW</a> gets created and this
<br>
try and load assemblies from either the GAC or the domain's AppBase (which is the directory containing the unmanaged
<br>
EXE).<br>
<br>
I would seriously consider VSTO as this is one of the key issues it solves as the AppBase for a VSTO customization is the document<br>
folder not the application folder (of EXCEL.EXE). I realize that VSTO may not be an option for you but I'd like to understand why.<br>
<br>
Putting stuff in the GAC would work but you will have to do this for each assembly your application loads, not just Unity but all the<br>
other assemblies of types your DI container refers to. There are some other options but I'd like to explore the VSTO one first.

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_101043" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="101166">
    <td id="PostDetailsCell_101166" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post101166"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/sanchaykulkarni">sanchaykulkarni</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="6/27/2008 6:31:57 AM" LocalTimeTicks="1214573517">Jun 27, 2008 at 6:31 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_101166" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="VSTO&#32;vs&#32;VBA&#32;&#32;We&#32;started&#32;using&#32;VSTO&#32;&#40;2005&#41;&#32;for&#32;the&#32;same,&#32;it&#32;was&#32;the&#32;obvious&#32;choice.&#32;But&#32;we&#32;ran&#32;into&#32;problems,&#32;one&#32;of&#32;the&#32;major&#32;problem&#32;was,&#32;while&#32;deploying&#32;the&#32;&#32;custom&#32;menu&#32;was&#32;not&#32;consistently&#32;displayed&#32;in&#32;Excel.&#32;We&#32;can&#39;t&#32;move&#32;to&#32;VSTO-2008&#32;right&#32;now,&#32;I&#32;am&#32;not&#32;sure&#32;if&#32;this&#32;Menu&#32;display&#32;problem&#32;is&#32;fixed&#32;in&#32;VSTO-2008,&#32;&#32;but&#32;anyways&#32;thats&#32;a&#32;diff.&#32;topic.&#32;&#32;Summary&#32;for&#32;findings&#47;problems&#32;for&#32;the&#32;&#38;quot&#59;Could&#32;not&#32;load&#32;file&#32;or&#32;assembly&#38;quot&#59;&#32;error...&#32;1&#41;Using&#32;the&#32;&#38;quot&#59;OpenMappedExeConfiguration&#38;quot&#59;,&#32;opened&#32;the&#32;Configuration&#32;file,&#32;the&#32;System.Configuration.Configuration&#32;can&#32;locate&#32;and&#32;open&#32;the&#32;file,&#32;but&#32;when&#32;it&#32;starts&#32;reading&#32;the&#32;&#38;quot&#59;&#38;lt&#59;configSections&#38;gt&#59;&#38;quot&#59;&#32;,&#32;it&#32;can&#39;t&#32;load&#32;the&#32;DLL,&#32;Unity&#32;DLLs&#32;in&#32;this&#32;case.&#32;2&#41;Registered&#32;the&#32;DLLs&#32;in&#32;GAC,&#32;&#40;verifed&#32;that&#32;version&#32;is&#32;correct&#32;in&#32;GAC&#32;and&#32;in&#32;config&#32;file&#41;,&#32;still&#32;DLLs&#32;can&#39;t&#32;be&#32;loaded.&#32;3&#41;you&#32;are&#32;right,&#32;the&#32;problem&#32;is&#32;not&#32;related&#32;to&#32;Unity,&#32;it&#32;can&#39;t&#32;find&#32;any&#32;DLLs.&#32;&#32;I&#32;will&#32;try&#32;diff.&#32;the&#32;GAC&#32;options&#32;e.g&#32;tyr&#32;registering&#32;diff.&#32;DLL&#32;versions&#32;in&#32;GAC&#32;,&#32;and&#32;check&#32;whether&#32;this&#32;fixes&#32;the&#32;issue.&#32;&#32;By&#32;the&#32;way,&#32;what&#39;s&#32;the&#32;reason&#32;it&#32;for&#32;this&#32;CCW&#32;behavior&#63;&#32;&#40;NOTE&#58;&#32;This&#32;is&#32;working&#32;in&#32;CastleWindsor&#32;Framework&#41;&#32;&#32;&#32;&#32;">
        VSTO vs VBA<br>
<br>
We started using VSTO (2005) for the same, it was the obvious choice. But we ran into problems, one of the major problem was, while deploying the
<br>
custom menu was not consistently displayed in Excel. We can't move to VSTO-2008 right now, I am not sure if this Menu display problem is fixed in VSTO-2008,
<br>
but anyways thats a diff. topic.<br>
<br>
Summary for findings/problems for the &quot;<span>Could not load file or assembly</span>&quot; error...<br>
1)Using the &quot;OpenMappedExeConfiguration&quot;, opened the Configuration file, the System.Configuration.Configuration can locate and open the file, but<br>
when it starts reading the &quot;&lt;configSections&gt;&quot; , it can't load the DLL, Unity DLLs in this case.<br>
2)Registered the DLLs in GAC, (verifed that version is correct in GAC and in config file), still DLLs can't be loaded.<br>
3)you are right, the problem is not related to Unity, it can't find any DLLs.<br>
<br>
I will try diff. the GAC options e.g tyr registering diff. DLL versions in GAC , and check whether this fixes the issue.<br>
<br>
By the way, what's the reason it for this CCW behavior? (NOTE: This is working in CastleWindsor Framework)
<br>
<br>
<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_101166" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="101302">
    <td id="PostDetailsCell_101302" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post101302"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/AdeMiller">AdeMiller</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="6/27/2008 5:47:10 PM" LocalTimeTicks="1214614030">Jun 27, 2008 at 5:47 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_101302" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="I&#39;m&#32;not&#32;fully&#32;upto&#32;speed&#32;on&#32;VSTO&#32;any&#32;more&#32;although&#32;you&#32;might&#32;want&#32;to&#32;follow&#32;up&#32;on&#32;the&#32;VSTO&#32;forum&#32;on&#32;MSDN.&#32;&#32;&#35;1&#32;is&#32;the&#32;behavior&#32;I&#39;d&#32;expect.&#32;Did&#32;you&#32;look&#32;in&#32;the&#32;fusion&#32;log&#32;to&#32;see&#32;where&#32;it&#32;was&#32;trying&#32;to&#32;load&#32;the&#32;assemblies&#32;from&#63;&#32;I&#39;m&#32;very&#32;&#32;surprised&#32;that&#32;registering&#32;in&#32;the&#32;GAC&#32;did&#32;not&#32;fix&#32;the&#32;issue&#32;-&#32;although&#32;I&#39;m&#32;not&#32;recommending&#32;this&#32;approach&#32;as&#32;you&#32;will&#32;have&#32;to&#32;place&#32;all&#32;your&#32;DLLs&#32;in&#32;the&#32;GAC&#32;to&#32;get&#32;this&#32;to&#32;work.&#32;Again&#32;the&#32;fusion&#32;log&#32;will&#32;show&#32;you&#32;exactly&#32;why&#32;it&#39;s&#32;not&#32;loading&#32;the&#32;DLLs.&#32;I&#32;tried&#32;this&#32;on&#32;my&#32;machine&#32;and&#32;adding&#32;Microsoft.Practices.Unity.Configuration.DLL&#32;to&#32;the&#32;GAC&#32;causes&#32;the&#32;call&#40;s&#41;&#32;to&#32;OpenMappedExeConfiguration&#32;to&#32;succeed.&#32;Note&#58;&#32;Their&#32;is&#32;an&#32;issue&#32;with&#32;running&#32;GACUTIL&#32;as&#32;a&#32;non-Admin&#32;on&#32;Vista&#32;with&#32;&#32;VS&#32;2005&#32;see&#32;here&#32;for&#32;details.&#32;&#32;I&#39;m&#32;very&#32;surprised&#32;you&#32;see&#32;a&#32;different&#32;behavior&#32;with&#32;Castle&#32;Windsor.&#32;Where&#32;are&#32;these&#32;DLLs&#32;installed&#63;&#32;What&#32;does&#32;the&#32;fusion&#32;log&#32;viewer&#32;tell&#32;you&#32;about&#32;how&#32;these&#32;DLLs&#32;got&#32;loaded&#63;&#32;&#32;The&#32;CCW&#32;behavior&#32;is&#32;really&#32;no&#32;different&#32;from&#32;the&#32;default&#32;.NET&#32;behavior&#32;when&#32;you&#32;create&#32;and&#32;.NET&#32;AppDomain.&#32;Unless&#32;you&#32;&#32;explicitly&#32;set&#32;the&#32;AppBase&#32;on&#32;the&#32;domain&#32;it&#32;will&#32;be&#32;the&#32;folder&#32;that&#32;the&#32;EXE&#32;is&#32;in.&#32;So&#32;assemblies&#32;can&#32;be&#32;loaded&#32;from&#32;the&#32;AppBase&#32;folder&#32;or&#32;sub&#32;folders&#32;or&#32;&#40;if&#32;they&#32;are&#32;fully&#32;trusted&#41;&#32;from&#32;the&#32;GAC.&#32;This&#32;is&#32;part&#32;of&#32;the&#32;.NET&#32;security&#32;model.&#32;&#32;Your&#32;other&#32;option&#32;here&#32;would&#32;be&#32;to&#32;modify&#32;the&#32;AppDomain&#32;load&#32;behavior&#32;from&#32;within&#32;your&#32;application&#32;by&#32;implementing&#38;nbsp&#59;&#32;AppDomain.AssemblyResolve&#32;event.&#32;This&#32;fires&#32;when&#38;nbsp&#59;the&#32;AppDomain&#32;cannot&#32;load&#32;an&#32;assembly&#32;and&#32;gives&#32;the&#32;event&#32;handler&#32;an&#32;opportunity&#32;to&#32;provide&#32;the&#32;assembly.&#32;You&#32;can&#38;nbsp&#59;effectively&#32;extend&#32;the&#32;assembly&#32;probing&#32;path&#32;this.&#32;You&#32;can&#32;find&#32;an&#32;example&#32;in&#32;the&#32;WSSF&#58;ME&#32;source&#32;code.&#32;This&#32;is&#32;a&#32;lot&#32;of&#32;code&#32;but&#32;you&#32;actually&#32;only&#32;need&#32;three&#32;self&#32;contained&#32;classes&#32;from&#32;the&#32;source.&#32;&#32;&#32;&#32;AssemblyLoader&#32;&#32;&#32;&#32;AssemblyResolver&#32;&#32;ReflectionHelper&#32;Your&#32;code&#32;then&#32;just&#32;calls&#38;nbsp&#59;before&#32;trying&#32;to&#32;load&#32;the&#32;configuration&#32;&#32;&#38;nbsp&#59;&#32;&#32;&#32;AssemblyLoader.LoadAll&#40;&#64;&#38;quot&#59;c&#58;&#92;Projects&#92;...&#38;quot&#59;&#41;&#59;&#32;&#38;nbsp&#59;&#32;&#32;You&#39;ll&#32;have&#32;to&#32;make&#32;a&#32;minor&#32;alteration&#32;to&#32;the&#32;code&#32;as&#32;the&#32;version&#32;that&#39;s&#32;shipped&#32;adds&#32;&#38;quot&#59;&#92;lib&#38;quot&#59;&#32;to&#32;the&#32;passed&#32;in&#32;path&#32;and&#32;remove&#32;&#32;the&#32;calls&#32;to&#32;to&#32;the&#32;methods&#32;on&#32;the&#32;Guard&#32;class&#32;&#40;or&#32;copy&#32;this&#32;also&#41;.&#38;nbsp&#59;I&#39;ve&#32;already&#32;tried&#32;this&#32;and&#32;it&#32;works.&#32;&#32;&#32;">
        I'm not fully upto speed on VSTO any more although you might want to follow up on the
<a href="http://forums.microsoft.com/msdn/showforum.aspx?siteid=1&forumid=16" rel="nofollow">VSTO forum on MSDN</a>.<br>
<br>
#1 is the behavior I'd expect. Did you look in the fusion log to see where it was trying to load the assemblies from? I'm very
<br>
surprised that registering in the GAC did not fix the issue - although I'm not recommending this approach as you will have to<br>
place <em>all</em> your DLLs in the GAC to get this to work. Again the fusion log will show you exactly why it's not loading the DLLs.<br>
I tried this on my machine and adding Microsoft.Practices.Unity.Configuration.DLL to the GAC causes the call(s) to<br>
OpenMappedExeConfiguration to succeed. <strong>Note:</strong> Their is an issue with running GACUTIL as a non-Admin on Vista with
<br>
VS 2005 <a href="http://www.ademiller.com/blogs/tech/2007/09/gotchas-using-snexe-on-vista/" rel="nofollow">
see here for details</a>.<br>
<br>
I'm very surprised you see a different behavior with Castle Windsor. Where are these DLLs installed? What does the fusion<br>
log viewer tell you about how these DLLs got loaded?<br>
<br>
The CCW behavior is really no different from the default .NET behavior when you create and .NET AppDomain. Unless you
<br>
explicitly set the AppBase on the domain it will be the folder that the EXE is in. So assemblies can be loaded from the AppBase<br>
folder or sub folders or (if they are fully trusted) from the GAC. This is part of the .NET security model.<br>
<br>
Your other option here would be to modify the AppDomain load behavior from within your application by implementing&nbsp;<br>
<a href="http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx" rel="nofollow">AppDomain.AssemblyResolve</a> event. This fires when&nbsp;the AppDomain cannot load an assembly and gives the event handler an<br>
opportunity to provide the assembly. You can&nbsp;effectively extend the assembly probing path this. You can find an example in<br>
the <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=6C200BAC-9F33-46E3-A5A2-839FD7DC022F&displaylang=en" rel="nofollow">
WSSF:ME source code</a>. This is a <em>lot</em> of code but you actually only need three self contained classes from the source.<br>
<br>
<span style="font-size:13px; color:#2b91af"><span style="font-size:13px; color:#2b91af">
<blockquote dir="ltr" style="margin-right:0px">
<p>AssemblyLoader</p>
</blockquote>
</span>
<blockquote dir="ltr" style="margin-right:0px"></blockquote>
</span>
<blockquote dir="ltr" style="margin-right:0px"><span style="font-size:13px; color:#2b91af"><span style="font-size:13px; color:#2b91af">
<p>AssemblyResolver</p>
</span></span><span style="font-size:13px; color:#2b91af"><span style="font-size:13px; color:#2b91af">
<p>ReflectionHelper</p>
<blockquote></blockquote>
</span></span></blockquote>
Your code then just calls&nbsp;before trying to load the configuration<span style="font-size:13px">
<blockquote dir="ltr" style="margin-right:0px">
<p>&nbsp;</p>
</blockquote>
</span>
<blockquote dir="ltr" style="margin-right:0px">
<p><span style="font-size:13px; color:#2b91af"><span style="font-size:13px; color:#2b91af">AssemblyLoader</span></span><span style="font-size:13px">.LoadAll(</span><span style="font-size:13px; color:#a31515"><span style="font-size:13px; color:#a31515">@&quot;c:\Projects\...&quot;</span></span><span style="font-size:13px">);
</p>
<p>&nbsp;</p>
<blockquote></blockquote>
</span>
<p></p>
</blockquote>
You'll have to make a minor alteration to the code as the version that's shipped adds &quot;\lib&quot; to the passed in path and remove
<br>
the calls to to the methods on the Guard class (or copy this also).&nbsp;I've already tried this and it works.<br>
<br>
<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_101302" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="103780">
    <td id="PostDetailsCell_103780" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post103780"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/sanchaykulkarni">sanchaykulkarni</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="7/10/2008 6:15:43 AM" LocalTimeTicks="1215695743">Jul 10, 2008 at 6:15 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_103780" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Thanks&#32;AdeMiller&#32;Sorry&#32;for&#32;posting&#32;the&#32;replay&#32;so&#32;late,&#32;was&#32;busy&#32;in&#32;some&#32;other&#32;stuff.&#32;&#32;The&#32;only&#32;option&#32;that&#39;s&#32;working&#32;is&#32;putting&#32;everything&#32;in&#32;GAC&#32;or&#32;in&#32;the&#32;EXCEL.exe&#32;directory.&#32;Thought&#32;I&#32;haven&#39;t&#32;tried&#32;changing&#32;the&#32;AppDomain&#32;load&#32;behavior.&#32;">
        Thanks AdeMiller<br>
Sorry for posting the replay so late, was busy in some other stuff.<br>
<br>
The only option that's working is putting everything in GAC or in the EXCEL.exe directory. Thought I haven't tried changing the AppDomain load behavior.<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_103780" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="103878">
    <td id="PostDetailsCell_103878" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post103878"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/AdeMiller">AdeMiller</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="7/10/2008 2:28:16 PM" LocalTimeTicks="1215725296">Jul 10, 2008 at 2:28 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_103878" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="This&#32;is&#32;the&#32;behavior&#32;I&#32;would&#32;expect.&#32;The&#32;assembly&#32;loaded&#32;will&#32;attempt&#32;to&#32;load&#32;DLLs&#32;from&#32;the&#32;GAC&#32;and&#32;then&#32;the&#32;app&#32;&#32;base&#32;folder.&#32;Placing&#32;your&#32;assemblies&#32;here&#32;has&#32;some&#32;undersirable&#32;side&#32;effects&#32;we&#32;discussed&#32;earlier.&#32;&#32;I&#39;d&#32;encourage&#32;you&#32;to&#32;try&#32;the&#32;third&#32;solution&#32;I&#32;outlined&#32;above.&#32;I&#32;got&#32;this&#32;working&#32;in&#32;under&#32;an&#32;hour&#32;as&#32;it&#32;involves&#32;one&#32;minor&#32;&#32;change&#32;to&#32;the&#38;nbsp&#59;classes&#32;in&#32;the&#32;WSSF&#58;ME&#32;source&#32;and&#32;it&#32;should&#32;just&#32;work.&#32;&#32;Thanks,&#32;&#32;Ade&#32;">
        This is the behavior I would expect. The assembly loaded will attempt to load DLLs from the GAC and then the app
<br>
base folder. Placing your assemblies here has some undersirable side effects we discussed earlier.<br>
<br>
I'd encourage you to try the third solution I outlined above. I got this working in under an hour as it involves one minor
<br>
change to the&nbsp;classes in the WSSF:ME source and it should just work.<br>
<br>
Thanks,<br>
<br>
Ade 
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_103878" class="Options" >
            
        </div>
        
    </td>
</tr>

</table>
    </div>

    
        <div class="StandardMarginTop">
            <a id="SignInToAddCommentLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2funity.codeplex.com%2fdiscussions%2f27276">
                Sign in to post message or set email notifications
            </a>
        </div>
    


    <div id="PostEditorContainer">
        <a name="editor"></a>
        <div id="Editor" style="display: none;">
            

<div class="MarkdownEditor" data-options-id="ea1fe108-c541-446a-b804-317ca397740c">
    <script class="options" defer="defer" id="ea1fe108-c541-446a-b804-317ca397740c" type="application/json">{"maxLength":10000,"styleSheetLocation":""}</script>

    <div class="MarkdownEditorControls">
        <a href="#" tabindex="-1" class="control md_help" title="Markdown Syntax Guide"></a>
        <div class="control md_divider"></div>
        <a href="#" tabindex="-1" class="control md_header" title="Insert Header (CTRL + H)"></a>
        <a href="#" tabindex="-1" class="control md_code" title="Insert Code (CTRL + K)"></a>
        <a href="#" tabindex="-1" class="control md_quote" title="Insert Quote (CTRL + Q)"></a>
        <a href="#" tabindex="-1" class="control md_img" title="Insert Img (CTRL + G)"></a>
        <a href="#" tabindex="-1" class="control md_link" title="Insert Link (CTRL + L)"></a>
        <a href="#" tabindex="-1" class="control md_ulist" title="Unordered List (CTRL + U)"></a>
        <a href="#" tabindex="-1" class="control md_olist" title="Ordered List (CTRL + O)"></a>
        <a href="#" tabindex="-1" class="control md_italics" title="Italic Text (CTRL + I)"></a>
        <a href="#" tabindex="-1" class="control md_bold" title="Bold Text (CTRL + B)"></a>
    </div>

    

<div class="tab_control">
    <!-- Generate the basic HTML for the tabs. -->
    
        <div id="Compose"
              class="tab selected"
              data-custom-header-id=""
              data-tab-contents-id="compose_contents_e196be4c-2a1d-42e4-8d6c-60dcd6ec36a7">
            Compose
        </div>
    
        <div id="Preview"
              class="tab "
              data-custom-header-id=""
              data-tab-contents-id="preview_contents_cadf7e5d-ed7e-4211-89fd-d7f76d6f9d92">
            Preview
        </div>
    
    <div class="clear"></div>
</div>


    <div id="compose_contents_e196be4c-2a1d-42e4-8d6c-60dcd6ec36a7" class="compose_tab_content">
        <textarea class=" MarkdownEditorDimensions" cols="20" id="MarkdownEditor" name="content" rows="2">
</textarea>
        <div class="ClearBoth"></div>

        <div class="markdownGuide" style="display: none">
            <table>
                <tr>
                    <td class="markdownGuideColumn">
                        <h1>Text Formatting</h1>
                        <div># Header 1</div>
                        <div>## Header 2</div>
                        <br />
                        <div>*italics* (or _italics_)</div>
                        <div>**bold** (or __bold__)</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Lists</h1>
                        <div>* Unordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp * SubItem</div>
                        <br />
                        <div>1. Ordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 1. SubItem</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Quotes</h1>
                        <div>> Lorem ipsum</div>
                        <div>dolor sitamet </div>
                        <div>non. Lectus at</div>
                        <div>nam nunc...</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Code</h1>
                        <div>`Inline Code`</div>
                        <br />
                        <div>``` C#</div>
                        <div>if (foo==bar)</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbspbar++</div>
                        <div>```</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>References</h1>
                        <div>[Link Text](URL)</div>
                        <br />
                        <div>![Image](URL)</div>
                        <br />
                        <a class="Reference" target="_blank" href="http://codeplex.codeplex.com/wikipage?title=Markdown&referringTitle=Documentation">Markdown Reference</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div id="preview_contents_cadf7e5d-ed7e-4211-89fd-d7f76d6f9d92" class="preview_tab_content markDownOutput">
        
            <div></div>
        
    </div>
    <div class="clear"></div>
</div>

            
            <div class="row" id="recaptcha_row">
                
<script type="text/javascript">
    $(document).ready(function () {
        $('#recaptcha_reload').attr('src', '../assets/recaptcha_refresh.png');
        $('#recaptcha_switch_audio').attr('src', '../assets/recaptcha_audio.png');
        $('#recaptcha_switch_img').attr('src', '../assets/recaptcha_text.png');
        $('#recaptcha_whatsthis').attr('src', '../assets/recaptcha_help.png');
        $('#recaptcha_area tr:first').attr('height', '35');
    });
</script>

                <div class="clear"></div>
                <span id="ReCaptchaError"></span>
            </div>
            <div style="padding-top: 6px;">
                <input type="button" id="SaveButton" value="Save" class="ok" />
                <input type="button" id="CancelButton" value="Cancel" class="cancel" />
                <div class="clear"></div>
            </div>
        </div>
    </div>
</div>

<div id="DeletePostPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Post <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this post? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="ClosePostCancel" value="Cancel" class="cancel" />
            <input type="button" id="ClosePostOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>
        
            <!-- Email notification / Subscription details -->
            
    </div>
</div>
    
<div id="DeleteThreadPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Thread <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this thread? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="CloseThreadCancel" value="Cancel" class="cancel" />
            <input type="button" id="CloseThreadOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>

<script type="text/javascript" language="javascript">
    $(function () {

        $('#recaptcha_response_field')
            .bind('keypress', function (event) { return $submitKeyPressElement(this, event); });


        if ($('#DeleteThreadLink')) {
            $('#DeleteThreadLink').click(function () {
                OpenDialog('#DeleteThreadPanel', true, '41em');
            });
        }
        
        $('#DeleteThreadPanel #CloseThreadOk').click(function () {
            var url = 'http://unity.codeplex.com/discussions/27276';
            $.ajax({
                url: url,
                type: 'DELETE',
                success: function (x) {
                    location.href = x.RedirectUrl;
                }
            });
        });
    });

    workItemMention = new codeplex.ui.WorkItemMention();
    workItemMention.addLinks(".discussionPost");
</script>


        
        
                
                <div class="clear"></div>
                
                <div id="footer">
                    <div class="row">
                        <hr />
                        <ul>
                            <li>Â© 2006-2017 Microsoft</li>
                            <li><a href="http://www.codeplex.com/site/help">Get Help</a></li>
                            <li><a href="/site/legal/privacy">Privacy Statement</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/terms">Terms of Use</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/conduct">Code of Conduct</a></li>
                            <li><a href="http://developermedia.com/" target="_blank">Advertise With Us</a></li>
                            <li>Version 2017.10.3.21062</li>
                        </ul>
                    </div>
                </div>
            </div>
        </form>
    </body>

</html>