

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="" prefix="og: http://ogp.me/ns# profile: http://ogp.me/ns/profile#">
    
    
    
    

    
    <head>
        <meta id="CompatabilityMode" http-equiv="X-UA-Compatible" content="IE=edge" />
	    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../assets/StyleSheet.css" id="MasterCss" rel="stylesheet" type="text/css" />
        <link rel="SHORTCUT ICON" href="../assets/favicon.ico" />
        <title>patterns &#38; practices - Unity - LifetimeStyle limits the usefulness of Unity for custom lifetime management</title>
        
       
                    <script src="../assets/mscc-0.3.6.min.js"></script>
        
                    <link rel="stylesheet" type="text/css" href="../assets/mscc-0.3.6.min.css" />
        
            <script type="text/javascript">
                var msccHadCookieBannerAtPageStart = true;
            </script>
        

        <!--
        Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code,
        not by Microsoft.  See ASP.NET Ajax CDN Terms of Use â€“ http://www.asp.net/ajaxlibrary/CDN.ashx.
        -->
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.4.4.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery === 'undefined') {
                document.write(unescape("%3Cscript src='https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        <script src="https://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.6/jquery-ui.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery.ui === 'undefined') {
                document.write(unescape("%3Cscript src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        
    <style type="text/css">.SideBar, .SideBarPadding{display:none;}.MainContent{width:auto;}.SiteContentTable{width:100%;}</style>
    <style id="ProjectStyles" type="text/css">
        .SiteHeader, .SiteHeaderLeft {
            height:45px !important;
            overflow:hidden;
        }
        .SiteContent 
        {
            padding: 0 0 1em 0;
            margin-top:0;
            min-height:225px;
            border-right: 1px solid lightgrey;
            border-left: 1px solid lightgrey;
            border-bottom: 1px solid lightgrey;
        }
        .IE table.MinWidthContent
        {
	        table-layout: auto !important;	
        }
    </style>
    
    
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">

    
    
    <meta id="WTProjectName" name="WT.pi" content="unity"/>
    

    <link rel="EditURI" type="application/rsd+xml" title="RSD" href='http://unity.codeplex.com/rsd' />
    <link rel="wlwmanifest" type="application/wlwmanifest+xml" title="WLWManifest" href='/wlwmanifest.xml' />
    
    
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity" url="http://unity.codeplex.com/project/feeds/rss"/>
    
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Discussions" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2funity"/>
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Issues" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2funity"/>
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Downloads" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2funity"/>
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Reviews" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2funity"/>
        
    
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Source&#32;code" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2funity"/>
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Wiki" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2funity"/>
    
        
    
        <meta content="summary" name="twitter:card" /><meta content="@CodePlex" name="twitter:site" /><meta content="http://unity.codeplex.com/discussions/22282?ProjectName=unity" name="twitter:url" /><meta content="patterns &amp;#38; practices - Unity" name="twitter:title" /><meta content="The Unity Application Block &amp;#40;Unity&amp;#41; is officially under new ownership.&amp;#13;&amp;#10;https&amp;#58;&amp;#47;&amp;#47;github.com&amp;#47;unitycontainer&amp;#47;unity" name="twitter:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" name="twitter:image" /><meta content="CodePlex" property="og:site_name" /><meta content="http://unity.codeplex.com/discussions/22282?ProjectName=unity" property="og:url" /><meta content="object" property="og:type" /><meta content="patterns &amp;#38; practices - Unity" property="og:title" /><meta content="The Unity Application Block &amp;#40;Unity&amp;#41; is officially under new ownership.&amp;#13;&amp;#10;https&amp;#58;&amp;#47;&amp;#47;github.com&amp;#47;unitycontainer&amp;#47;unity" property="og:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" property="og:image" />
        

    </head>
    
    <body>
         
            
        <script src="../assets/ScriptLoader.js" type="text/javascript"></script>
        <form id="aspnetForm" autocomplete="off" method="POST" enctype="multipart/form-data">
            <input name="__RequestVerificationToken" type="hidden" value="VbR11reZoMdeNruq8Fi4xcw7XnZXDCPcxfT5AQj6dCDZgNnRf19_dIKJdPgioHta6GdTT9jGllvAjX071R-G5SyssKJgvl8as1n7vXH3wbCkjupyfZnAHJCmWh15j0At2g0r8g2" /><input name="__RequestVerificationToken2" type="hidden" value="__RequestVerificationToken29f54a7b9-11c4-4984-88a0-9edd25341044" />
            
            <div id="UpdateProgressPanel" class="loading_animation" style="display:none;">
                <div class="row">
                    <h2 class="anim_h2">
                        <span id="UpdateProgressText">Updating...</span>
                        <span id="animatedLoadingIconContainer">
                            <img id="animatedLoadingIcon" src="../assets/loading_animation.gif" class="anim_img"/>
                        </span>
                    </h2>
                </div>
            </div>
            
            <div style="display:none;">
                
                <img id="BlankImage" style="width:0;height:0;" src="../assets/blank.png" onload="self.logoImageLoaded=true;"/>

                <script language="javascript" type="text/javascript">
                    var date = new Date();
                    var timezoneOffset = date.getTimezoneOffset() / 60 * -1;
                    var timezoneOffsetCookie = getCookie("TimezoneOffset");
                    var firstTimeSetTimezoneCookie = false;

                    if (timezoneOffsetCookie == null || timezoneOffsetCookie != timezoneOffset) {
                        firstTimeSetTimezoneCookie = true;
                        document.cookie = "TimezoneOffset=" + timezoneOffset + '; domain=.codeplex.com;expires=Wed, 10 Oct 2018 05:29:26 UTC';
                    }
                </script>
            </div>
            
            
            <div id="banner">
                <div id="message"><strong>This is an archived copy of the original CodePlex Unity Discussion Forum</strong><br />Unity is now on <a href="https://github.com/unitycontainer/">GitHub</a>
                    
                </div>
            </div>
            

            <div id="header">
                <div id="header_wrap" class="row">
                    <p id="logo"><a href="http://www.codeplex.com">Code<span class="semi">Plex</span></a><span id="tagline">Project Hosting for Open Source Software</span></p>
                    

<ul id="nav">

    <li><a href="/site/register/new" id="registerLink" class="ZoomFix">Register</a></li>
    <li ><a class="SignInLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2funity.codeplex.com%2fdiscussions%2f22282" id="signInLink">Sign In</a></li>
  
    <li class="last"><a class="rss_site_icon" href="http://www.codeplex.com/site/feeds/rss" type="application/rss+xml" rel="Alternate" title="CodePlex Site Activity"></a></li>
</ul>
                    <input id="searchsite" name="searchsite" maxlength="500" type="text" value="" /><span id="search_mag"><a id="submitSearch" name="submitSearch" class="magnify" title="Search" href="#"></a></span>
                    <script>
	$(document).ready(function() {
    var searchButton = $('#submitSearch'),
        searchBar = $('#searchsite');

    // Register our own handler for the search event while we wait for the SearchBox script to load.
    searchButton.bind('click.backupSearchBox', doProjectSearch);
    searchBar.bind('keypress.backupSearchBox', function(e) { if ($keyCode(e) === 13) { doProjectSearch(); return false; } });

    function cleanupSearchEvents() {
        // If the SearchBox was loaded, unregister our handlers.
        if (epx_loaded) {
            searchButton.unbind('.backupSearchBox');
            searchBar.unbind('.backupSearchBox');
        }
    }

    $loadScript('https://i4.services.social.microsoft.com/search/Widgets/SearchBox.jss?appid=1000&scopeid=1&boxId=searchsite&btnId=submitSearch&watermark=Search%20all%20projects&overrideWatermark=true&searchLocation=%2fsite%2fsearch&allowEmptySearch=true&focusOnInit=False&minimumTermLength=3', cleanupSearchEvents);
})
function doProjectSearch() {
    
    var url = '/site/search';

    //If search term is not same as watermark
    if($('#searchsite').val() != 'Search all projects')    
    {        
        url = url + '?query=' + encodeURIComponent($('#searchsite').val());
    }

    
    var callback = '';
    if (callback.length > 0 && eval('typeof ' + callback) != 'undefined')
        url += eval(callback + '()');

    window.location.href = url;
    return false;
}
</script>
                </div>
            </div>
            
            <div id="wrap">
                
    <div id="sub_heading" class="row">
        
        <div id="ProjectHeader">
            <div id="project_title_row" class="row">
                <div id="project_logo">
                    
<a id="AffiliateLink" href="http://msdn.microsoft.com/practices">
    <img id="AffiliateImage" src="../assets/pnp_logo.png" title="patterns&#32;&#38;&#32;practices" />
</a>

    
    <h1 class="text_only"><a href="http://unity.codeplex.com/" id="ProjectTitle1"><div>patterns &#38; practices - Unity</div></a></h1>

                </div>
            </div>
        </div>
        
        <div id="ProjectDetailsDiv">
            
        </div>
		<div class="clear"></div>
        

<ul id="page_box_links">
	<li id="homeTabCell" style="width: 63px;"><a id="homeTab" href="http://unity.codeplex.com/" class="box_home">home</a><div></div></li>
    
	<li id="sourceTabCell" style="width:113px;"><a id="sourceTab" href="http://unity.codeplex.com/SourceControl/latest" class="box_source">source code</a><div></div></li>
    
	<li id="releasesTabCell" style="width:105px;"><a id="releasesTab" href="http://unity.codeplex.com/releases" class="box_downloads">downloads</a><div></div></li>
    
    <li id="documentationTabCell" style="width:143px;"><a id="documentationTab" href="http://unity.codeplex.com/documentation" class="box_documentation">documentation</a><div></div></li>
    
	<li id="discussionTabCell" style="width:112px;"><a id="discussionTab" href="../index.html" class="discussions_active">discussions</a><div></div></li>
    
	<li id="workItemsTabCell" style="width:70px;"><a id="workItemsTab" href="http://unity.codeplex.com/workitem/list/basic" class="box_issue">issues</a><div></div></li>
    
	<li id="peopleTabCell" style="width:70px;"><a id="peopleTab" href="http://unity.codeplex.com/team/view" class="box_people">people</a><div></div></li>
	<li id="licenseTabCell" style="width:70px;"><a id="licenseTab" href="http://unity.codeplex.com/license" class="box_license">license</a><div></div></li>
    
    <span class="stretch"></span>
</ul>

<script type="text/javascript">
    $(document).ready(function () {
        $('#page_box_links').applyLastClassToList();
    });
</script>
		    <div class="clear"></div>
            
     <td>
       

<div>
    
    <div id="actionBar" class="action_bar">
        <ul id="actionBar_ul" class="actionBar_sublinks subtab_right" style="vertical-align: middle;">

            

                <li id="li_actionbar_creatediscussion" data-action-id="actionbar_creatediscussion" data-action-type="Navigate" class="actionBar_sublinks" data-options-id="77babc66-9792-45dd-b9e4-a5655a1bdd3e">
                
                    <script class="options" defer="defer" id="77babc66-9792-45dd-b9e4-a5655a1bdd3e" type="application/json">{"navigate-url":"http://unity.codeplex.com/discussions/create"}</script> 
                    
                    <div class="actionBar_custom_content"></div>

                    <a href="#" id="actionbar_creatediscussion" title="Start a New Thread" class="action_bar_item_link">
                        <img id="img_actionbar_creatediscussion" class="action_bar_item_image" src="../assets/actionbar_newitem.png" style="vertical-align: middle" />
                        New Thread
                    </a>

                </li>

            

                <li id="li_actionbar_subscribe" data-action-id="actionbar_subscribe" data-action-type="PopUp" class="actionBar_sublinks" data-options-id="57f782e8-a3b2-4329-a214-fd7567f6f749">
                
                    <script class="options" defer="defer" id="57f782e8-a3b2-4329-a214-fd7567f6f749" type="application/json">{}</script> 
                    
                    <div class="actionBar_custom_content">

<div id="rssHoverDiv" class="HoverPanel LeftHoverWidth" style="display: none">
        <ul id="3_FeedsPanel" class="RssFeedsPanel">
            <li>
                <a id="ProjectRssLink" href="http://unity.codeplex.com/project/feeds/rss" class="ArrowSmall NoUnderline">All Project Updates</a>
            </li>
            
            <li>
                <a id="DiscussionRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2funity" class="ArrowSmall NoUnderline">Discussions</a>
            </li>
            
            <li>
                <a id="IssueTrackerRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2funity" class="ArrowSmall NoUnderline">Issue Tracker</a>
            </li>
            
            <li>
                <a id="ReleasesRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2funity" class="ArrowSmall NoUnderline">Downloads</a>
            </li>
            <li>
                <a id="ReviewsRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2funity" class="ArrowSmall NoUnderline">Reviews</a>
            </li>
            
            <li>
                <a id="SourceControlRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2funity" class="ArrowSmall NoUnderline">Source Code</a>
            </li>
            <li>
                <a id="WikiRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2funity" class="ArrowSmall NoUnderline">Wiki &amp; Documentation</a>
            </li>
        </ul>
</div></div>

                    <a href="#" id="actionbar_subscribe" title="Subscribe to project updates in RSS feeds." class="action_bar_item_link">
                        <img id="img_actionbar_subscribe" class="action_bar_item_image" src="../assets/actionbar_subscribe.png" style="vertical-align: middle" />
                        Subscribe
                    </a>

                </li>

            
        </ul>
    </div>
</div>
     </td>

        

    </div>
    
    
<div class="Threads">
    <div class="ViewThread">
        
        
        
            <h1 class="page_title WordWrapBreakWord">
                LifetimeStyle limits the usefulness of Unity for custom lifetime management
            </h1>

            <!-- Private Discussion header -->
            

            <!-- Posts List Header: Topics and Wiki Link -->
            <table class="PostsListHeader">
                <tr>
                    <td>
                     
                    </td>
                    <td>
                        <div class="WikiLink">
                            <span title="Paste this into a wiki page to link to this discussion">
                                Wiki Link: [discussion:22282]
                            </span>
                        </div>
                    </td>
                </tr>
            </table>

            <!-- The list of posts -->
            

<div id="discussionsPostList" data-options-id="041ab926-34c7-4e11-85fe-e73f69517677">
    <script class="options" defer="defer" id="041ab926-34c7-4e11-85fe-e73f69517677" type="application/json">{"threadUrl":"http://unity.codeplex.com/discussions/22282","showEditor":false,"checkImageUrl":"../assets/check_answer.png"}</script>

    <div class="Posts" style="margin-top: 10px;">
    

<table cellpadding="0" cellspacing="0" style="width: 100%; margin-bottom: 0px; table-layout:fixed">
    

<tr id="PostPanel" class="Post" d:forid="74256">
    <td id="PostDetailsCell_74256" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post74256"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/jimmyzimms">jimmyzimms</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="2/15/2008 11:58:04 PM" LocalTimeTicks="1203148684">Feb 15, 2008 at 11:58 PM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="2/16/2008 4:24:50 PM" LocalTimeTicks="1203207890">Feb 16, 2008 at 4:24 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_74256" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;I&#32;will&#32;be&#32;the&#32;first&#32;to&#32;admit&#32;I&#32;have&#39;t&#32;fully&#32;walked&#32;through&#32;the&#32;code&#32;yet&#32;so&#32;if&#32;I&#32;am&#32;mistaken&#32;then&#32;please&#32;feel&#32;free&#32;to&#32;correct,&#32;flame,&#32;nuke,&#32;launch&#32;me&#32;into&#32;space,&#32;etc&#32;&#58;&#41;I&#32;agree&#32;that&#32;the&#32;LifetimeStyle&#32;enum&#32;has&#32;the&#32;two&#32;most&#32;common&#32;lifetime&#32;styles&#32;that&#32;are&#32;used,&#32;the&#32;proverbial&#32;bread&#32;and&#32;butter&#32;of&#32;container&#32;lifetimes,&#32;per&#32;request&#32;&#40;transient&#41;&#32;and&#32;singelton.However&#32;the&#32;limitation&#32;of&#32;using&#32;an&#32;enum&#32;as&#32;well&#32;as&#32;a&#32;use&#32;case&#32;specific&#32;method&#32;for&#32;lifetime&#32;management&#32;is&#32;limiting&#32;for&#32;many&#32;advanced&#32;use&#32;cases&#58;i.e.&#32;&#35;1&#32;Objects&#32;that&#32;should&#32;be&#32;shared&#32;across&#32;requests&#32;just&#32;like&#32;a&#32;singleton&#32;but&#32;available&#32;for&#32;garbage&#32;collection&#32;&#40;e.g.&#32;weakreferenced&#41;.&#32;This&#32;is&#32;completely&#32;a&#32;requirement&#32;for&#32;many&#32;messaging&#32;systems&#32;wherein&#32;objects&#32;might&#32;need&#32;to&#32;be&#32;initialized&#32;as&#32;needed,&#32;are&#32;thread&#32;safe,&#32;but&#32;don&#39;t&#32;need&#32;to&#32;stick&#32;around&#32;in&#32;memory&#32;unless&#32;being&#32;actively&#32;used.&#32;&#40;specification&#32;objects&#32;often&#32;fall&#32;into&#32;this&#32;category&#41;.&#32;I&#32;completely&#32;understand&#32;I&#32;can&#32;implement&#32;this&#32;functionality&#32;by&#32;writing&#32;a&#32;class&#32;that&#32;caches&#32;the&#32;inner&#32;type&#32;but&#32;isn&#39;t&#32;that&#32;really&#32;forcing&#32;me&#32;to&#32;muddle&#32;my&#32;model&#32;with&#32;extrinsic&#32;concerns&#63;i.e.&#32;&#35;2&#32;Objects&#32;that&#32;need&#32;to&#32;be&#32;throttled&#32;by&#32;the&#32;container.&#32;This&#32;is&#32;usually&#32;called&#32;pooling&#32;and&#32;something&#32;we&#39;ve&#32;had&#32;in&#32;one&#32;of&#32;the&#32;first&#32;container&#32;systems,&#32;COM&#43;.&#32;Again&#32;I&#32;can&#32;get&#32;the&#32;same&#32;result&#32;without&#32;much&#32;effort&#32;but&#32;I&#32;have&#32;to&#32;remind&#32;everyone&#32;Unity&#32;should&#32;be&#32;as&#32;transparent&#32;to&#32;my&#32;system&#32;as&#32;is&#32;possible.Both&#32;of&#32;these&#32;are&#32;able&#32;to&#32;be&#32;done&#32;with&#32;ObjectBuilder&#32;&#40;and&#32;I&#32;have&#41;&#32;with&#32;policies&#32;and&#32;locators.&#32;we&#32;should&#32;open&#32;that&#32;expressiveness&#32;up&#32;to&#32;people&#32;that&#32;know&#32;what&#32;they&#32;are&#32;doing.&#32;I&#32;am&#32;sure&#32;there&#32;are&#32;a&#32;million&#32;other&#32;potential&#32;variations&#32;on&#32;those&#32;themes&#32;and&#32;many&#32;many&#32;other&#32;use&#32;cases&#32;for&#32;lifetime&#32;management&#32;that&#32;are&#32;being&#32;used.&#32;Don&#39;t&#32;Mort&#32;me&#32;&#58;&#41;Why&#32;do&#32;we&#32;have&#32;to&#32;jump&#32;through&#32;hoops&#32;for&#32;something&#32;like&#32;custom&#32;lifetime&#32;management.&#32;To&#32;me&#32;this&#32;is&#32;a&#32;first&#32;class&#32;concept&#32;in&#32;this&#32;problem&#32;domain.&#32;It&#32;would&#32;be&#32;very&#32;nice&#32;to&#32;be&#32;able&#32;to&#32;get&#32;an&#32;overload&#32;that&#32;acepts&#32;a&#32;lifetime&#32;manager&#32;that&#32;I&#32;can&#32;use&#32;to&#32;extend&#32;Unity&#32;without&#32;using&#32;two&#32;different&#32;ways&#32;of&#32;accomplishing&#32;the&#32;same&#32;task&#32;&#40;e.g.&#32;SetSingleton&#32;and&#32;RegisterInstance&#41;.&#32;I&#32;am&#32;sure&#32;I&#32;can&#32;accomplish&#32;this&#32;with&#32;extensions&#32;and&#32;other&#32;methods&#32;but&#32;this&#32;seems&#32;like&#32;a&#32;code&#32;smell.I&#39;d&#32;argue&#32;that&#32;instead&#32;of&#32;SetSingleton&#38;lt&#59;T&#38;gt&#59;&#40;&#41;&#47;Registerinstance&#40;&#41;&#32;overloads&#32;it&#32;makes&#32;more&#32;sense&#32;to&#32;have&#32;methods&#32;named&#32;SetLifetime&#38;lt&#59;T&#38;gt&#59;&#40;&#41;&#32;with&#32;all&#32;the&#32;same&#32;overloads&#32;that&#32;SetSingleton&#40;&#41;&#32;has&#32;now&#32;&#43;&#32;1&#32;more,&#32;the&#32;one&#32;where&#32;I&#32;can&#32;pass&#32;in&#32;my&#32;own&#32;lifetime&#32;manager.&#32;I&#32;am&#32;also&#32;all&#32;for&#32;allowing&#32;easy&#32;&#34;default&#34;&#32;lifetime&#32;management&#32;strategies&#32;via&#32;that&#32;enum,&#32;but&#32;let&#32;it&#32;simple&#32;create&#32;a&#32;built&#32;in&#32;SingletonLifetimeManager&#32;or&#32;NullLifetimeManager&#32;for&#32;each&#32;appropriate&#32;use&#32;case&#32;and&#32;call&#32;the&#32;same&#32;overload&#32;that&#32;I&#32;can.All&#32;in&#32;all&#32;though&#32;folks&#32;this&#32;is&#32;really&#32;starting&#32;to&#32;look&#32;good&#32;and&#32;am&#32;excited&#32;to&#32;see&#32;unity&#32;being&#32;available&#32;to&#32;the&#32;world.&#32;Keep&#32;up&#32;the&#32;good&#32;work&#33;-Jimmy">
        I will be the first to admit I have't fully walked through the code yet so if I am mistaken then please feel free to correct, flame, nuke, launch me into space, etc :)<br>
<br>
I agree that the LifetimeStyle enum has the two most common lifetime styles that are used, the proverbial bread and butter of container lifetimes, per request (transient) and singelton.<br>
<br>
However the limitation of using an enum as well as a use case specific method for lifetime management is limiting for many advanced use cases:<br>
<br>
i.e. #1 Objects that should be shared across requests just like a singleton but available for garbage collection (e.g. weakreferenced). This is completely a requirement for many messaging systems wherein objects might need to be initialized as needed, are thread
 safe, but don't need to stick around in memory unless being actively used. (specification objects often fall into this category). I completely understand I can implement this functionality by writing a class that caches the inner type but isn't that really
 forcing me to muddle my model with extrinsic concerns?<br>
<br>
i.e. #2 Objects that need to be throttled by the container. This is usually called pooling and something we've had in one of the first container systems, COM&#43;. Again I can get the same result without much effort but I have to remind everyone Unity should be
 as transparent to my system as is possible.<br>
<br>
Both of these are able to be done with ObjectBuilder (and I have) with policies and locators. we should open that expressiveness up to people that know what they are doing.
<br>
<br>
I am sure there are a million other potential variations on those themes and many many other use cases for lifetime management that are being used. Don't Mort me :)<br>
<br>
Why do we have to jump through hoops for something like custom lifetime management. To me this is a first class concept in this problem domain. It would be very nice to be able to get an overload that acepts a lifetime manager that I can use to extend Unity
 without using two different ways of accomplishing the same task (e.g. SetSingleton and RegisterInstance). I am sure I can accomplish this with extensions and other methods but this seems like a code smell.<br>
<br>
I'd argue that instead of SetSingleton&lt;T&gt;()/Registerinstance() overloads it makes more sense to have methods named SetLifetime&lt;T&gt;() with all the same overloads that SetSingleton() has now &#43; 1 more, the one where I can pass in my own lifetime manager.
 I am also all for allowing easy &quot;default&quot; lifetime management strategies via that enum, but let it simple create a built in SingletonLifetimeManager or NullLifetimeManager for each appropriate use case and call the same overload that I can.<br>
<br>
All in all though folks this is really starting to look good and am excited to see unity being available to the world. Keep up the good work!<br>
<br>
-Jimmy<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_74256" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="74259">
    <td id="PostDetailsCell_74259" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post74259"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/ctavares">ctavares</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="2/16/2008 12:17:32 AM" LocalTimeTicks="1203149852">Feb 16, 2008 at 12:17 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_74259" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;Thanks&#32;for&#32;the&#32;feedback,&#32;Jimmy.&#32;I&#32;have&#32;no&#32;intention&#32;of&#32;&#34;Morting&#34;&#32;you&#59;&#32;whatever&#32;that&#32;means.&#32;&#59;-&#41;We&#32;definitely&#32;acknowledge&#32;the&#32;need&#32;for&#32;additional&#32;lifetime&#32;management&#32;styles.&#32;In&#32;the&#32;end,&#32;there&#32;just&#32;ended&#32;up&#32;being&#32;way&#32;too&#32;many&#32;of&#32;them.&#32;Rather&#32;than&#32;put&#32;in&#32;a&#32;plethora&#32;of&#32;stuff&#32;and&#32;potentially&#32;putting&#32;in&#32;stuff&#32;nobody&#32;would&#32;use,&#32;we&#32;decided&#32;to&#32;put&#32;in&#32;the&#32;bare&#32;minimum&#32;and&#32;wait&#32;for&#32;feedback.&#32;Which&#32;is&#32;now&#32;coming&#32;in,&#32;such&#32;as&#32;this&#32;post.The&#32;OB&#32;expressiveness&#32;is&#32;available&#32;to&#32;those&#32;who&#32;know&#32;what&#32;they&#39;re&#32;doing&#32;via&#32;the&#32;container&#32;extension&#32;mechanism.&#32;This&#32;has&#32;the&#32;advantages&#32;of&#32;keeping&#32;the&#32;core&#32;interface&#32;dirt&#32;simple&#32;and&#32;letting&#32;the&#32;nascent&#32;community&#32;experiment&#32;a&#32;little&#32;before&#32;we&#32;bake&#32;this&#32;into&#32;the&#32;core&#32;container&#32;interface.So,&#32;I&#39;m&#32;sure&#32;you&#32;could&#32;imagine&#58;container.Configure&#38;lt&#59;ILifetime&#38;gt&#59;&#40;&#41;.SetLifetimeManager&#38;lt&#59;Foo&#38;gt&#59;&#40;new&#32;ComPlusLifetimeManager&#40;this,&#32;that,&#32;theother&#41;&#41;&#59;or&#32;something&#32;along&#32;those&#32;lines.The&#32;container&#32;should&#32;absolutely&#32;be&#32;able&#32;to&#32;everything&#32;you&#32;described&#32;above,&#32;and&#32;they&#32;can&#32;all&#32;be&#32;done&#32;via&#32;the&#32;extension&#32;mechanism.&#32;Rather&#32;than&#32;add&#32;something&#32;now&#32;to&#32;the&#32;core&#32;container&#32;interface,&#32;I&#39;d&#32;like&#32;to&#32;see&#32;if&#32;a&#32;general&#32;lifetime&#32;management&#32;extension&#32;evolves.&#32;Then,&#32;if&#32;it&#32;turns&#32;out&#32;to&#32;be&#32;something&#32;everyone&#32;likes,&#32;it&#32;can&#32;get&#32;promoted&#32;to&#32;the&#32;core&#32;container&#32;interface.Does&#32;that&#32;sound&#32;reasonable&#63;-Chris">
        Thanks for the feedback, Jimmy. I have no intention of &quot;Morting&quot; you; whatever that means. ;-)<br>
<br>
We definitely acknowledge the need for additional lifetime management styles. In the end, there just ended up being way too many of them. Rather than put in a plethora of stuff and potentially putting in stuff nobody would use, we decided to put in the bare
 minimum and wait for feedback. Which is now coming in, such as this post.<br>
<br>
The OB expressiveness is available to those who know what they're doing via the container extension mechanism. This has the advantages of keeping the core interface dirt simple and letting the nascent community experiment a little before we bake this into the
 core container interface.<br>
<br>
So, I'm sure you could imagine:<br>
<br>
container.Configure&lt;ILifetime&gt;().SetLifetimeManager&lt;Foo&gt;(new ComPlusLifetimeManager(this, that, theother));<br>
<br>
or something along those lines.<br>
<br>
The container should absolutely be able to everything you described above, and they can all be done via the extension mechanism. Rather than add something now to the core container interface, I'd like to see if a general lifetime management extension evolves.
 Then, if it turns out to be something everyone likes, it can get promoted to the core container interface.<br>
<br>
Does that sound reasonable?<br>
<br>
-Chris<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_74259" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="74267">
    <td id="PostDetailsCell_74267" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post74267"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/francois_tanguay">francois_tanguay</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="2/16/2008 1:28:52 AM" LocalTimeTicks="1203154132">Feb 16, 2008 at 1:28 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_74267" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;As&#32;previously&#32;posted,&#32;I&#39;ve&#32;done&#32;the&#32;exercise&#32;of&#32;developing&#32;such&#32;a&#32;lifetime&#32;management.I&#32;strongly&#32;believe&#32;SetSingleton&#32;should&#32;be&#32;ripped&#32;of&#32;the&#32;IUnityContainer&#32;interface&#32;and&#32;implemented&#32;using&#32;Configure&#38;lt&#59;ILifeTime&#38;gt&#59;&#40;&#41;.SetLifeTime&#40;...&#41;Actually,&#32;IUnityContainer&#32;should&#32;be&#32;kept&#32;minimal&#32;to&#32;ease&#32;other&#32;implementations&#32;&#47;&#32;decoration.For&#32;shorter&#32;syntax&#32;&#40;such&#32;as&#32;container.SetSingleton&#41;,&#32;I&#39;d&#32;rely&#32;on&#32;extension&#32;methods...The&#32;lifetime&#32;containers&#32;I&#39;ve&#32;came&#32;up&#32;with&#32;so&#32;far&#58;PerAppDomain,&#32;PerApplication&#32;&#40;web&#41;,&#32;PerContainer&#32;&#40;singleton&#41;,&#32;PerRequest&#32;&#40;web&#41;,&#32;PerSession&#32;&#40;web&#41;,&#32;PerThreadAny&#32;other&#32;worthwile&#63;">
        As previously posted, I've done the exercise of developing such a lifetime management.<br>
<br>
I strongly believe SetSingleton should be ripped of the IUnityContainer interface and implemented using Configure&lt;ILifeTime&gt;().SetLifeTime(...)<br>
<br>
Actually, IUnityContainer should be kept minimal to ease other implementations / decoration.<br>
<br>
For shorter syntax (such as container.SetSingleton), I'd rely on extension methods...<br>
<br>
The lifetime containers I've came up with so far:<br>
<br>
PerAppDomain, PerApplication (web), PerContainer (singleton), PerRequest (web), PerSession (web), PerThread<br>
<br>
Any other worthwile?<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_74267" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="74326">
    <td id="PostDetailsCell_74326" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post74326"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/jimmyzimms">jimmyzimms</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="2/16/2008 4:20:15 PM" LocalTimeTicks="1203207615">Feb 16, 2008 at 4:20 PM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="2/16/2008 4:25:47 PM" LocalTimeTicks="1203207947">Feb 16, 2008 at 4:25 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_74326" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;&#38;gt&#59;PerApplication&#32;&#40;web&#41;,&#32;PerContainer&#32;&#40;singleton&#41;,&#32;PerRequest&#32;&#40;web&#41;,&#32;PerSession&#32;&#40;web&#41;,&#32;PerThreadAgreed&#32;Francois&#33;&#32;These&#32;are&#32;some&#32;great&#32;ideas&#32;and&#32;common&#32;lifetime&#32;management&#32;strategies&#32;you&#32;mention.&#32;&#58;&#41;Just&#32;as&#32;an&#32;aside,&#32;I&#32;have&#32;seen&#32;many&#32;of&#32;these&#32;actually&#32;implemented&#32;in&#32;practice&#32;with&#32;a&#32;hierarchy&#32;of&#32;containers&#58;&#32;One&#32;for&#32;the&#32;Application.&#32;One&#32;per&#32;session.&#32;One&#32;per&#32;Request&#32;&#40;in&#32;the&#32;web&#32;that&#32;usually&#32;relates&#32;to&#32;per&#32;thread&#32;in&#32;practice&#41;All&#32;requests&#32;go&#32;to&#32;the&#32;lowest&#32;container&#32;at&#32;their&#32;level&#32;of&#32;responsibility&#32;&#40;i.e.&#32;a&#32;WebForm&#32;event&#32;handler&#32;nabbing&#32;an&#32;object&#32;it&#32;needs&#32;from&#32;the&#32;thread&#32;container&#32;while&#32;an&#32;HttpModule&#32;would&#32;be&#32;at&#32;the&#32;application&#32;level&#32;perhaps&#41;.&#32;If&#32;the&#32;result&#32;cannot&#32;be&#32;fulfilled&#32;by&#32;the&#32;local&#32;container&#32;it&#32;goes&#32;up&#32;the&#32;hierarchy&#32;until&#32;the&#32;request&#32;can&#32;be&#32;fulfilled&#32;or&#32;it&#32;hits&#32;the&#32;top.&#32;Classic&#32;Chain&#32;of&#32;Responsibility&#32;pattern.I&#32;just&#32;wanted&#32;to&#32;explicitly&#32;mention&#32;that&#32;that&#32;idea&#32;can&#32;be&#32;implemented&#32;in&#32;Unity&#32;as&#32;it&#32;stands&#32;today&#32;with&#32;support&#32;for&#32;a&#32;parent&#32;container.&#32;I&#32;feel&#32;it&#39;s&#32;such&#32;an&#32;important&#32;concept&#32;that&#32;it&#32;behooves&#32;me&#32;to&#32;mention&#32;it.&#32;&#58;&#41;-CheersJZ">
        &gt;PerApplication (web), PerContainer (singleton), PerRequest (web), PerSession (web), PerThread<br>
<br>
Agreed Francois! These are some great ideas and common lifetime management strategies you mention. :)<br>
<br>
Just as an aside, I have seen many of these actually implemented in practice with a hierarchy of containers: One for the Application. One per session. One per Request (in the web that usually relates to per thread in practice)<br>
All requests go to the lowest container at their level of responsibility (i.e. a WebForm event handler nabbing an object it needs from the thread container while an HttpModule would be at the application level perhaps). If the result cannot be fulfilled by
 the local container it goes up the hierarchy until the request can be fulfilled or it hits the top. Classic Chain of Responsibility pattern.<br>
<br>
I just wanted to explicitly mention that that idea can be implemented in Unity as it stands today with support for a parent container. I feel it's such an important concept that it behooves me to mention it. :)<br>
<br>
-Cheers<br>
<br>
JZ<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_74326" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="74329">
    <td id="PostDetailsCell_74329" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post74329"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/derekgreer">derekgreer</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="2/16/2008 4:47:05 PM" LocalTimeTicks="1203209225">Feb 16, 2008 at 4:47 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_74329" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;I&#32;whole-heartedly&#32;agree&#32;with&#32;Francois&#39;&#32;assessment.&#32;IUnityContainer&#32;should&#32;have&#32;no&#32;inherent&#32;concept&#32;of&#32;lifetime&#32;management,&#32;much&#32;less&#32;one&#32;specific&#32;lifetime&#32;management&#32;strategy.&#32;Lifetime&#32;management&#32;should&#32;be&#32;facilitated&#32;the&#32;exact&#32;same&#32;way&#32;any&#32;other&#32;creation&#32;stage&#32;strategy&#32;is&#32;handled&#32;...&#32;through&#32;extensions.It&#32;sounds&#32;like&#32;Francios,&#32;Jimmy,&#32;and&#32;I&#32;have&#32;each&#32;come&#32;to&#32;some&#32;similar&#32;conclusions&#32;about&#32;the&#32;singleton&#32;design&#32;choices.&#32;Each&#32;of&#32;us&#32;seems&#32;to&#32;dislike&#32;that&#32;Unity&#32;treats&#32;singletons&#32;as&#32;a&#32;special&#32;case.&#32;Francios&#32;and&#32;I&#32;are&#32;arguing&#32;that&#32;this&#32;should&#32;be&#32;done&#32;through&#32;extensions&#32;and&#32;should&#32;never&#32;be&#32;promoted&#32;to&#32;the&#32;IUnityContainer.My&#32;reasons&#32;for&#32;this&#32;proposal&#32;really&#32;come&#32;down&#32;to&#32;my&#32;believe&#32;that&#32;the&#32;current&#32;approach&#32;lacks&#32;adherence&#32;to&#32;the&#32;principle&#32;of&#32;Separation&#32;of&#32;Concerns,&#32;specifically&#32;in&#32;reference&#32;to&#32;the&#32;areas&#32;of&#32;categorization&#32;and&#32;grouping.&#32;The&#32;concerns&#32;of&#32;managing&#32;objects&#32;as&#32;singletons&#32;aren&#39;t&#32;being&#32;grouped&#32;together&#32;with&#32;how&#32;you&#32;would&#32;do&#32;other&#32;types&#32;of&#32;lifetime&#32;management.&#32;Furthermore,&#32;if&#32;the&#32;IUnityContainer&#32;were&#32;to&#32;be&#32;broadened&#32;to&#32;mange&#32;the&#32;concerns&#32;of&#32;any&#32;style&#32;of&#32;lifetime&#32;management&#32;&#40;e.g.&#32;through&#32;the&#32;use&#32;of&#32;the&#32;aforementioned&#32;SetLifetime&#32;methods&#41;,&#32;this&#32;would&#32;not&#32;group&#32;lifetime&#32;management&#32;concerns&#32;together&#32;with&#32;how&#32;other&#32;creation&#32;oriented&#32;things&#32;are&#32;managed&#32;&#40;i.e.&#32;through&#32;extensions&#41;.Jimmy,&#32;you&#32;mentioned&#32;that&#32;doing&#32;this&#32;through&#32;extensions&#32;seemed&#32;like&#32;a&#32;smell.&#32;I&#39;m&#32;interested&#32;in&#32;hearing&#32;some&#32;elaboration&#32;on&#32;this&#32;if&#32;you&#32;could.-&#32;Derek">
        I whole-heartedly agree with Francois' assessment. IUnityContainer should have no inherent concept of lifetime management, much less one specific lifetime management strategy. Lifetime management should be facilitated the exact same way any other creation
 stage strategy is handled ... through extensions.<br>
<br>
It sounds like Francios, Jimmy, and I have each come to some similar conclusions about the singleton design choices. Each of us seems to dislike that Unity treats singletons as a special case. Francios and I are arguing that this should be done through extensions
 and should <b>never</b> be promoted to the IUnityContainer.<br>
<br>
My reasons for this proposal really come down to my believe that the current approach lacks adherence to the
<a href="http://ctrl-shift-b.blogspot.com/2008/01/art-of-separation-of-concerns.html" rel="nofollow">
principle of Separation of Concerns<span style="font-family:Consolas,Courier New,Courier,Monospace"></span></a>, specifically in reference to the areas of categorization and grouping. The concerns of managing objects as singletons aren't being grouped together
 with how you would do other types of lifetime management. Furthermore, if the IUnityContainer were to be broadened to mange the concerns of any style of lifetime management (e.g. through the use of the aforementioned SetLifetime methods), this would not group
 lifetime management concerns together with how other creation oriented things are managed (i.e. through extensions).<br>
<br>
Jimmy, you mentioned that doing this through extensions seemed like a smell. I'm interested in hearing some elaboration on this if you could.<br>
<br>
- Derek<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_74329" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="74332">
    <td id="PostDetailsCell_74332" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post74332"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/jimmyzimms">jimmyzimms</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="2/16/2008 5:03:02 PM" LocalTimeTicks="1203210182">Feb 16, 2008 at 5:03 PM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="2/16/2008 5:19:38 PM" LocalTimeTicks="1203211178">Feb 16, 2008 at 5:19 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_74332" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;Derek,What&#32;I&#32;ment&#32;by&#32;that&#32;is&#32;that&#32;I&#32;would&#32;need&#32;to&#32;currently&#32;set&#32;singletons&#32;via&#32;an&#32;explicit&#32;method&#32;and&#32;all&#32;the&#32;other&#32;lifetime&#32;management&#32;strategies&#32;via&#32;extensions.&#32;Because&#32;I&#32;now&#32;have&#32;two&#32;ways&#32;to&#32;accomplish&#32;the&#32;same&#32;thing&#32;&#40;or&#32;actually&#32;two&#32;paths&#32;of&#32;execution&#32;to&#32;accomplish&#32;what&#32;I&#32;feel&#32;is&#32;the&#32;same&#32;cross-cutting&#32;concern,&#32;Lifetime&#32;strategy&#32;of&#32;which&#32;Singleton&#32;is&#32;one&#32;concrete&#32;type&#41;&#32;it&#39;s&#32;a&#32;code&#32;smell&#32;in&#32;the&#32;Api&#32;itself.&#32;Hopefully&#32;that&#39;s&#32;how&#32;a&#32;reader&#32;of&#32;my&#32;first&#32;post&#32;would&#32;take&#32;it&#32;&#40;or&#32;if&#32;not&#32;then&#32;here&#39;s&#32;what&#32;i&#32;ment&#32;&#58;&#41;&#41;Your&#32;statement&#32;&#34;The&#32;concerns&#32;of&#32;managing&#32;objects&#32;as&#32;singletons&#32;aren&#39;t&#32;being&#32;grouped&#32;together&#32;with&#32;how&#32;you&#32;would&#32;do&#32;other&#32;types&#32;of&#32;lifetime&#32;management&#34;&#32;is&#32;exactly&#32;my&#32;feeling&#32;as&#32;well&#59;&#32;you&#39;ve&#32;just&#32;more&#32;elegantly&#32;expressed&#32;it.&#32;&#58;&#41;&#32;I&#32;need&#32;to&#32;go&#32;drink&#32;more&#32;coffee&#32;before&#32;posting&#32;in&#32;the&#32;AM&#32;ha&#33;Now&#32;all&#32;that&#32;being&#32;said,&#32;I&#32;agree&#32;that&#32;this&#32;is&#32;completely&#32;a&#32;case&#32;where&#32;the&#32;implementation&#32;would&#32;be&#32;done&#32;via&#32;extensions.&#32;I&#32;think&#32;that&#32;usability&#32;is&#32;increased&#32;however&#32;by&#32;overloading&#32;the&#32;Register&#40;&#41;&#32;method&#32;to&#32;allow&#32;a&#32;ILifetimeManger&#32;type&#32;as&#32;a&#32;parameter&#32;or&#32;express&#32;it&#32;as&#32;another&#32;method&#32;SetLifetime&#38;lt&#59;T&#38;gt&#59;&#40;ILifetimeManager&#41;&#32;in&#32;the&#32;Api&#32;&#40;I&#32;guess&#32;that&#32;approach&#32;keeps&#32;the&#32;fluent&#32;interface&#32;fluent&#41;.Francois&#32;is&#32;totally&#32;correct&#32;that&#32;extension&#32;methods&#32;would&#32;be&#32;the&#32;best&#32;way&#32;to&#32;extend&#32;the&#32;Api&#32;to&#32;make&#32;it&#32;easier&#32;to&#32;use&#32;for&#32;developer&#32;that&#32;would&#32;benefit&#32;from&#32;an&#32;say&#32;explicit&#32;method&#32;that&#32;allows&#32;them&#32;to&#32;mark&#32;a&#32;class&#32;as&#32;singelton.&#32;This&#32;is&#32;great&#32;because&#32;it&#32;allows&#32;a&#32;whole&#32;ecosystem&#32;to&#32;develop&#32;around&#32;&#34;helpers&#34;.&#32;Keep&#32;Unity&#32;super&#32;clean&#32;and&#32;small&#32;for&#32;power&#32;programmers&#32;and&#32;map&#32;&#34;helpers&#34;&#32;to&#32;extension&#32;methods&#32;that&#32;can&#32;be&#32;included&#32;for&#32;those&#32;that&#32;benefit&#32;from&#32;them.&#32;This&#32;is&#32;not&#32;too&#32;disimilar&#32;to&#32;the&#32;whole&#32;nano&#47;pico&#32;relationship,&#32;just&#32;now&#32;we&#32;have&#32;the&#32;power&#32;of&#32;extension&#32;methods&#32;that&#32;make&#32;this&#32;approach&#32;even&#32;more&#32;kick&#32;ass.So&#32;basically&#32;something&#32;along&#32;the&#32;lines&#32;of&#32;a&#32;using&#32;Microsoft.Practices.Unity.Extensions&#59;gives&#32;developers&#32;the&#32;myContainer.RegisterSingleton&#40;type&#41;&#32;methods&#32;when&#32;they&#32;benefit.&#32;All&#32;that&#39;s&#32;really&#32;doing&#32;is&#32;calling&#32;the&#32;approriate&#32;combination&#32;of&#32;methods&#32;on&#32;Unity&#32;to&#32;get&#32;the&#32;job&#32;done.">
        Derek,<br>
<br>
What I ment by that is that I would need to currently set singletons via an explicit method and all the other lifetime management strategies via extensions. Because I now have two ways to accomplish the same thing (or actually two paths of execution to accomplish
 what I feel is the same cross-cutting concern, Lifetime strategy of which Singleton is one concrete type) it's a code smell in the Api itself. Hopefully that's how a reader of my first post would take it (or if not then here's what i ment :))<br>
<br>
Your statement &quot;The concerns of managing objects as singletons aren't being grouped together with how you would do other types of lifetime management&quot; is exactly my feeling as well; you've just more elegantly expressed it. :) I need to go drink more coffee
 before posting in the AM ha!<br>
<br>
Now all that being said, I agree that this is completely a case where the implementation would be done via extensions. I think that usability is increased however by overloading the Register() method to allow a ILifetimeManger type as a parameter or express
 it as another method SetLifetime&lt;T&gt;(ILifetimeManager) in the Api (I guess that approach keeps the fluent interface fluent).<br>
<br>
Francois is totally correct that extension methods would be the best way to extend the Api to make it easier to use for developer that would benefit from an say explicit method that allows them to mark a class as singelton. This is great because it allows a
 whole ecosystem to develop around &quot;helpers&quot;. Keep Unity super clean and small for power programmers and map &quot;helpers&quot; to extension methods that can be included for those that benefit from them. This is not too disimilar to the whole nano/pico relationship,
 just now we have the power of extension methods that make this approach even more kick ass.<br>
<br>
So basically something along the lines of a <br>
using Microsoft.Practices.Unity.Extensions;<br>
<br>
gives developers the myContainer.RegisterSingleton(type) methods when they benefit. All that's really doing is calling the approriate combination of methods on Unity to get the job done.<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_74332" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="74340">
    <td id="PostDetailsCell_74340" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post74340"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/derekgreer">derekgreer</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="2/16/2008 6:26:22 PM" LocalTimeTicks="1203215182">Feb 16, 2008 at 6:26 PM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="2/16/2008 6:26:47 PM" LocalTimeTicks="1203215207">Feb 16, 2008 at 6:26 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_74340" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;Concerning&#32;the&#32;fluent&#32;interface,&#32;while&#32;I&#32;didn&#39;t&#32;do&#32;something&#32;as&#32;nifty&#32;as&#32;what&#32;Francois&#32;has&#32;described,&#32;my&#32;sample&#32;singleton&#32;implementation&#32;does&#32;preserve&#32;the&#32;fluent&#32;interface&#32;pattern&#58;&#32;container&#32;&#61;&#32;new&#32;UnityContainer&#40;&#41;&#32;.AddNewExtension&#38;lt&#59;SingletonExtension&#38;gt&#59;&#40;&#41;&#32;.Configure&#38;lt&#59;ISingletonExtensionConfiguration&#38;gt&#59;&#40;&#41;&#32;.RegisterAsSingleton&#38;lt&#59;MySingleton&#38;gt&#59;&#40;&#41;&#59;&#32;Derek">
        Concerning the fluent interface, while I didn't do something as nifty as what Francois has described, my sample singleton implementation does preserve the fluent interface pattern:<br>
<br>
<pre style="background-color:#ECECEC; border:dashed .1em #3E62A6; font-family:Consolas,Courier New,Courier,Monospace; font-size:1em; margin-top:0; padding:.5em; height:auto; overflow:auto; overflow-x:auto; overflow-y:auto">
 
             container = new UnityContainer()
                .AddNewExtension&lt;SingletonExtension&gt;()
                .Configure&lt;ISingletonExtensionConfiguration&gt;()
                .RegisterAsSingleton&lt;MySingleton&gt;();
 
</pre>
<br>
<br>
Derek<br>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_74340" class="Options" >
            
        </div>
        
    </td>
</tr>

</table>
    </div>

    
        <div class="StandardMarginTop">
            <a id="SignInToAddCommentLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2funity.codeplex.com%2fdiscussions%2f22282">
                Sign in to post message or set email notifications
            </a>
        </div>
    


    <div id="PostEditorContainer">
        <a name="editor"></a>
        <div id="Editor" style="display: none;">
            

<div class="MarkdownEditor" data-options-id="01554ca2-58d3-4211-a629-90584d6e836f">
    <script class="options" defer="defer" id="01554ca2-58d3-4211-a629-90584d6e836f" type="application/json">{"maxLength":10000,"styleSheetLocation":""}</script>

    <div class="MarkdownEditorControls">
        <a href="#" tabindex="-1" class="control md_help" title="Markdown Syntax Guide"></a>
        <div class="control md_divider"></div>
        <a href="#" tabindex="-1" class="control md_header" title="Insert Header (CTRL + H)"></a>
        <a href="#" tabindex="-1" class="control md_code" title="Insert Code (CTRL + K)"></a>
        <a href="#" tabindex="-1" class="control md_quote" title="Insert Quote (CTRL + Q)"></a>
        <a href="#" tabindex="-1" class="control md_img" title="Insert Img (CTRL + G)"></a>
        <a href="#" tabindex="-1" class="control md_link" title="Insert Link (CTRL + L)"></a>
        <a href="#" tabindex="-1" class="control md_ulist" title="Unordered List (CTRL + U)"></a>
        <a href="#" tabindex="-1" class="control md_olist" title="Ordered List (CTRL + O)"></a>
        <a href="#" tabindex="-1" class="control md_italics" title="Italic Text (CTRL + I)"></a>
        <a href="#" tabindex="-1" class="control md_bold" title="Bold Text (CTRL + B)"></a>
    </div>

    

<div class="tab_control">
    <!-- Generate the basic HTML for the tabs. -->
    
        <div id="Compose"
              class="tab selected"
              data-custom-header-id=""
              data-tab-contents-id="compose_contents_b3c3dc81-0a65-43f5-8d45-7249450b1e94">
            Compose
        </div>
    
        <div id="Preview"
              class="tab "
              data-custom-header-id=""
              data-tab-contents-id="preview_contents_c467a15c-c62d-4776-ad3d-90787d5cc9b6">
            Preview
        </div>
    
    <div class="clear"></div>
</div>


    <div id="compose_contents_b3c3dc81-0a65-43f5-8d45-7249450b1e94" class="compose_tab_content">
        <textarea class=" MarkdownEditorDimensions" cols="20" id="MarkdownEditor" name="content" rows="2">
</textarea>
        <div class="ClearBoth"></div>

        <div class="markdownGuide" style="display: none">
            <table>
                <tr>
                    <td class="markdownGuideColumn">
                        <h1>Text Formatting</h1>
                        <div># Header 1</div>
                        <div>## Header 2</div>
                        <br />
                        <div>*italics* (or _italics_)</div>
                        <div>**bold** (or __bold__)</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Lists</h1>
                        <div>* Unordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp * SubItem</div>
                        <br />
                        <div>1. Ordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 1. SubItem</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Quotes</h1>
                        <div>> Lorem ipsum</div>
                        <div>dolor sitamet </div>
                        <div>non. Lectus at</div>
                        <div>nam nunc...</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Code</h1>
                        <div>`Inline Code`</div>
                        <br />
                        <div>``` C#</div>
                        <div>if (foo==bar)</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbspbar++</div>
                        <div>```</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>References</h1>
                        <div>[Link Text](URL)</div>
                        <br />
                        <div>![Image](URL)</div>
                        <br />
                        <a class="Reference" target="_blank" href="http://codeplex.codeplex.com/wikipage?title=Markdown&referringTitle=Documentation">Markdown Reference</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div id="preview_contents_c467a15c-c62d-4776-ad3d-90787d5cc9b6" class="preview_tab_content markDownOutput">
        
            <div></div>
        
    </div>
    <div class="clear"></div>
</div>

            
            <div class="row" id="recaptcha_row">
                
<script type="text/javascript">
    $(document).ready(function () {
        $('#recaptcha_reload').attr('src', '../assets/recaptcha_refresh.png');
        $('#recaptcha_switch_audio').attr('src', '../assets/recaptcha_audio.png');
        $('#recaptcha_switch_img').attr('src', '../assets/recaptcha_text.png');
        $('#recaptcha_whatsthis').attr('src', '../assets/recaptcha_help.png');
        $('#recaptcha_area tr:first').attr('height', '35');
    });
</script>

                <div class="clear"></div>
                <span id="ReCaptchaError"></span>
            </div>
            <div style="padding-top: 6px;">
                <input type="button" id="SaveButton" value="Save" class="ok" />
                <input type="button" id="CancelButton" value="Cancel" class="cancel" />
                <div class="clear"></div>
            </div>
        </div>
    </div>
</div>

<div id="DeletePostPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Post <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this post? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="ClosePostCancel" value="Cancel" class="cancel" />
            <input type="button" id="ClosePostOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>
        
            <!-- Email notification / Subscription details -->
            
    </div>
</div>
    
<div id="DeleteThreadPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Thread <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this thread? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="CloseThreadCancel" value="Cancel" class="cancel" />
            <input type="button" id="CloseThreadOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>

<script type="text/javascript" language="javascript">
    $(function () {

        $('#recaptcha_response_field')
            .bind('keypress', function (event) { return $submitKeyPressElement(this, event); });


        if ($('#DeleteThreadLink')) {
            $('#DeleteThreadLink').click(function () {
                OpenDialog('#DeleteThreadPanel', true, '41em');
            });
        }
        
        $('#DeleteThreadPanel #CloseThreadOk').click(function () {
            var url = 'http://unity.codeplex.com/discussions/22282';
            $.ajax({
                url: url,
                type: 'DELETE',
                success: function (x) {
                    location.href = x.RedirectUrl;
                }
            });
        });
    });

    workItemMention = new codeplex.ui.WorkItemMention();
    workItemMention.addLinks(".discussionPost");
</script>


        
        
                
                <div class="clear"></div>
                
                <div id="footer">
                    <div class="row">
                        <hr />
                        <ul>
                            <li>Â© 2006-2017 Microsoft</li>
                            <li><a href="http://www.codeplex.com/site/help">Get Help</a></li>
                            <li><a href="/site/legal/privacy">Privacy Statement</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/terms">Terms of Use</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/conduct">Code of Conduct</a></li>
                            <li><a href="http://developermedia.com/" target="_blank">Advertise With Us</a></li>
                            <li>Version 2017.10.3.21062</li>
                        </ul>
                    </div>
                </div>
            </div>
        </form>
    </body>

</html>