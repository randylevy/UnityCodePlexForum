

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="" prefix="og: http://ogp.me/ns# profile: http://ogp.me/ns/profile#">
    
    
    
    

    
    <head>
        <meta id="CompatabilityMode" http-equiv="X-UA-Compatible" content="IE=edge" />
	    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../assets/StyleSheet.css" id="MasterCss" rel="stylesheet" type="text/css" />
        <link rel="SHORTCUT ICON" href="../assets/favicon.ico" />
        <title>patterns &#38; practices - Unity - Just some ideas</title>
        
       
                    <script src="../assets/mscc-0.3.6.min.js"></script>
        
                    <link rel="stylesheet" type="text/css" href="../assets/mscc-0.3.6.min.css" />
        
            <script type="text/javascript">
                var msccHadCookieBannerAtPageStart = true;
            </script>
        

        <!--
        Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code,
        not by Microsoft.  See ASP.NET Ajax CDN Terms of Use â€“ http://www.asp.net/ajaxlibrary/CDN.ashx.
        -->
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.4.4.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery === 'undefined') {
                document.write(unescape("%3Cscript src='https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        <script src="https://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.6/jquery-ui.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery.ui === 'undefined') {
                document.write(unescape("%3Cscript src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        
    <style type="text/css">.SideBar, .SideBarPadding{display:none;}.MainContent{width:auto;}.SiteContentTable{width:100%;}</style>
    <style id="ProjectStyles" type="text/css">
        .SiteHeader, .SiteHeaderLeft {
            height:45px !important;
            overflow:hidden;
        }
        .SiteContent 
        {
            padding: 0 0 1em 0;
            margin-top:0;
            min-height:225px;
            border-right: 1px solid lightgrey;
            border-left: 1px solid lightgrey;
            border-bottom: 1px solid lightgrey;
        }
        .IE table.MinWidthContent
        {
	        table-layout: auto !important;	
        }
    </style>
    
    
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">

    
    
    <meta id="WTProjectName" name="WT.pi" content="unity"/>
    

    <link rel="EditURI" type="application/rsd+xml" title="RSD" href='http://unity.codeplex.com/rsd' />
    <link rel="wlwmanifest" type="application/wlwmanifest+xml" title="WLWManifest" href='/wlwmanifest.xml' />
    
    
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity" url="http://unity.codeplex.com/project/feeds/rss"/>
    
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Discussions" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2funity"/>
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Issues" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2funity"/>
        
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Downloads" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2funity"/>
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Reviews" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2funity"/>
        
    
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Source&#32;code" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2funity"/>
        <link rel="alternate" type="application/rss+xml" title="patterns&#32;&#38;&#32;practices&#32;-&#32;Unity&#32;-&#32;Wiki" url="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2funity"/>
    
        
    
        <meta content="summary" name="twitter:card" /><meta content="@CodePlex" name="twitter:site" /><meta content="http://unity.codeplex.com/discussions/203744?ProjectName=unity" name="twitter:url" /><meta content="patterns &amp;#38; practices - Unity" name="twitter:title" /><meta content="The Unity Application Block &amp;#40;Unity&amp;#41; is officially under new ownership.&amp;#13;&amp;#10;https&amp;#58;&amp;#47;&amp;#47;github.com&amp;#47;unitycontainer&amp;#47;unity" name="twitter:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" name="twitter:image" /><meta content="CodePlex" property="og:site_name" /><meta content="http://unity.codeplex.com/discussions/203744?ProjectName=unity" property="og:url" /><meta content="object" property="og:type" /><meta content="patterns &amp;#38; practices - Unity" property="og:title" /><meta content="The Unity Application Block &amp;#40;Unity&amp;#41; is officially under new ownership.&amp;#13;&amp;#10;https&amp;#58;&amp;#47;&amp;#47;github.com&amp;#47;unitycontainer&amp;#47;unity" property="og:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" property="og:image" />
        

    </head>
    
    <body>
         
            
        <script src="../assets/ScriptLoader.js" type="text/javascript"></script>
        <form id="aspnetForm" autocomplete="off" method="POST" enctype="multipart/form-data">
            <input name="__RequestVerificationToken" type="hidden" value="8tEQQa-EVczyclLWtPv9HFARC1UexsJxlwi-tG0wl-M_MUo3h5XyTn7Ik6HkVsi8PTI8BAm2W7A5nB28UIia4ARwtUo8B45WGUq1TZDH8_pT05aM-Mptdef0tAn99PaemhfF2Q2" /><input name="__RequestVerificationToken2" type="hidden" value="__RequestVerificationToken28fab2558-99fd-4fcb-9089-54bd8fdcdcd7" />
            
            <div id="UpdateProgressPanel" class="loading_animation" style="display:none;">
                <div class="row">
                    <h2 class="anim_h2">
                        <span id="UpdateProgressText">Updating...</span>
                        <span id="animatedLoadingIconContainer">
                            <img id="animatedLoadingIcon" src="../assets/loading_animation.gif" class="anim_img"/>
                        </span>
                    </h2>
                </div>
            </div>
            
            <div style="display:none;">
                
                <img id="BlankImage" style="width:0;height:0;" src="../assets/blank.png" onload="self.logoImageLoaded=true;"/>

                <script language="javascript" type="text/javascript">
                    var date = new Date();
                    var timezoneOffset = date.getTimezoneOffset() / 60 * -1;
                    var timezoneOffsetCookie = getCookie("TimezoneOffset");
                    var firstTimeSetTimezoneCookie = false;

                    if (timezoneOffsetCookie == null || timezoneOffsetCookie != timezoneOffset) {
                        firstTimeSetTimezoneCookie = true;
                        document.cookie = "TimezoneOffset=" + timezoneOffset + '; domain=.codeplex.com;expires=Wed, 10 Oct 2018 05:25:52 UTC';
                    }
                </script>
            </div>
            
            
            <div id="banner">
                <div id="message"><strong>This is an archived copy of the original CodePlex Unity Discussion Forum</strong><br />Unity is now on <a href="https://github.com/unitycontainer/">GitHub</a>
                    
                </div>
            </div>
            

            <div id="header">
                <div id="header_wrap" class="row">
                    <p id="logo"><a href="http://www.codeplex.com">Code<span class="semi">Plex</span></a><span id="tagline">Project Hosting for Open Source Software</span></p>
                    

<ul id="nav">

    <li><a href="/site/register/new" id="registerLink" class="ZoomFix">Register</a></li>
    <li ><a class="SignInLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2funity.codeplex.com%2fdiscussions%2f203744" id="signInLink">Sign In</a></li>
  
    <li class="last"><a class="rss_site_icon" href="http://www.codeplex.com/site/feeds/rss" type="application/rss+xml" rel="Alternate" title="CodePlex Site Activity"></a></li>
</ul>
                    <input id="searchsite" name="searchsite" maxlength="500" type="text" value="" /><span id="search_mag"><a id="submitSearch" name="submitSearch" class="magnify" title="Search" href="#"></a></span>
                    <script>
	$(document).ready(function() {
    var searchButton = $('#submitSearch'),
        searchBar = $('#searchsite');

    // Register our own handler for the search event while we wait for the SearchBox script to load.
    searchButton.bind('click.backupSearchBox', doProjectSearch);
    searchBar.bind('keypress.backupSearchBox', function(e) { if ($keyCode(e) === 13) { doProjectSearch(); return false; } });

    function cleanupSearchEvents() {
        // If the SearchBox was loaded, unregister our handlers.
        if (epx_loaded) {
            searchButton.unbind('.backupSearchBox');
            searchBar.unbind('.backupSearchBox');
        }
    }

    $loadScript('http://i4.services.social.microsoft.com/search/Widgets/SearchBox.jss?appid=1000&scopeid=1&boxId=searchsite&btnId=submitSearch&watermark=Search%20all%20projects&overrideWatermark=true&searchLocation=%2fsite%2fsearch&allowEmptySearch=true&focusOnInit=False&minimumTermLength=3', cleanupSearchEvents);
})
function doProjectSearch() {
    
    var url = '/site/search';

    //If search term is not same as watermark
    if($('#searchsite').val() != 'Search all projects')    
    {        
        url = url + '?query=' + encodeURIComponent($('#searchsite').val());
    }

    
    var callback = '';
    if (callback.length > 0 && eval('typeof ' + callback) != 'undefined')
        url += eval(callback + '()');

    window.location.href = url;
    return false;
}
</script>
                </div>
            </div>
            
            <div id="wrap">
                
    <div id="sub_heading" class="row">
        
        <div id="ProjectHeader">
            <div id="project_title_row" class="row">
                <div id="project_logo">
                    
<a id="AffiliateLink" href="http://msdn.microsoft.com/practices">
    <img id="AffiliateImage" src="../assets/pnp_logo.png" title="patterns&#32;&#38;&#32;practices" />
</a>

    
    <h1 class="text_only"><a href="http://unity.codeplex.com/" id="ProjectTitle1"><div>patterns &#38; practices - Unity</div></a></h1>

                </div>
            </div>
        </div>
        
        <div id="ProjectDetailsDiv">
            
        </div>
		<div class="clear"></div>
        

<ul id="page_box_links">
	<li id="homeTabCell" style="width: 63px;"><a id="homeTab" href="http://unity.codeplex.com/" class="box_home">home</a><div></div></li>
    
	<li id="sourceTabCell" style="width:113px;"><a id="sourceTab" href="http://unity.codeplex.com/SourceControl/latest" class="box_source">source code</a><div></div></li>
    
	<li id="releasesTabCell" style="width:105px;"><a id="releasesTab" href="http://unity.codeplex.com/releases" class="box_downloads">downloads</a><div></div></li>
    
    <li id="documentationTabCell" style="width:143px;"><a id="documentationTab" href="http://unity.codeplex.com/documentation" class="box_documentation">documentation</a><div></div></li>
    
	<li id="discussionTabCell" style="width:112px;"><a id="discussionTab" href="../index.html" class="discussions_active">discussions</a><div></div></li>
    
	<li id="workItemsTabCell" style="width:70px;"><a id="workItemsTab" href="http://unity.codeplex.com/workitem/list/basic" class="box_issue">issues</a><div></div></li>
    
	<li id="peopleTabCell" style="width:70px;"><a id="peopleTab" href="http://unity.codeplex.com/team/view" class="box_people">people</a><div></div></li>
	<li id="licenseTabCell" style="width:70px;"><a id="licenseTab" href="http://unity.codeplex.com/license" class="box_license">license</a><div></div></li>
    
    <span class="stretch"></span>
</ul>

<script type="text/javascript">
    $(document).ready(function () {
        $('#page_box_links').applyLastClassToList();
    });
</script>
		    <div class="clear"></div>
            
     <td>
       

<div>
    
    <div id="actionBar" class="action_bar">
        <ul id="actionBar_ul" class="actionBar_sublinks subtab_right" style="vertical-align: middle;">

            

                <li id="li_actionbar_creatediscussion" data-action-id="actionbar_creatediscussion" data-action-type="Navigate" class="actionBar_sublinks" data-options-id="3c88a4c1-8dee-4817-8a78-6c8f7d79cedb">
                
                    <script class="options" defer="defer" id="3c88a4c1-8dee-4817-8a78-6c8f7d79cedb" type="application/json">{"navigate-url":"http://unity.codeplex.com/discussions/create"}</script> 
                    
                    <div class="actionBar_custom_content"></div>

                    <a href="#" id="actionbar_creatediscussion" title="Start a New Thread" class="action_bar_item_link">
                        <img id="img_actionbar_creatediscussion" class="action_bar_item_image" src="../assets/actionbar_newitem.png" style="vertical-align: middle" />
                        New Thread
                    </a>

                </li>

            

                <li id="li_actionbar_subscribe" data-action-id="actionbar_subscribe" data-action-type="PopUp" class="actionBar_sublinks" data-options-id="b74a80e5-e11b-4ca1-9f22-86ee53ae4c5a">
                
                    <script class="options" defer="defer" id="b74a80e5-e11b-4ca1-9f22-86ee53ae4c5a" type="application/json">{}</script> 
                    
                    <div class="actionBar_custom_content">

<div id="rssHoverDiv" class="HoverPanel LeftHoverWidth" style="display: none">
        <ul id="3_FeedsPanel" class="RssFeedsPanel">
            <li>
                <a id="ProjectRssLink" href="http://unity.codeplex.com/project/feeds/rss" class="ArrowSmall NoUnderline">All Project Updates</a>
            </li>
            
            <li>
                <a id="DiscussionRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2funity" class="ArrowSmall NoUnderline">Discussions</a>
            </li>
            
            <li>
                <a id="IssueTrackerRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2funity" class="ArrowSmall NoUnderline">Issue Tracker</a>
            </li>
            
            <li>
                <a id="ReleasesRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2funity" class="ArrowSmall NoUnderline">Downloads</a>
            </li>
            <li>
                <a id="ReviewsRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2funity" class="ArrowSmall NoUnderline">Reviews</a>
            </li>
            
            <li>
                <a id="SourceControlRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2funity" class="ArrowSmall NoUnderline">Source Code</a>
            </li>
            <li>
                <a id="WikiRssLink" href="http://unity.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2funity" class="ArrowSmall NoUnderline">Wiki &amp; Documentation</a>
            </li>
        </ul>
</div></div>

                    <a href="#" id="actionbar_subscribe" title="Subscribe to project updates in RSS feeds." class="action_bar_item_link">
                        <img id="img_actionbar_subscribe" class="action_bar_item_image" src="../assets/actionbar_subscribe.png" style="vertical-align: middle" />
                        Subscribe
                    </a>

                </li>

            
        </ul>
    </div>
</div>
     </td>

        

    </div>
    
    
<div class="Threads">
    <div class="ViewThread">
        
        
        
            <h1 class="page_title WordWrapBreakWord">
                Just some ideas
            </h1>

            <!-- Private Discussion header -->
            

            <!-- Posts List Header: Topics and Wiki Link -->
            <table class="PostsListHeader">
                <tr>
                    <td>
                     
                    </td>
                    <td>
                        <div class="WikiLink">
                            <span title="Paste this into a wiki page to link to this discussion">
                                Wiki Link: [discussion:203744]
                            </span>
                        </div>
                    </td>
                </tr>
            </table>

            <!-- The list of posts -->
            

<div id="discussionsPostList" data-options-id="1d3acea4-3a0d-4ee8-a15a-afa5eb7e3b03">
    <script class="options" defer="defer" id="1d3acea4-3a0d-4ee8-a15a-afa5eb7e3b03" type="application/json">{"threadUrl":"http://unity.codeplex.com/discussions/203744","showEditor":false,"checkImageUrl":"../assets/check_answer.png"}</script>

    <div class="Posts" style="margin-top: 10px;">
    

<table cellpadding="0" cellspacing="0" style="width: 100%; margin-bottom: 0px; table-layout:fixed">
    

<tr id="PostPanel" class="Post" d:forid="413991">
    <td id="PostDetailsCell_413991" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post413991"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/marcoerni">marcoerni</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="3/4/2010 7:34:53 AM" LocalTimeTicks="1267716893">Mar 4, 2010 at 7:34 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_413991" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Hi&#32;I&#39;&#32;am&#32;just&#32;starting&#32;to&#32;prepare&#32;the&#32;migration&#32;of&#32;some&#32;mid-&#32;to&#32;large-size&#32;projects&#32;based&#32;on&#32;Unity&#32;1.2&#32;to&#32;Unity&#32;2.0.&#32;I&#32;know&#32;Unity&#32;2.0&#32;is&#32;already&#32;in&#32;Beta&#32;phase&#32;and&#32;there&#32;will&#32;be&#32;not&#32;much&#32;chance&#32;to&#32;include&#32;new&#32;features&#32;or&#32;make&#32;big&#32;changes.&#32;However&#32;I&#32;list&#32;here&#32;some&#32;wishes,&#32;change&#32;requests&#32;and&#32;considerations.&#32;Perhaps&#32;they&#32;could&#32;be&#32;taken&#32;into&#32;account&#32;when&#32;defining&#32;the&#32;Unity&#32;2.x&#32;Backlog&#32;&#38;hellip&#59;&#32;&#32;The&#32;Unity&#32;and&#32;Object&#32;Builder&#32;assemblies&#32;have&#32;been&#32;merged&#32;into&#32;a&#32;single&#32;one.&#32;Why&#32;not&#32;just&#32;merge&#32;the&#32;&#42;.Configuration&#32;assemblies&#32;into&#32;their&#32;corresponding&#32;assemblies.&#32;The&#32;Unity&#32;Service&#32;Locator&#32;implementation&#32;is&#32;now&#32;in&#32;the&#32;Unity&#32;assembly.&#32;This&#32;requires&#32;a&#32;dependency&#32;to&#32;the&#32;Service&#32;Location&#32;assembly.&#32;Why&#32;not&#32;just&#32;put&#32;it&#32;in&#32;an&#32;own&#32;assembly&#32;like&#32;Microsoft.Practices.Unity.ServiceLocation&#32;or&#32;so.&#32;In&#32;our&#32;project&#32;we&#32;provide&#32;an&#32;own&#32;Service&#32;Locator&#32;interface&#32;and&#32;implementation&#32;with&#32;much&#32;more&#32;functionality&#32;and&#32;now&#32;we&#32;have&#32;to&#32;deploy&#32;another&#32;assembly&#32;&#40;Microsoft.Practices.Unity.ServiceLocation&#41;&#32;as&#32;it&#32;was&#32;before&#32;with&#32;the&#32;Object&#32;Builder&#32;assembly.&#32;It&#32;would&#32;be&#32;great&#32;to&#32;have&#32;some&#32;more&#32;overloads&#32;on&#32;the&#32;Injection&#32;factory&#32;that&#32;allows&#32;specifying&#32;a&#32;delegate&#32;without&#32;the&#32;IUnityContainer&#32;or&#32;to&#32;register&#32;a&#32;type&#32;implementing&#32;a&#32;IFactory&#32;interface&#32;or&#32;something&#32;like&#32;that.&#32;In&#32;Custom&#32;Object&#32;Builder&#32;Strategy&#32;we&#32;must&#32;know&#32;the&#32;Type&#32;that&#32;is&#32;requesting&#32;the&#32;creation&#32;of&#32;the&#32;actual&#32;Type&#32;that&#32;is&#32;being&#32;built&#32;&#40;so&#32;we&#32;can&#32;create&#32;log4net&#32;ILogger&#32;instances&#32;using&#32;the&#32;type&#32;that&#32;has&#32;the&#32;dependency&#32;to&#32;the&#32;ILogger&#41;.&#32;We&#32;have&#32;achieved&#32;this&#32;by&#32;adding&#32;another&#32;Object&#32;Builder&#32;Strategy&#32;that&#32;uses&#32;a&#32;Policy&#32;to&#32;build&#32;a&#32;Stack&#32;of&#32;all&#32;types&#32;that&#32;are&#32;built&#32;during&#32;a&#32;single&#32;build&#32;up&#32;call.&#32;It&#32;would&#32;be&#32;nice&#32;if&#32;some&#32;sort&#32;of&#32;functionality&#32;would&#32;be&#32;supported&#32;directly&#32;by&#32;the&#32;Object&#32;Builder.&#32;Finally&#32;it&#32;would&#32;be&#32;great&#32;to&#32;have&#32;built&#32;in&#32;some&#32;extension&#32;methods,&#32;like&#32;the&#32;following&#32;ones&#58;&#32;&#32;Overload&#32;to&#32;the&#32;IsRegistered&#32;method&#32;to&#32;query&#32;the&#32;container&#32;if&#32;a&#32;type&#32;is&#32;registered&#32;with&#32;a&#32;given&#32;LifetimeManager.&#32;Some&#32;TryResolve&#32;methods&#32;return&#32;null&#32;instead&#32;of&#32;throwing&#32;an&#32;exception&#32;if&#32;the&#32;requested&#32;type&#32;could&#32;not&#32;be&#32;resolved.&#32;An&#32;IsExtensionConfigured&#32;method&#32;to&#32;ask&#32;the&#32;container&#32;a&#32;given&#32;type&#32;of&#32;Unity&#32;Container&#32;Extension&#32;is&#32;configured.&#32;A&#32;RegisterExtension&#32;method&#32;that&#32;resolves&#32;an&#32;Unity&#32;Container&#32;Extension&#32;trough&#32;the&#32;Unity&#32;Container&#32;and&#32;adds&#32;the&#32;created&#32;instance&#32;of&#32;the&#32;Unity&#32;Container&#32;Extension&#32;to&#32;the&#32;container.&#32;An&#32;EnsureExtension&#32;method&#32;that&#32;returns&#32;a&#32;Unity&#32;Container&#32;Extension&#32;instance&#32;&#40;like&#32;the&#32;Configure&#32;methods&#41;,&#32;but&#32;calls&#32;the&#32;above&#32;RegisterExtension&#32;method&#32;if&#32;it&#32;is&#32;not&#32;already&#32;registered.&#32;&#32;&#32;&#32;It&#32;would&#32;be&#32;great&#32;if&#32;we&#32;see&#32;some&#32;of&#32;the&#32;above&#32;points&#32;in&#32;any&#32;future&#32;release&#32;of&#32;Unity.&#32;Keep&#32;up&#32;the&#32;really&#32;good&#32;work&#33;&#32;We&#32;love&#32;it&#32;&#38;hellip&#59;&#32;Thanks,&#32;Marco">
        
<p>Hi</p>
<p>I' am just starting to prepare the migration of some mid- to large-size projects based on Unity 1.2 to Unity 2.0. I know Unity 2.0 is already in Beta phase and there will be not much chance to include new features or make big changes. However I list here
 some wishes, change requests and considerations. Perhaps they could be taken into account when defining the Unity 2.x Backlog &hellip;</p>
<ul>
<li>The Unity and Object Builder assemblies have been merged into a single one. Why not just merge the *.Configuration assemblies into their corresponding assemblies.
</li><li>The Unity Service Locator implementation is now in the Unity assembly. This requires a dependency to the Service Location assembly. Why not just put it in an own assembly like Microsoft.Practices.Unity.ServiceLocation or so. In our project we provide an
 own Service Locator interface and implementation with much more functionality and now we have to deploy another assembly (Microsoft.Practices.Unity.ServiceLocation) as it was before with the Object Builder assembly.
</li><li>It would be great to have some more overloads on the Injection factory that allows specifying a delegate without the IUnityContainer or to register a type implementing a IFactory interface or something like that.
</li><li>In Custom Object Builder Strategy we must know the Type that is requesting the creation of the actual Type that is being built (so we can create log4net ILogger instances using the type that has the dependency to the ILogger). We have achieved this by adding
 another Object Builder Strategy that uses a Policy to build a Stack of all types that are built during a single build up call. It would be nice if some sort of functionality would be supported directly by the Object Builder.
</li><li>Finally it would be great to have built in some extension methods, like the following ones:
<ul>
<li>Overload to the IsRegistered method to query the container if a type is registered with a given LifetimeManager.
</li><li>Some TryResolve methods return null instead of throwing an exception if the requested type could not be resolved.
</li><li>An IsExtensionConfigured method to ask the container a given type of Unity Container Extension is configured.
</li><li>A RegisterExtension method that resolves an Unity Container Extension trough the Unity Container and adds the created instance of the Unity Container Extension to the container.
</li><li>An EnsureExtension method that returns a Unity Container Extension instance (like the Configure methods), but calls the above RegisterExtension method if it is not already registered.
</li></ul>
</li></ul>
<p>It would be great if we see some of the above points in any future release of Unity. Keep up the really good work! We love it &hellip;</p>
<p>Thanks, Marco</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_413991" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="414429">
    <td id="PostDetailsCell_414429" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post414429"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/ctavares">ctavares</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="3/5/2010 3:53:19 AM" LocalTimeTicks="1267789999">Mar 5, 2010 at 3:53 AM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="3/5/2010 3:55:22 AM" LocalTimeTicks="1267790122">Mar 5, 2010 at 3:55 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_414429" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Thanks&#32;for&#32;the&#32;suggestions&#33;&#32;You&#39;re&#32;right,&#32;it&#39;s&#32;pretty&#32;late&#32;in&#32;the&#32;game&#32;at&#32;this&#32;point,&#32;so&#32;I&#32;don&#39;t&#32;expect&#32;any&#32;of&#32;these&#32;to&#32;make&#32;it&#32;into&#32;2.0.&#32;But&#32;I&#39;d&#32;like&#32;to&#32;address&#32;your&#32;points&#32;one&#32;by&#32;one,&#32;because&#32;I&#32;think&#32;it&#39;s&#32;useful&#58;&#32;&#32;The&#32;Unity&#32;and&#32;Object&#32;Builder&#32;assemblies&#32;have&#32;been&#32;merged&#32;into&#32;a&#32;single&#32;one.&#32;Why&#32;not&#32;just&#32;merge&#32;the&#32;&#42;.Configuration&#32;assemblies&#32;into&#32;their&#32;corresponding&#32;assemblies.&#32;&#32;The&#32;reason&#32;that&#32;configuration&#32;is&#32;separate&#32;is&#32;because&#32;the&#32;core&#32;container&#32;is&#32;useful&#32;without&#32;the&#32;config&#32;file&#32;support,&#32;and&#32;there&#32;are&#32;people&#32;who&#32;can&#32;and&#32;will&#32;use&#32;the&#32;container&#32;without&#32;the&#32;configuration&#32;stuff.&#32;As&#32;such,&#32;we&#32;want&#32;to&#32;give&#32;the&#32;option.&#32;ObjectBuilder2&#32;was&#32;originally&#32;separate&#32;because&#32;it&#32;was&#32;believed&#32;that&#32;there&#32;would&#32;be&#32;people&#32;using&#32;it&#32;separately&#32;from&#32;Unity.&#32;That&#32;turned&#32;out&#32;not&#32;to&#32;be&#32;the&#32;case,&#32;so&#32;we&#32;merged&#32;them&#32;to&#32;simplify&#32;deployment.&#32;If&#32;future&#32;customer&#32;feedback&#32;indicates&#32;it&#39;s&#32;not&#32;useful&#32;to&#32;not&#32;have&#32;to&#32;deploy&#32;config,&#32;we&#32;will&#32;merge&#32;it&#32;in.&#32;&#32;The&#32;Unity&#32;Service&#32;Locator&#32;implementation&#32;is&#32;now&#32;in&#32;the&#32;Unity&#32;assembly.&#32;This&#32;requires&#32;a&#32;dependency&#32;to&#32;the&#32;Service&#32;Location&#32;assembly.&#32;Why&#32;not&#32;just&#32;put&#32;it&#32;in&#32;an&#32;own&#32;assembly&#32;like&#32;Microsoft.Practices.Unity.ServiceLocation&#32;or&#32;so.&#32;In&#32;our&#32;project&#32;we&#32;provide&#32;an&#32;own&#32;Service&#32;Locator&#32;interface&#32;and&#32;implementation&#32;with&#32;much&#32;more&#32;functionality&#32;and&#32;now&#32;we&#32;have&#32;to&#32;deploy&#32;another&#32;assembly&#32;&#40;Microsoft.Practices.Unity.ServiceLocation&#41;&#32;as&#32;it&#32;was&#32;before&#32;with&#32;the&#32;Object&#32;Builder&#32;assembly.&#32;&#32;Actually,&#32;you&#32;only&#32;have&#32;to&#32;deploy&#32;Microsoft.Practices.ServiceLocation&#32;if&#32;you&#32;are&#32;actually&#32;using&#32;the&#32;adapter.&#32;If&#32;you&#39;re&#32;not&#32;using&#32;it,&#32;you&#32;don&#39;t&#32;need&#32;the&#32;assembly.&#32;When&#32;you&#32;add&#32;a&#32;reference&#32;Visual&#32;Studio&#32;will&#32;copy&#32;the&#32;ServiceLocation&#32;DLL&#32;automatically,&#32;but&#32;you&#32;don&#39;t&#32;actually&#32;need&#32;it.&#32;You&#32;only&#32;need&#32;to&#32;deploy&#32;that&#32;assembly&#32;if&#32;you&#39;re&#32;going&#32;to&#32;use&#32;it.&#32;Believe&#32;me,&#32;I&#32;very&#32;specifically&#32;tested&#32;this&#32;scenario&#32;-&#32;I&#32;made&#32;sure&#32;you&#32;didn&#39;t&#32;need&#32;the&#32;extra&#32;assembly&#32;unless&#32;it&#32;was&#32;adding&#32;value.&#32;&#32;It&#32;would&#32;be&#32;great&#32;to&#32;have&#32;some&#32;more&#32;overloads&#32;on&#32;the&#32;Injection&#32;factory&#32;that&#32;allows&#32;specifying&#32;a&#32;delegate&#32;without&#32;the&#32;IUnityContainer&#32;or&#32;to&#32;register&#32;a&#32;type&#32;implementing&#32;a&#32;IFactory&#32;interface&#32;or&#32;something&#32;like&#32;that.&#32;&#32;Certainly&#32;up&#32;for&#32;discussion&#32;in&#32;future&#32;versions.&#32;Until&#32;now,&#32;the&#32;only&#32;request&#32;I&#39;ve&#32;gotten&#32;for&#32;was&#32;to&#32;get&#32;the&#32;type&#32;being&#32;resolved&#32;passed&#32;into&#32;the&#32;factory.&#32;&#32;In&#32;Custom&#32;Object&#32;Builder&#32;Strategy&#32;we&#32;must&#32;know&#32;the&#32;Type&#32;that&#32;is&#32;requesting&#32;the&#32;creation&#32;of&#32;the&#32;actual&#32;Type&#32;that&#32;is&#32;being&#32;built&#32;&#40;so&#32;we&#32;can&#32;create&#32;log4net&#32;ILogger&#32;instances&#32;using&#32;the&#32;type&#32;that&#32;has&#32;the&#32;dependency&#32;to&#32;the&#32;ILogger&#41;.&#32;We&#32;have&#32;achieved&#32;this&#32;by&#32;adding&#32;another&#32;Object&#32;Builder&#32;Strategy&#32;that&#32;uses&#32;a&#32;Policy&#32;to&#32;build&#32;a&#32;Stack&#32;of&#32;all&#32;types&#32;that&#32;are&#32;built&#32;during&#32;a&#32;single&#32;build&#32;up&#32;call.&#32;It&#32;would&#32;be&#32;nice&#32;if&#32;some&#32;sort&#32;of&#32;functionality&#32;would&#32;be&#32;supported&#32;directly&#32;by&#32;the&#32;Object&#32;Builder.&#32;&#32;We&#32;could&#32;certainly&#32;add&#32;a&#32;stack&#32;of&#32;build&#32;keys&#32;or&#32;something&#32;along&#32;those&#32;lines,&#32;but&#32;I&#39;d&#32;need&#32;more&#32;information&#32;about&#32;the&#32;scenario&#32;to&#32;make&#32;sure&#32;it&#39;s&#32;actually&#32;solving&#32;the&#32;problem.&#32;Would&#32;be&#32;good&#32;to&#32;discuss&#32;for&#32;future&#32;releases.&#32;&#32;Finally&#32;it&#32;would&#32;be&#32;great&#32;to&#32;have&#32;built&#32;in&#32;some&#32;extension&#32;methods,&#32;like&#32;the&#32;following&#32;ones&#58;&#32;&#32;Overload&#32;to&#32;the&#32;IsRegistered&#32;method&#32;to&#32;query&#32;the&#32;container&#32;if&#32;a&#32;type&#32;is&#32;registered&#32;with&#32;a&#32;given&#32;LifetimeManager.&#32;Some&#32;TryResolve&#32;methods&#32;return&#32;null&#32;instead&#32;of&#32;throwing&#32;an&#32;exception&#32;if&#32;the&#32;requested&#32;type&#32;could&#32;not&#32;be&#32;resolved.&#32;An&#32;IsExtensionConfigured&#32;method&#32;to&#32;ask&#32;the&#32;container&#32;a&#32;given&#32;type&#32;of&#32;Unity&#32;Container&#32;Extension&#32;is&#32;configured.&#32;A&#32;RegisterExtension&#32;method&#32;that&#32;resolves&#32;an&#32;Unity&#32;Container&#32;Extension&#32;trough&#32;the&#32;Unity&#32;Container&#32;and&#32;adds&#32;the&#32;created&#32;instance&#32;of&#32;the&#32;Unity&#32;Container&#32;Extension&#32;to&#32;the&#32;container.&#32;An&#32;EnsureExtension&#32;method&#32;that&#32;returns&#32;a&#32;Unity&#32;Container&#32;Extension&#32;instance&#32;&#40;like&#32;the&#32;Configure&#32;methods&#41;,&#32;but&#32;calls&#32;the&#32;above&#32;RegisterExtension&#32;method&#32;if&#32;it&#32;is&#32;not&#32;already&#32;registered.&#32;&#32;&#32;&#32;All&#32;of&#32;those&#32;are&#32;easily&#32;achieved&#32;now.&#32;IsRegistered&#32;overloads&#32;won&#39;t&#32;happen&#32;from&#32;me&#59;&#32;that&#39;s&#32;what&#32;container.Registrations&#32;&#43;&#32;Linq&#32;is&#32;for&#58;&#32;&#32;container.Registrations.Where&#40;r&#32;&#61;&#38;gt&#59;&#32;r.RegisteredType&#32;&#61;&#61;&#32;typeof&#40;IWhatever&#41;&#32;&#38;amp&#59;&#38;amp&#59;&#32;r.LifetimeManagerType&#32;&#61;&#61;&#32;typeof&#40;MyLifetimeManager&#41;&#41;&#32;&#32;&#32;Or&#32;something&#32;to&#32;that&#32;effect&#32;&#40;don&#39;t&#32;have&#32;the&#32;exact&#32;code&#32;in&#32;front&#32;of&#32;me&#41;.&#32;IsExtensionConfigured&#32;is&#32;similarly&#32;easy&#58;&#32;&#38;nbsp&#59;&#32;&#32;container.Configure&#38;lt&#59;MyExtensionType&#38;gt&#59;&#40;&#41;&#32;&#33;&#61;&#32;null&#32;&#32;&#32;&#38;nbsp&#59;&#32;And&#32;the&#32;other&#32;ideas&#32;are&#32;similarly&#32;simple&#32;to&#32;implement.&#32;I&#39;m&#32;hesitant&#32;to&#32;start&#32;throwing&#32;in&#32;utility&#32;methods&#32;like&#32;this&#32;that&#32;are&#32;outside&#32;the&#32;direct&#32;mainstream&#32;use&#32;cases&#32;without&#32;strong&#32;community&#32;support,&#32;as&#32;they&#39;d&#32;just&#32;clutter&#32;up&#32;the&#32;API&#32;otherwise.&#32;Thanks&#32;for&#32;the&#32;suggestions,&#32;and&#32;keep&#32;them&#32;coming.&#32;There&#39;s&#32;some&#32;good&#32;ideas&#32;here&#32;that&#32;could&#32;very&#32;well&#32;make&#32;it&#32;into&#32;future&#32;versions&#33;&#32;-Chris">
        
<p>Thanks for the suggestions! You're right, it's pretty late in the game at this point, so I don't expect any of these to make it into 2.0. But I'd like to address your points one by one, because I think it's useful:</p>
<ul>
<li>The Unity and Object Builder assemblies have been merged into a single one. Why not just merge the *.Configuration assemblies into their corresponding assemblies.
</li></ul>
<p>The reason that configuration is separate is because the core container is useful without the config file support, and there are people who can and will use the container without the configuration stuff. As such, we want to give the option. ObjectBuilder2
 was originally separate because it was believed that there would be people using it separately from Unity. That turned out not to be the case, so we merged them to simplify deployment. If future customer feedback indicates it's not useful to not have to deploy
 config, we will merge it in.</p>
<ul>
<li>The Unity Service Locator implementation is now in the Unity assembly. This requires a dependency to the Service Location assembly. Why not just put it in an own assembly like Microsoft.Practices.Unity.ServiceLocation or so. In our project we provide an
 own Service Locator interface and implementation with much more functionality and now we have to deploy another assembly (Microsoft.Practices.Unity.ServiceLocation) as it was before with the Object Builder assembly.
</li></ul>
<p>Actually, you only have to deploy Microsoft.Practices.ServiceLocation if you are actually using the adapter. If you're not using it, you don't need the assembly. When you add a reference
<em>Visual Studio</em> will copy the ServiceLocation DLL automatically, but you don't actually need it. You only need to deploy that assembly if you're going to use it. Believe me, I very specifically tested this scenario - I made sure you didn't need the extra
 assembly unless it was adding value.</p>
<ul>
<li>It would be great to have some more overloads on the Injection factory that allows specifying a delegate without the IUnityContainer or to register a type implementing a IFactory interface or something like that.
</li></ul>
<p>Certainly up for discussion in future versions. Until now, the only request I've gotten for was to get the type being resolved passed into the factory.</p>
<ul>
<li>In Custom Object Builder Strategy we must know the Type that is requesting the creation of the actual Type that is being built (so we can create log4net ILogger instances using the type that has the dependency to the ILogger). We have achieved this by adding
 another Object Builder Strategy that uses a Policy to build a Stack of all types that are built during a single build up call. It would be nice if some sort of functionality would be supported directly by the Object Builder.
</li></ul>
<p>We could certainly add a stack of build keys or something along those lines, but I'd need more information about the scenario to make sure it's actually solving the problem. Would be good to discuss for future releases.</p>
<ul>
<li>Finally it would be great to have built in some extension methods, like the following ones:
<ul>
<li>Overload to the IsRegistered method to query the container if a type is registered with a given LifetimeManager.
</li><li>Some TryResolve methods return null instead of throwing an exception if the requested type could not be resolved.
</li><li>An IsExtensionConfigured method to ask the container a given type of Unity Container Extension is configured.
</li><li>A RegisterExtension method that resolves an Unity Container Extension trough the Unity Container and adds the created instance of the Unity Container Extension to the container.
</li><li>An EnsureExtension method that returns a Unity Container Extension instance (like the Configure methods), but calls the above RegisterExtension method if it is not already registered.
</li></ul>
</li></ul>
<p>All of those are easily achieved now. IsRegistered overloads won't happen from me; that's what container.Registrations &#43; Linq is for:</p>
<div style="color:Black; background-color:White">
<pre>container.Registrations.Where(r =&gt; r.RegisteredType == <span style="color:Blue">typeof</span>(IWhatever) &amp;&amp; r.LifetimeManagerType == <span style="color:Blue">typeof</span>(MyLifetimeManager))
</pre>
</div>
<p>Or something to that effect (don't have the exact code in front of me).</p>
<p>IsExtensionConfigured is similarly easy:</p>
<p>&nbsp;</p>
<div style="color:Black; background-color:White">
<pre>container.Configure&lt;MyExtensionType&gt;() != <span style="color:Blue">null</span>
</pre>
</div>
<p>&nbsp;</p>
<p>And the other ideas are similarly simple to implement. I'm hesitant to start throwing in utility methods like this that are outside the direct mainstream use cases without strong community support, as they'd just clutter up the API otherwise.</p>
<p>Thanks for the suggestions, and keep them coming. There's some good ideas here that could very well make it into future versions!</p>
<p>-Chris</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_414429" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="418086">
    <td id="PostDetailsCell_418086" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post418086"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/marcoerni">marcoerni</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="3/15/2010 7:14:59 AM" LocalTimeTicks="1268662499">Mar 15, 2010 at 7:14 AM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="3/15/2010 7:15:28 AM" LocalTimeTicks="1268662528">Mar 15, 2010 at 7:15 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_418086" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Hi&#32;Chris&#32;Thank&#32;you&#32;for&#38;nbsp&#59;your&#32;answer&#32;and&#32;excuse&#32;my&#32;late&#32;reply...&#32;I&#32;have&#32;just&#32;once&#32;more&#32;some&#32;inputs&#32;to&#32;some&#32;of&#32;teh&#32;points&#58;&#32;&#32;&#42;.Configuration&#32;assemblies&#58;&#32;&#32;In&#32;my&#32;opinon,&#32;even&#32;if&#32;the&#32;configuration&#32;stuff&#32;is&#32;merged&#32;into&#32;the&#32;Unity&#32;assembly&#32;I&#32;can&#32;choose&#32;whether&#32;i&#32;want&#32;to&#32;configure&#32;the&#32;container&#32;by&#32;code&#32;or&#32;from&#32;configuration.&#32;It&#32;is&#32;like&#32;in&#32;other&#32;.NET&#32;Framework&#32;parts&#32;such&#32;as&#32;WCF&#32;or&#32;so.&#32;But&#32;it&#39;s&#32;just&#32;a&#38;nbsp&#59;detail.&#32;&#32;Microsoft.Practices.ServiceLocation&#32;assembly&#58;&#32;&#32;It&#32;really&#32;don&#39;t&#32;needs&#32;the&#32;assembly.&#32;I&#32;didn&#39;t&#32;realized&#32;that.&#32;So&#32;its&#32;perfect.&#32;&#32;Stack&#32;of&#32;Build&#32;Key&#39;s&#32;in&#32;Object&#32;Builder&#58;&#32;&#32;A&#32;Stack&#32;of&#32;all&#32;build&#32;key&#39;s&#32;within&#32;the&#32;Object&#32;Builder&#32;Context&#32;is&#32;exactly&#32;what&#32;I&#32;need.&#32;I&#32;need&#32;it&#38;nbsp&#59;for&#32;the&#32;following&#32;scenario&#58;&#32;In&#32;log4net&#32;you&#32;have&#32;an&#32;ILogger&#32;interface.&#32;ILogger&#32;instances&#32;can&#32;be&#32;created&#32;using&#32;the&#32;LoggerManager&#32;class.&#32;For&#32;creating&#32;ILogger&#32;instances&#32;you&#32;can&#32;specifiy&#32;a&#32;Type.&#32;This&#32;Type&#32;is&#32;used&#32;as&#32;the&#32;source&#32;of&#32;the&#32;log&#32;entries&#32;being&#32;written&#32;with&#32;that&#32;ILogger&#32;instance.&#32;So&#32;we&#32;created&#32;a&#32;Object&#32;Builder&#32;Strategy&#32;that&#32;whenever&#32;a&#32;ILogger&#32;is&#32;requested&#32;it&#32;is&#32;created&#32;using&#32;the&#32;LoggerManager.&#32;For&#32;correctly&#32;creating&#32;such&#32;a&#32;logger&#32;we&#32;need&#32;the&#32;Type&#32;that&#32;actualy&#32;is&#32;requesting&#32;the&#32;ILogger&#32;dependency.&#32;So&#32;we&#32;have&#32;created&#32;another&#32;Object&#32;Builder&#32;Strategy&#32;that&#32;tracks&#32;all&#32;Build&#32;Key&#39;s&#32;requested&#32;in&#32;a&#32;Stack&#32;and&#32;stores&#32;it&#32;in&#32;a&#32;custom&#32;transient&#32;policy.&#32;It&#32;currently&#32;works&#32;perfect&#32;for&#32;us.&#32;But&#32;if&#32;we&#32;would&#32;have&#32;built&#32;in&#32;some&#32;kind&#32;of&#32;build&#32;key&#32;stack&#32;directly&#32;in&#32;the&#32;Object&#32;Builders&#32;context,&#32;we&#32;wouldn&#39;t&#32;need&#32;our&#32;&#38;quot&#59;Build&#32;Tracking&#32;Extension&#38;quot&#59;.&#32;Thanks,&#32;and&#32;perhaps&#32;one&#32;of&#32;them&#32;could&#32;made&#32;it&#32;into&#32;Unity&#32;2.x.&#32;Who&#32;knows&#32;...&#32;&#59;-&#41;&#32;Marco&#32;&#38;nbsp&#59;&#32;&#38;nbsp&#59;&#32;&#38;nbsp&#59;">
        
<p>Hi Chris</p>
<p>Thank you for&nbsp;your answer and excuse my late reply...</p>
<p>I have just once more some inputs to some of teh points:</p>
<ul>
<li>*.Configuration assemblies: </li></ul>
<p style="padding-left:30px">In my opinon, even if the configuration stuff is merged into the Unity assembly I can choose whether i want to configure the container by code or from configuration. It is like in other .NET Framework parts such as WCF or so. But
 it's just a&nbsp;detail.</p>
<ul>
<li>Microsoft.Practices.ServiceLocation assembly: </li></ul>
<p style="padding-left:30px">It really don't needs the assembly. I didn't realized that. So its perfect.</p>
<ul>
<li>Stack of Build Key's in Object Builder: </li></ul>
<p style="padding-left:30px">A Stack of all build key's within the Object Builder Context is exactly what I need. I need it&nbsp;for the following scenario:</p>
<p style="padding-left:30px">In log4net you have an ILogger interface. ILogger instances can be created using the LoggerManager class. For creating ILogger instances you can specifiy a Type. This Type is used as the source of the log entries being written with
 that ILogger instance.</p>
<p style="padding-left:30px">So we created a Object Builder Strategy that whenever a ILogger is requested it is created using the LoggerManager. For correctly creating such a logger we need the Type that actualy is requesting the ILogger dependency. So we have
 created another Object Builder Strategy that tracks all Build Key's requested in a Stack and stores it in a custom transient policy. It currently works perfect for us. But if we would have built in some kind of build key stack directly in the Object Builders
 context, we wouldn't need our &quot;Build Tracking Extension&quot;.</p>
<p>Thanks, and perhaps one of them could made it into Unity 2.x. Who knows ... ;-)</p>
<p>Marco</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_418086" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="424648">
    <td id="PostDetailsCell_424648" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post424648"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/ThunderEagle">ThunderEagle</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="3/28/2010 5:09:53 PM" LocalTimeTicks="1269821393">Mar 28, 2010 at 5:09 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_424648" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="marcoerni&#32;wrote&#58;&#32;&#32;Stack&#32;of&#32;Build&#32;Key&#39;s&#32;in&#32;Object&#32;Builder&#58;&#32;&#32;A&#32;Stack&#32;of&#32;all&#32;build&#32;key&#39;s&#32;within&#32;the&#32;Object&#32;Builder&#32;Context&#32;is&#32;exactly&#32;what&#32;I&#32;need.&#32;I&#32;need&#32;it&#38;nbsp&#59;for&#32;the&#32;following&#32;scenario&#58;&#32;In&#32;log4net&#32;you&#32;have&#32;an&#32;ILogger&#32;interface.&#32;ILogger&#32;instances&#32;can&#32;be&#32;created&#32;using&#32;the&#32;LoggerManager&#32;class.&#32;For&#32;creating&#32;ILogger&#32;instances&#32;you&#32;can&#32;specifiy&#32;a&#32;Type.&#32;This&#32;Type&#32;is&#32;used&#32;as&#32;the&#32;source&#32;of&#32;the&#32;log&#32;entries&#32;being&#32;written&#32;with&#32;that&#32;ILogger&#32;instance.&#32;So&#32;we&#32;created&#32;a&#32;Object&#32;Builder&#32;Strategy&#32;that&#32;whenever&#32;a&#32;ILogger&#32;is&#32;requested&#32;it&#32;is&#32;created&#32;using&#32;the&#32;LoggerManager.&#32;For&#32;correctly&#32;creating&#32;such&#32;a&#32;logger&#32;we&#32;need&#32;the&#32;Type&#32;that&#32;actualy&#32;is&#32;requesting&#32;the&#32;ILogger&#32;dependency.&#32;So&#32;we&#32;have&#32;created&#32;another&#32;Object&#32;Builder&#32;Strategy&#32;that&#32;tracks&#32;all&#32;Build&#32;Key&#39;s&#32;requested&#32;in&#32;a&#32;Stack&#32;and&#32;stores&#32;it&#32;in&#32;a&#32;custom&#32;transient&#32;policy.&#32;It&#32;currently&#32;works&#32;perfect&#32;for&#32;us.&#32;But&#32;if&#32;we&#32;would&#32;have&#32;built&#32;in&#32;some&#32;kind&#32;of&#32;build&#32;key&#32;stack&#32;directly&#32;in&#32;the&#32;Object&#32;Builders&#32;context,&#32;we&#32;wouldn&#39;t&#32;need&#32;our&#32;&#38;quot&#59;Build&#32;Tracking&#32;Extension&#38;quot&#59;.&#32;&#32;&#38;nbsp&#59;I&#32;would&#32;be&#32;interested&#32;in&#32;this&#32;as&#32;well.&#38;nbsp&#59;&#32;I&#39;m&#32;the&#32;Architect&#32;on&#32;a&#32;system&#32;that&#32;we&#32;currently&#32;have&#32;in&#32;an&#32;Alpha&#47;Prototype&#32;state.&#38;nbsp&#59;&#32;It&#32;is&#32;the&#32;classic&#32;Big&#32;Ball&#32;of&#32;Mud&#32;in&#32;WinForms.&#38;nbsp&#59;&#32;For&#32;our&#32;Beta&#47;Production&#32;product&#32;we&#32;actaully&#32;have&#32;the&#32;opportunity&#32;to&#32;rewrite&#32;the&#32;application&#32;from&#32;the&#32;ground&#32;up.&#38;nbsp&#59;&#32;It&#32;is&#32;my&#32;intention&#32;to&#32;write&#32;it&#32;using&#32;WPF&#32;with&#32;the&#32;MVVM&#32;pattern&#32;&#40;using&#32;the&#32;Cinch&#32;framework&#41;&#32;and&#32;using&#32;Unity&#32;for&#32;IoC.&#38;nbsp&#59;&#32;The&#32;plan&#32;is&#32;to&#32;use&#32;log4net&#32;for&#32;logging,&#32;as&#32;that&#32;is&#32;what&#32;we&#32;currently&#32;use,&#32;and&#32;I&#32;don&#39;t&#32;see&#32;a&#32;compelling&#32;reason&#32;to&#32;change.&#38;nbsp&#59;&#32;I&#39;m&#32;trying&#32;to&#32;figure&#32;out&#32;how&#32;to&#32;inject&#32;the&#32;ILog&#32;objects&#32;into&#32;our&#32;object&#32;but&#32;still&#32;maintain&#32;the&#32;richness&#32;in&#32;the&#32;log&#32;using&#32;the&#32;Type&#32;requesting&#32;the&#32;logger&#32;from&#32;the&#32;LoggerManager.&#38;nbsp&#59;&#32;I&#32;welcome&#32;any&#32;solution&#32;to&#32;this.&#38;nbsp&#59;&#32;I&#32;really&#32;don&#39;t&#32;want&#32;all&#32;those&#32;static&#32;instances&#32;of&#32;the&#32;logger&#32;in&#32;every&#32;class.&#38;nbsp&#59;&#32;As&#32;an&#32;aside,&#32;I&#39;m&#32;somewhat&#32;interested&#32;in&#32;the&#32;Simple&#32;Logging&#32;Facade&#32;here&#32;on&#32;codeplex&#32;too&#32;that&#32;would&#32;allow&#32;me&#32;to&#32;get&#32;bread&#32;the&#32;dependencey&#32;on&#32;log4net&#32;in&#32;every&#32;project,&#32;but&#32;then&#32;I&#32;just&#32;replace&#32;one&#32;for&#32;another.&#38;nbsp&#59;&#32;I&#32;then&#32;see&#32;how&#32;to&#32;abstract&#32;out&#32;SLF&#32;from&#32;your&#32;project&#32;as&#32;well.&#38;nbsp&#59;&#32;At&#32;what&#32;point&#32;does&#32;the&#32;layers&#32;of&#32;abstraction&#32;become&#32;an&#32;Anti-pattern&#32;itself&#63;&#38;nbsp&#59;&#32;Regardless,&#32;while&#32;I&#32;really&#32;like&#32;some&#32;of&#32;the&#32;functionality&#32;of&#32;SLF,&#32;I&#32;think&#32;I&#39;m&#32;going&#32;to&#32;just&#32;stick&#32;with&#32;calling&#32;log4net&#32;directly&#32;in&#32;my&#32;project.&#32;Marco,&#32;have&#32;you&#32;considered&#32;adding&#32;your&#32;Build&#32;Tracking&#32;Extension&#32;as&#32;a&#32;contrib&#32;to&#32;Unity&#63;&#32;Scott&#32;&#38;nbsp&#59;">
        
<blockquote style="border:solid .1em #ccc; font-style:italic; margin:.25em 1em 0 1em; padding:0 .25em 0 .25em">
<strong>marcoerni wrote:</strong><br>
<ul>
<li>Stack of Build Key's in Object Builder: </li></ul>
<p style="padding-left:30px">A Stack of all build key's within the Object Builder Context is exactly what I need. I need it&nbsp;for the following scenario:</p>
<p style="padding-left:30px">In log4net you have an ILogger interface. ILogger instances can be created using the LoggerManager class. For creating ILogger instances you can specifiy a Type. This Type is used as the source of the log entries being written with
 that ILogger instance.</p>
<p style="padding-left:30px">So we created a Object Builder Strategy that whenever a ILogger is requested it is created using the LoggerManager. For correctly creating such a logger we need the Type that actualy is requesting the ILogger dependency. So we have
 created another Object Builder Strategy that tracks all Build Key's requested in a Stack and stores it in a custom transient policy. It currently works perfect for us. But if we would have built in some kind of build key stack directly in the Object Builders
 context, we wouldn't need our &quot;Build Tracking Extension&quot;.</p>
</blockquote>
<p>&nbsp;I would be interested in this as well.&nbsp; I'm the Architect on a system that we currently have in an Alpha/Prototype state.&nbsp; It is the classic Big Ball of Mud in WinForms.&nbsp; For our Beta/Production product we actaully have the opportunity
 to rewrite the application from the ground up.&nbsp; It is my intention to write it using WPF with the MVVM pattern (using the Cinch framework) and using Unity for IoC.&nbsp; The plan is to use log4net for logging, as that is what we currently use, and I don't
 see a compelling reason to change.&nbsp; I'm trying to figure out how to inject the ILog objects into our object but still maintain the richness in the log using the Type requesting the logger from the LoggerManager.&nbsp; I welcome any solution to this.&nbsp;
 I really don't want all those static instances of the logger in every class.&nbsp;</p>
<p>As an aside, I'm somewhat interested in the Simple Logging Facade here on codeplex too that would allow me to get bread the dependencey on log4net in every project, but then I just replace one for another.&nbsp; I then see how to abstract out SLF from your
 project as well.&nbsp; At what point does the layers of abstraction become an Anti-pattern itself?&nbsp; Regardless, while I really like some of the functionality of SLF, I think I'm going to just stick with calling log4net directly in my project.</p>
<p>Marco, have you considered adding your Build Tracking Extension as a contrib to Unity?</p>
<p>Scott</p>
<p>&nbsp;</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_424648" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="427735">
    <td id="PostDetailsCell_427735" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post427735"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/marcoerni">marcoerni</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="4/6/2010 7:35:54 AM" LocalTimeTicks="1270564554">Apr 6, 2010 at 7:35 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_427735" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Hi&#32;ScottUnfortunately&#32;currently&#32;I&#32;haven&#38;rsquo&#59;t&#32;really&#32;the&#32;time&#32;to&#32;put&#32;all&#32;them&#32;together&#32;in&#32;a&#32;Contrib&#32;project.&#32;But&#32;I&#32;have&#32;just&#32;copied&#32;the&#32;required&#32;class&#32;together&#32;and&#32;will&#32;post&#32;it&#32;here.&#32;Hope&#32;this&#32;helps.The&#32;following&#32;code&#32;shows&#32;the&#32;&#38;lsquo&#59;Build&#32;Tracking&#38;rsquo&#59;&#32;extension&#32;to&#32;track&#32;what&#32;Type&#32;is&#32;requesting&#32;a&#32;given&#32;dependency.&#32;&#32;using&#32;System.Collections.Generic&#59;&#32;using&#32;Microsoft.Practices.ObjectBuilder2&#59;&#32;using&#32;Microsoft.Practices.Unity&#59;&#32;using&#32;Microsoft.Practices.Unity.ObjectBuilder&#59;&#32;namespace&#32;UnityContrib&#32;&#123;&#32;public&#32;class&#32;BuildTracking&#32;&#58;&#32;UnityContainerExtension&#32;&#123;&#32;protected&#32;override&#32;void&#32;Initialize&#40;&#41;&#32;&#123;&#32;this.Context.Strategies.AddNew&#38;lt&#59;BuildTrackingStrategy&#38;gt&#59;&#40;UnityBuildStage.TypeMapping&#41;&#59;&#32;&#125;&#32;public&#32;static&#32;IBuildTrackingPolicy&#32;GetPolicy&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;return&#32;context.Policies.Get&#38;lt&#59;IBuildTrackingPolicy&#38;gt&#59;&#40;context.BuildKey,&#32;true&#41;&#59;&#32;&#125;&#32;public&#32;static&#32;IBuildTrackingPolicy&#32;SetPolicy&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;IBuildTrackingPolicy&#32;policy&#32;&#61;&#32;new&#32;BuildTrackingPolicy&#40;&#41;&#59;&#32;context.Policies.SetDefault&#38;lt&#59;IBuildTrackingPolicy&#38;gt&#59;&#40;policy&#41;&#59;&#32;return&#32;policy&#59;&#32;&#125;&#32;&#125;&#32;public&#32;class&#32;BuildTrackingStrategy&#32;&#58;&#32;BuilderStrategy&#32;&#123;&#32;public&#32;override&#32;void&#32;PreBuildUp&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;IBuildTrackingPolicy&#32;policy&#32;&#61;&#32;BuildTracking.GetPolicy&#40;context&#41;&#59;&#32;if&#32;&#40;policy&#32;&#61;&#61;&#32;null&#41;&#32;&#123;&#32;policy&#32;&#61;&#32;BuildTracking.SetPolicy&#40;context&#41;&#59;&#32;&#125;&#32;policy.BuildKeys.Push&#40;context.BuildKey&#41;&#59;&#32;&#125;&#32;public&#32;override&#32;void&#32;PostBuildUp&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;IBuildTrackingPolicy&#32;policy&#32;&#61;&#32;BuildTracking.GetPolicy&#40;context&#41;&#59;&#32;if&#32;&#40;&#40;policy&#32;&#33;&#61;&#32;null&#41;&#32;&#38;amp&#59;&#38;amp&#59;&#32;&#40;policy.BuildKeys.Count&#32;&#38;gt&#59;&#32;0&#41;&#41;&#32;&#123;&#32;policy.BuildKeys.Pop&#40;&#41;&#59;&#32;&#125;&#32;&#125;&#32;&#125;&#32;public&#32;interface&#32;IBuildTrackingPolicy&#32;&#58;&#32;IBuilderPolicy&#32;&#123;&#32;Stack&#38;lt&#59;object&#38;gt&#59;&#32;BuildKeys&#32;&#123;&#32;get&#59;&#32;&#125;&#32;&#125;&#32;public&#32;class&#32;BuildTrackingPolicy&#32;&#58;&#32;IBuildTrackingPolicy&#32;&#123;&#32;public&#32;BuildTrackingPolicy&#40;&#41;&#32;&#123;&#32;this.BuildKeys&#32;&#61;&#32;new&#32;Stack&#38;lt&#59;object&#38;gt&#59;&#40;&#41;&#59;&#32;&#125;&#32;public&#32;Stack&#38;lt&#59;object&#38;gt&#59;&#32;BuildKeys&#32;&#123;&#32;get&#59;&#32;private&#32;set&#59;&#32;&#125;&#32;&#125;&#32;&#125;&#32;&#32;&#32;And&#32;this&#32;code&#32;shows&#32;how&#32;to&#32;use&#32;the&#32;&#38;lsquo&#59;Build&#32;Tracking&#38;rsquo&#59;&#32;extension&#32;for&#32;creating&#32;log4net&#32;log&#32;objects.&#32;We&#32;are&#32;not&#32;using&#32;log4net&#32;log&#32;objects&#32;directly.&#32;We&#32;have&#32;them&#32;encapsulated&#32;in&#32;ITracer&#32;and&#32;ITracerFactory&#32;interfaces.&#32;But&#32;you&#32;also&#32;can&#32;use&#32;a&#32;library&#32;such&#32;as&#32;the&#32;Common&#32;Logging&#32;or&#32;so.&#32;&#32;using&#32;System&#59;&#32;using&#32;System.Linq&#59;&#32;using&#32;log4net&#59;&#32;using&#32;Microsoft.Practices.ObjectBuilder2&#59;&#32;using&#32;Microsoft.Practices.Unity&#59;&#32;using&#32;Microsoft.Practices.Unity.ObjectBuilder&#59;&#32;namespace&#32;UnityContrib&#32;&#123;&#32;public&#32;class&#32;LogCreation&#32;&#58;&#32;UnityContainerExtension&#32;&#123;&#32;protected&#32;override&#32;void&#32;Initialize&#40;&#41;&#32;&#123;&#32;this.Context.Strategies.AddNew&#38;lt&#59;LogCreationStrategy&#38;gt&#59;&#40;UnityBuildStage.PreCreation&#41;&#59;&#32;&#125;&#32;&#125;&#32;public&#32;class&#32;LogCreationStrategy&#32;&#58;&#32;BuilderStrategy&#32;&#123;&#32;public&#32;bool&#32;IsPolicySet&#32;&#123;&#32;get&#59;&#32;private&#32;set&#59;&#32;&#125;&#32;public&#32;override&#32;void&#32;PreBuildUp&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;Type&#32;typeToBuild&#32;&#61;&#32;BuildKey.GetType&#40;context.BuildKey&#41;&#59;&#32;if&#32;&#40;typeof&#40;ILog&#41;.Equals&#40;typeToBuild&#41;&#41;&#32;&#123;&#32;if&#32;&#40;context.Policies.Get&#38;lt&#59;IBuildPlanPolicy&#38;gt&#59;&#40;context.BuildKey&#41;&#32;&#61;&#61;&#32;null&#41;&#32;&#123;&#32;Type&#32;typeForLog&#32;&#61;&#32;LogCreationStrategy.GetLogType&#40;context&#41;&#59;&#32;IBuildPlanPolicy&#32;policy&#32;&#61;&#32;new&#32;LogBuildPlanPolicy&#40;typeForLog&#41;&#59;&#32;context.Policies.Set&#38;lt&#59;IBuildPlanPolicy&#38;gt&#59;&#40;policy,&#32;context.BuildKey&#41;&#59;&#32;this.IsPolicySet&#32;&#61;&#32;true&#59;&#32;&#125;&#32;&#125;&#32;&#125;&#32;public&#32;override&#32;void&#32;PostBuildUp&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;if&#32;&#40;this.IsPolicySet&#41;&#32;&#123;&#32;context.Policies.Clear&#38;lt&#59;IBuildPlanPolicy&#38;gt&#59;&#40;context.BuildKey&#41;&#59;&#32;this.IsPolicySet&#32;&#61;&#32;false&#59;&#32;&#125;&#32;&#125;&#32;private&#32;static&#32;Type&#32;GetLogType&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;Type&#32;logType&#32;&#61;&#32;typeof&#40;ILog&#41;&#59;&#32;IBuildTrackingPolicy&#32;buildTrackingPolicy&#32;&#61;&#32;BuildTracking.GetPolicy&#40;context&#41;&#59;&#32;if&#32;&#40;&#40;buildTrackingPolicy&#32;&#33;&#61;&#32;null&#41;&#32;&#38;amp&#59;&#38;amp&#59;&#32;&#40;buildTrackingPolicy.BuildKeys.Count&#32;&#38;gt&#59;&#61;&#32;2&#41;&#41;&#32;&#123;&#32;logType&#32;&#61;&#32;BuildKey.GetType&#40;buildTrackingPolicy.BuildKeys.ElementAt&#40;1&#41;&#41;&#59;&#32;&#125;&#32;return&#32;logType&#59;&#32;&#125;&#32;&#125;&#32;public&#32;class&#32;LogBuildPlanPolicy&#32;&#58;&#32;IBuildPlanPolicy&#32;&#123;&#32;public&#32;LogBuildPlanPolicy&#40;Type&#32;logType&#41;&#32;&#123;&#32;this.LogType&#32;&#61;&#32;logType&#59;&#32;&#125;&#32;public&#32;Type&#32;LogType&#32;&#123;&#32;get&#59;&#32;private&#32;set&#59;&#32;&#125;&#32;public&#32;void&#32;BuildUp&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;if&#32;&#40;context.Existing&#32;&#61;&#61;&#32;null&#41;&#32;&#123;&#32;ILog&#32;log&#32;&#61;&#32;LogManager.GetLogger&#40;this.LogType&#41;&#59;&#32;context.Existing&#32;&#61;&#32;log&#59;&#32;&#125;&#32;&#125;&#32;&#125;&#32;&#125;&#32;&#32;&#32;So,&#32;feel&#32;free&#32;to&#32;use&#32;this&#32;code&#32;and&#32;hope&#32;something&#32;similar&#32;as&#32;the&#32;&#38;lsquo&#59;Build&#32;Tracking&#38;rsquo&#59;&#32;extension&#32;will&#32;get&#32;into&#32;Unity&#32;2.1&#32;&#38;hellip&#59;&#32;&#59;&#41;Marco">
        
<p>Hi Scott<br>
Unfortunately currently I haven&rsquo;t really the time to put all them together in a Contrib project. But I have just copied the required class together and will post it here. Hope this helps.<br>
The following code shows the &lsquo;Build Tracking&rsquo; extension to track what Type is requesting a given dependency.</p>
<div style="color:Black; background-color:White">
<pre><span style="color:Blue">using</span> System.Collections.Generic;
<span style="color:Blue">using</span> Microsoft.Practices.ObjectBuilder2;
<span style="color:Blue">using</span> Microsoft.Practices.Unity;
<span style="color:Blue">using</span> Microsoft.Practices.Unity.ObjectBuilder;

<span style="color:Blue">namespace</span> UnityContrib {

    <span style="color:Blue">public</span> <span style="color:Blue">class</span> BuildTracking : UnityContainerExtension {

        <span style="color:Blue">protected</span> <span style="color:Blue">override</span> <span style="color:Blue">void</span> Initialize() {
            <span style="color:Blue">this</span>.Context.Strategies.AddNew&lt;BuildTrackingStrategy&gt;(UnityBuildStage.TypeMapping);
        }

        <span style="color:Blue">public</span> <span style="color:Blue">static</span> IBuildTrackingPolicy GetPolicy(IBuilderContext context) {
            <span style="color:Blue">return</span> context.Policies.Get&lt;IBuildTrackingPolicy&gt;(context.BuildKey, <span style="color:Blue">true</span>);
        }

        <span style="color:Blue">public</span> <span style="color:Blue">static</span> IBuildTrackingPolicy SetPolicy(IBuilderContext context) {
            IBuildTrackingPolicy policy = <span style="color:Blue">new</span> BuildTrackingPolicy();
            context.Policies.SetDefault&lt;IBuildTrackingPolicy&gt;(policy);
            <span style="color:Blue">return</span> policy;
        }
    }

    <span style="color:Blue">public</span> <span style="color:Blue">class</span> BuildTrackingStrategy : BuilderStrategy {

        <span style="color:Blue">public</span> <span style="color:Blue">override</span> <span style="color:Blue">void</span> PreBuildUp(IBuilderContext context) {
            IBuildTrackingPolicy policy = BuildTracking.GetPolicy(context);
            <span style="color:Blue">if</span> (policy == <span style="color:Blue">null</span>) {
                policy = BuildTracking.SetPolicy(context);
            }

            policy.BuildKeys.Push(context.BuildKey);
        }

        <span style="color:Blue">public</span> <span style="color:Blue">override</span> <span style="color:Blue">void</span> PostBuildUp(IBuilderContext context) {
            IBuildTrackingPolicy policy = BuildTracking.GetPolicy(context);
            <span style="color:Blue">if</span> ((policy != <span style="color:Blue">null</span>) &amp;&amp; (policy.BuildKeys.Count &gt; 0)) {
                policy.BuildKeys.Pop();
            }
        }
    }

    <span style="color:Blue">public</span> <span style="color:Blue">interface</span> IBuildTrackingPolicy : IBuilderPolicy {
        Stack&lt;<span style="color:Blue">object</span>&gt; BuildKeys { <span style="color:Blue">get</span>; }
    }

    <span style="color:Blue">public</span> <span style="color:Blue">class</span> BuildTrackingPolicy : IBuildTrackingPolicy {

        <span style="color:Blue">public</span> BuildTrackingPolicy() {
            <span style="color:Blue">this</span>.BuildKeys = <span style="color:Blue">new</span> Stack&lt;<span style="color:Blue">object</span>&gt;();
        }

        <span style="color:Blue">public</span> Stack&lt;<span style="color:Blue">object</span>&gt; BuildKeys { <span style="color:Blue">get</span>; <span style="color:Blue">private</span> <span style="color:Blue">set</span>; }
    }
}

</pre>
</div>
<p>And this code shows how to use the &lsquo;Build Tracking&rsquo; extension for creating log4net log objects. We are not using log4net log objects directly. We have them encapsulated in ITracer and ITracerFactory interfaces. But you also can use a library
 such as the Common Logging or so.</p>
<div style="color:Black; background-color:White">
<pre><span style="color:Blue">using</span> System;
<span style="color:Blue">using</span> System.Linq;
<span style="color:Blue">using</span> log4net;
<span style="color:Blue">using</span> Microsoft.Practices.ObjectBuilder2;
<span style="color:Blue">using</span> Microsoft.Practices.Unity;
<span style="color:Blue">using</span> Microsoft.Practices.Unity.ObjectBuilder;

<span style="color:Blue">namespace</span> UnityContrib {

    <span style="color:Blue">public</span> <span style="color:Blue">class</span> LogCreation : UnityContainerExtension {

        <span style="color:Blue">protected</span> <span style="color:Blue">override</span> <span style="color:Blue">void</span> Initialize() {
            <span style="color:Blue">this</span>.Context.Strategies.AddNew&lt;LogCreationStrategy&gt;(UnityBuildStage.PreCreation);
        }
    }
    <span style="color:Blue">public</span> <span style="color:Blue">class</span> LogCreationStrategy : BuilderStrategy {

        <span style="color:Blue">public</span> <span style="color:Blue">bool</span> IsPolicySet { <span style="color:Blue">get</span>; <span style="color:Blue">private</span> <span style="color:Blue">set</span>; }

        <span style="color:Blue">public</span> <span style="color:Blue">override</span> <span style="color:Blue">void</span> PreBuildUp(IBuilderContext context) {
            Type typeToBuild = BuildKey.GetType(context.BuildKey);
            <span style="color:Blue">if</span> (<span style="color:Blue">typeof</span>(ILog).Equals(typeToBuild)) {

                <span style="color:Blue">if</span> (context.Policies.Get&lt;IBuildPlanPolicy&gt;(context.BuildKey) == <span style="color:Blue">null</span>) {
                    Type typeForLog = LogCreationStrategy.GetLogType(context);
                    IBuildPlanPolicy policy = <span style="color:Blue">new</span> LogBuildPlanPolicy(typeForLog);
                    context.Policies.Set&lt;IBuildPlanPolicy&gt;(policy, context.BuildKey);

                    <span style="color:Blue">this</span>.IsPolicySet = <span style="color:Blue">true</span>;
                }
            }
        }

        <span style="color:Blue">public</span> <span style="color:Blue">override</span> <span style="color:Blue">void</span> PostBuildUp(IBuilderContext context) {
            <span style="color:Blue">if</span> (<span style="color:Blue">this</span>.IsPolicySet) {
                context.Policies.Clear&lt;IBuildPlanPolicy&gt;(context.BuildKey);
                <span style="color:Blue">this</span>.IsPolicySet = <span style="color:Blue">false</span>;
            }
        }

        <span style="color:Blue">private</span> <span style="color:Blue">static</span> Type GetLogType(IBuilderContext context) {

            Type logType = <span style="color:Blue">typeof</span>(ILog);

            IBuildTrackingPolicy buildTrackingPolicy = BuildTracking.GetPolicy(context);
            <span style="color:Blue">if</span> ((buildTrackingPolicy != <span style="color:Blue">null</span>) &amp;&amp; (buildTrackingPolicy.BuildKeys.Count &gt;= 2)) {
                logType = BuildKey.GetType(buildTrackingPolicy.BuildKeys.ElementAt(1));
            }

            <span style="color:Blue">return</span> logType;
        }
    }

    <span style="color:Blue">public</span> <span style="color:Blue">class</span> LogBuildPlanPolicy : IBuildPlanPolicy {

        <span style="color:Blue">public</span> LogBuildPlanPolicy(Type logType) {
            <span style="color:Blue">this</span>.LogType = logType;
        }

        <span style="color:Blue">public</span> Type LogType { <span style="color:Blue">get</span>; <span style="color:Blue">private</span> <span style="color:Blue">set</span>; }

        <span style="color:Blue">public</span> <span style="color:Blue">void</span> BuildUp(IBuilderContext context) {
            <span style="color:Blue">if</span> (context.Existing == <span style="color:Blue">null</span>) {
                ILog log = LogManager.GetLogger(<span style="color:Blue">this</span>.LogType);
                context.Existing = log;
            }
        }
    }

}

</pre>
</div>
<p>So, feel free to use this code and hope something similar as the &lsquo;Build Tracking&rsquo; extension will get into Unity 2.1 &hellip; ;)<br>
Marco</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_427735" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="427746">
    <td id="PostDetailsCell_427746" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post427746"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/ThunderEagle">ThunderEagle</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="4/6/2010 8:01:28 AM" LocalTimeTicks="1270566088">Apr 6, 2010 at 8:01 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_427746" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Thanks&#32;a&#32;lot&#32;Marco&#33;&#38;nbsp&#59;&#32;I&#39;m&#32;sure&#32;myself&#32;and&#32;several&#32;others&#32;will&#32;make&#32;good&#32;use&#32;of&#32;the&#32;code&#32;you&#32;posted&#33;">
        
<p>Thanks a lot Marco!&nbsp; I'm sure myself and several others will make good use of the code you posted!</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_427746" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="429298">
    <td id="PostDetailsCell_429298" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post429298"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/ThunderEagle">ThunderEagle</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="4/9/2010 3:12:39 PM" LocalTimeTicks="1270851159">Apr 9, 2010 at 3:12 PM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="4/9/2010 3:13:55 PM" LocalTimeTicks="1270851235">Apr 9, 2010 at 3:13 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_429298" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Ok,&#32;a&#32;couple&#32;of&#32;tweaks&#32;I&#39;ve&#32;made&#32;to&#32;Marco&#39;s&#32;code&#32;if&#32;anyone&#32;is&#32;interested.&#32;First,&#32;the&#32;BuildKey&#32;static&#32;class&#32;no&#32;longer&#32;exists&#32;as&#32;of&#32;Beta&#32;2,&#32;but&#32;a&#32;Type&#32;property&#32;has&#32;been&#32;added&#32;to&#32;the&#32;BuildKey&#32;propery&#32;hanging&#32;off&#32;of&#32;the&#32;context.&#32;In&#32;the&#32;LogCreation&#32;class&#32;above&#32;change&#32;this&#32;line&#32;of&#32;PreBuild&#32;up&#32;&#32;Type&#32;typeToBuild&#32;&#61;&#32;BuildKey.GetType&#40;context.BuildKey&#41;&#59;&#32;&#32;&#32;to&#32;Type&#32;typeToBuild&#32;&#61;&#32;context.BuildKey.Type&#59;&#32;&#38;nbsp&#59;&#32;In&#32;the&#32;GetLogType&#32;method&#32;of&#32;the&#32;same&#32;class,&#32;change&#32;this&#32;line&#58;&#32;&#32;logType&#32;&#61;&#32;BuildKey.GetType&#40;buildTrackingPolicy.BuildKeys.ElementAt&#40;1&#41;&#41;&#59;&#32;&#32;&#32;to&#58;&#32;&#32;logType&#32;&#61;&#32;&#40;&#40;NamedTypeBuildKey&#41;buildTrackingPolicy.BuildKeys.ElementAt&#40;1&#41;&#41;.Type&#59;&#32;&#32;&#32;&#38;nbsp&#59;&#32;I&#39;ve&#32;also&#32;added&#32;a&#32;tweak&#32;to&#32;walk&#32;up&#32;the&#32;stackframe&#32;to&#32;get&#32;propper&#32;logging&#32;identification&#32;when&#32;the&#32;ILog&#32;is&#32;not&#32;resolved&#32;as&#32;part&#32;of&#32;dependency&#32;injection,&#32;but&#32;directly&#32;through&#32;a&#32;container.Resolve&#38;lt&#59;ILog&#38;gt&#59;&#40;&#41;&#59;&#32;call&#58;&#38;nbsp&#59;&#32;I&#32;changed&#32;the&#32;GetLogType&#32;method&#32;to&#58;&#32;&#32;private&#32;static&#32;Type&#32;GetLogType&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;Type&#32;logType&#32;&#61;&#32;typeof&#40;ILog&#41;&#59;&#32;IBuildTrackingPolicy&#32;buildTrackingPolicy&#32;&#61;&#32;BuildTracking.GetPolicy&#40;context&#41;&#59;&#32;if&#32;&#40;&#40;buildTrackingPolicy&#32;&#33;&#61;&#32;null&#41;&#32;&#38;amp&#59;&#38;amp&#59;&#32;&#40;buildTrackingPolicy.BuildKeys.Count&#32;&#38;gt&#59;&#61;&#32;2&#41;&#41;&#32;&#123;&#32;logType&#32;&#61;&#32;&#40;&#40;NamedTypeBuildKey&#41;buildTrackingPolicy.BuildKeys.ElementAt&#40;1&#41;&#41;.Type&#59;&#32;&#125;&#32;else&#32;&#123;&#32;StackTrace&#32;stackTrace&#32;&#61;&#32;new&#32;StackTrace&#40;&#41;&#59;&#32;&#47;&#47;first&#32;two&#32;are&#32;in&#32;the&#32;log&#32;creation&#32;strategy,&#32;can&#32;skip&#32;over&#32;them&#32;for&#32;&#40;int&#32;i&#32;&#61;&#32;2&#59;&#32;i&#32;&#38;lt&#59;&#32;stackTrace.FrameCount&#59;&#32;i&#43;&#43;&#41;&#32;&#123;&#32;StackFrame&#32;frame&#32;&#61;&#32;stackTrace.GetFrame&#40;i&#41;&#59;&#32;logType&#32;&#61;&#32;frame.GetMethod&#40;&#41;.DeclaringType&#59;&#32;&#47;&#47;Console.WriteLine&#40;logType.FullName&#41;&#59;&#32;if&#32;&#40;&#33;logType.FullName.StartsWith&#40;&#38;quot&#59;Microsoft.Practices&#38;quot&#59;&#41;&#41;&#32;&#123;&#32;break&#59;&#32;&#125;&#32;&#125;&#32;&#125;&#32;return&#32;logType&#59;&#32;&#125;&#32;&#32;I&#39;m&#32;sure&#32;I&#32;can&#32;probably&#32;skip&#32;over&#32;more&#32;than&#32;just&#32;the&#32;first&#32;2&#32;frames,&#32;but&#32;I&#32;didn&#39;t&#32;want&#32;to&#32;get&#32;carried&#32;away,&#32;&#32;and&#32;that&#32;gets&#32;me&#32;into&#32;the&#32;Microsoft.Practices&#32;namespaces&#32;witches&#32;makes&#32;my&#32;condition&#32;easier.&#32;&#58;&#41;&#32;&#32;I&#32;do&#32;wonder&#32;if&#32;that&#32;can&#32;be&#32;made&#32;more&#32;efficient.&#32;&#32;">
        
<p>Ok, a couple of tweaks I've made to Marco's code if anyone is interested.</p>
<p>First, the BuildKey static class no longer exists as of Beta 2, but a Type property has been added to the BuildKey propery hanging off of the context.</p>
<p>In the LogCreation class above change this line of PreBuild up</p>
<div style="color:Black; background-color:White">
<pre>Type typeToBuild = BuildKey.GetType(context.BuildKey);
</pre>
</div>
<p>to</p>
<pre>Type typeToBuild = context.BuildKey.Type;</pre>
<p>&nbsp;</p>
<p>In the GetLogType method of the same class, change this line:</p>
<div style="color:Black; background-color:White">
<pre>logType = BuildKey.GetType(buildTrackingPolicy.BuildKeys.ElementAt(1));
</pre>
</div>
<p>to:</p>
<div style="color:Black; background-color:White">
<pre>logType = ((NamedTypeBuildKey)buildTrackingPolicy.BuildKeys.ElementAt(1)).Type;
</pre>
</div>
<p>&nbsp;</p>
<p>I've also added a tweak to walk up the stackframe to get propper logging identification when the ILog is not resolved as part of dependency injection, but directly through a container.Resolve&lt;ILog&gt;(); call:&nbsp; I changed the GetLogType method to:</p>
<div style="color:Black; background-color:White">
<pre><span style="color:Blue">private</span> <span style="color:Blue">static</span> Type GetLogType(IBuilderContext context) {
	Type logType = <span style="color:Blue">typeof</span>(ILog);
	IBuildTrackingPolicy buildTrackingPolicy = BuildTracking.GetPolicy(context);
	<span style="color:Blue">if</span> ((buildTrackingPolicy != <span style="color:Blue">null</span>) &amp;&amp; (buildTrackingPolicy.BuildKeys.Count &gt;= 2)) {
		logType = ((NamedTypeBuildKey)buildTrackingPolicy.BuildKeys.ElementAt(1)).Type;
	}
	<span style="color:Blue">else</span> {
		StackTrace stackTrace = <span style="color:Blue">new</span> StackTrace();
		<span style="color:Green">//first two are in the log creation strategy, can skip over them</span>
		<span style="color:Blue">for</span> (<span style="color:Blue">int</span> i = 2; i &lt; stackTrace.FrameCount; i&#43;&#43;) {
			StackFrame frame = stackTrace.GetFrame(i);
			logType = frame.GetMethod().DeclaringType;
			<span style="color:Green">//Console.WriteLine(logType.FullName);</span>
			<span style="color:Blue">if</span> (!logType.FullName.StartsWith(<span style="color:#A31515">&quot;Microsoft.Practices&quot;</span>)) {
				<span style="color:Blue">break</span>;
			}
		}
	}
	<span style="color:Blue">return</span> logType;
}
</pre>
<pre><pre>I'm sure I can probably skip over more than just the first 2 frames, but I didn't want to get carried away, </pre>
<pre>and that gets me into the Microsoft.Practices namespaces witches makes my condition easier. :)  </pre>
<pre>I do wonder if that can be made more efficient.</pre>
</pre>
</div>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_429298" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="584086">
    <td id="PostDetailsCell_584086" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post584086"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/CtrlAltDel">CtrlAltDel</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="3/22/2011 12:17:29 AM" LocalTimeTicks="1300778249">Mar 22, 2011 at 12:17 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_584086" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Hi&#32;Marco&#32;and&#32;Scott,&#32;Thank&#32;you&#32;very&#32;much&#32;for&#32;posting&#32;this&#32;code&#32;-&#32;I&#39;ve&#32;seen&#32;lots&#32;questions&#32;asked&#32;about&#32;how&#32;to&#32;use&#32;log4net&#32;properly&#32;with&#32;Unity&#59;&#32;up&#32;until&#32;now,&#32;I&#39;ve&#32;had&#32;to&#32;put&#32;up&#32;with&#32;the&#32;standard&#32;use&#32;of&#32;an&#32;injection&#32;factory&#32;to&#32;create&#32;my&#32;instances,&#32;which&#32;then&#32;pick&#32;up&#32;the&#32;type&#32;of&#32;the&#32;class&#32;they&#32;were&#32;instantiated&#32;in,&#32;rather&#32;than&#32;where&#32;they&#32;are&#32;being&#32;used.&#32;Your&#32;code&#32;fixes&#32;all&#32;of&#32;that,&#32;and&#32;removes&#32;the&#32;need&#32;for&#32;me&#32;to&#32;explicitly&#32;register&#32;ILog.&#32;For&#32;the&#32;sake&#32;of&#32;completeness,&#32;here&#39;s&#32;the&#32;code&#32;to&#32;actually&#32;use&#32;log4net&#32;with&#32;the&#32;above&#32;extensions.&#32;&#32;&#32;public&#32;class&#32;Program&#32;&#123;&#32;public&#32;static&#32;void&#32;Main&#40;string&#91;&#93;&#32;args&#41;&#32;&#123;&#32;UnityContainer&#32;container&#32;&#61;&#32;new&#32;UnityContainer&#40;&#41;&#59;&#32;container&#32;.AddNewExtension&#38;lt&#59;BuildTracking&#38;gt&#59;&#40;&#41;&#32;.AddNewExtension&#38;lt&#59;LogCreation&#38;gt&#59;&#40;&#41;&#59;&#32;&#47;&#47;&#32;register&#32;your&#32;other&#32;types&#32;here&#32;ILog&#32;logger&#32;&#61;&#32;container.Resolve&#38;lt&#59;ILog&#38;gt&#59;&#40;&#41;&#59;&#32;var&#32;myCode&#32;&#61;&#32;new&#32;MyClassWithLoggerDependency&#40;logger&#41;&#59;&#32;myCode.DoStuff&#40;&#41;&#59;&#32;&#125;&#32;&#125;&#32;&#32;&#32;&#32;Any&#32;logging&#32;which&#32;occurs&#32;inside&#32;MyClassWithLoggerDependency&#32;will&#32;now&#32;log&#32;with&#32;the&#32;context&#32;of&#32;that&#32;class,&#32;rather&#32;than&#32;that&#32;of&#32;Program.&#32;As&#32;Marco&#32;says,&#32;hopefully&#32;something&#32;like&#32;this&#32;will&#32;make&#32;it&#32;into&#32;the&#32;next&#32;release&#32;of&#32;Unity.&#32;Again,&#32;many&#32;thanks,&#32;guys&#33;">
        
<p>Hi Marco and Scott,</p>
<p>Thank you very much for posting this code - I've seen lots questions asked about how to use log4net properly with Unity; up until now, I've had to put up with the standard use of an injection factory to create my instances, which then pick up the type of
 the class they were instantiated in, rather than where they are being used. Your code fixes all of that, and removes the need for me to explicitly register ILog.</p>
<p>For the sake of completeness, here's the code to actually use log4net with the above extensions.</p>
<p></p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">public</span> <span style="color:blue">class</span> Program
{
	<span style="color:blue">public</span> <span style="color:blue">static</span> <span style="color:blue">void</span> Main(<span style="color:blue">string</span>[] args)
	{
		UnityContainer container = <span style="color:blue">new</span> UnityContainer();
		container
			.AddNewExtension&lt;BuildTracking&gt;()
			.AddNewExtension&lt;LogCreation&gt;();

		<span style="color:green">// register your other types here</span>

		ILog logger = container.Resolve&lt;ILog&gt;();
		<span style="color:blue">var</span> myCode = <span style="color:blue">new</span> MyClassWithLoggerDependency(logger);
		myCode.DoStuff();
	}
}
</pre>
</div>
<p></p>
<p>Any logging which occurs inside MyClassWithLoggerDependency will now log with the context of that class, rather than that of Program. As Marco says, hopefully something like this will make it into the next release of Unity.</p>
<p>Again, many thanks, guys!</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_584086" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="834894">
    <td id="PostDetailsCell_834894" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post834894"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SCDeveloper">SCDeveloper</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/11/2012 1:22:16 AM" LocalTimeTicks="1336724536">May 11, 2012 at 1:22 AM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="5/11/2012 1:56:13 AM" LocalTimeTicks="1336726573">May 11, 2012 at 1:56 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_834894" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Hello&#32;fellow&#32;coders,&#32;I&#32;found&#32;this&#32;solution&#32;to&#32;be&#32;exactly&#32;what&#32;I&#32;was&#32;looking&#32;for.&#32;I&#32;just&#32;wanted&#32;to&#32;take&#32;this&#32;solution&#32;one&#32;step&#32;further.&#32;The&#32;problem&#32;I&#32;saw&#32;was&#32;that&#32;the&#32;LogCreation&#32;implementation&#32;as&#32;presented&#32;is&#32;strictly&#32;tied&#32;to&#32;the&#32;log4Net&#32;framework.&#32;I&#32;have&#32;not&#32;used&#32;many&#32;other&#32;logging&#32;frameworks,&#32;but&#32;I&#32;would&#32;conjecture&#32;that&#32;I&#32;might&#32;want&#32;to&#32;switch&#32;to&#32;another&#32;framework&#32;at&#32;some&#32;point,&#32;I&#32;would&#32;like&#32;to&#32;on&#32;visit&#32;a&#32;very&#32;small&#32;amount&#32;and&#32;very&#32;focused&#32;piece&#32;of&#32;code&#32;the&#32;make&#32;the&#32;switch.&#32;So,&#32;I&#32;set&#32;out&#32;to&#32;adapt&#32;the&#32;LogCreation&#32;implementation&#32;to&#32;be&#32;generic&#32;for&#32;any&#32;Logging&#32;facility.&#32;Thus,&#32;I&#32;made&#32;a&#32;generic&#32;parameter&#32;for&#32;the&#32;Logger&#32;interface,&#32;and&#32;provided&#32;an&#32;interface&#32;to&#32;extract&#32;the&#32;creation&#32;of&#32;the&#32;logger&#32;from&#32;this&#32;implementation.&#32;I&#39;ll&#32;just&#32;present&#32;the&#32;finished&#32;product,&#32;which&#32;includes&#32;the&#32;edits&#32;provided&#32;previously&#32;by&#32;ThunderEagle.&#32;&#38;nbsp&#59;&#32;using&#32;System&#59;&#32;using&#32;System.Diagnostics&#59;&#32;using&#32;System.Linq&#59;&#32;using&#32;Microsoft.Practices.ObjectBuilder2&#59;&#32;using&#32;Microsoft.Practices.Unity&#59;&#32;using&#32;Microsoft.Practices.Unity.ObjectBuilder&#59;&#32;namespace&#32;UnityContrib&#32;&#123;&#32;&#47;&#47;&#47;&#32;&#47;&#47;&#47;&#32;This&#32;class&#32;decouples&#32;the&#32;following&#32;classes&#32;from&#32;any&#32;specific&#32;logging&#32;framework.&#32;&#47;&#47;&#47;&#32;public&#32;interface&#32;ILogFactory&#32;&#123;&#32;&#47;&#47;&#47;&#32;&#47;&#47;&#47;&#32;This&#32;method&#32;must&#32;return&#32;an&#32;instance&#32;of&#32;a&#32;Logger.&#32;&#47;&#47;&#47;&#32;&#47;&#47;&#47;&#32;The&#32;type&#32;of&#32;the&#32;class&#32;that&#32;is&#32;using&#32;the&#32;logger.&#32;&#47;&#47;&#47;&#32;An&#32;instance&#32;of&#32;a&#32;logger.&#32;object&#32;GetLogger&#40;Type&#32;parentType&#41;&#59;&#32;&#125;&#32;public&#32;class&#32;LogCreation&#38;lt&#59;T,U&#38;gt&#59;&#32;&#58;&#32;UnityContainerExtension&#32;where&#32;U&#32;&#58;&#32;ILogFactory,&#32;new&#40;&#41;&#32;&#123;&#32;protected&#32;override&#32;void&#32;Initialize&#40;&#41;&#32;&#123;&#32;this.Context.Strategies.AddNew&#38;gt&#59;&#40;UnityBuildStage.PreCreation&#41;&#59;&#32;&#125;&#32;&#125;&#32;public&#32;class&#32;LogCreationStrategy&#38;lt&#59;T,U&#38;gt&#59;&#32;&#58;&#32;BuilderStrategy&#32;where&#32;U&#32;&#58;&#32;ILogFactory,&#32;new&#40;&#41;&#32;&#123;&#32;public&#32;bool&#32;IsPolicySet&#32;&#123;&#32;get&#59;&#32;private&#32;set&#59;&#32;&#125;&#32;public&#32;override&#32;void&#32;PreBuildUp&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;Type&#32;typeToBuild&#32;&#61;&#32;context.BuildKey.Type&#59;&#32;if&#32;&#40;typeof&#40;T&#41;.Equals&#40;typeToBuild&#41;&#41;&#32;&#123;&#32;if&#32;&#40;context.Policies.Get&#40;context.BuildKey&#41;&#32;&#61;&#61;&#32;null&#41;&#32;&#123;&#32;Type&#32;typeForLog&#32;&#61;&#32;LogCreationStrategy.GetLogType&#40;context&#41;&#59;&#32;ILogFactory&#32;factory&#32;&#61;&#32;new&#32;U&#40;&#41;&#59;&#32;IBuildPlanPolicy&#32;policy&#32;&#61;&#32;new&#32;LogBuildPlanPolicy&#40;typeForLog,&#32;factory&#41;&#59;&#32;context.Policies.Set&#40;policy,&#32;context.BuildKey&#41;&#59;&#32;this.IsPolicySet&#32;&#61;&#32;true&#59;&#32;&#125;&#32;&#125;&#32;&#125;&#32;public&#32;override&#32;void&#32;PostBuildUp&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;if&#32;&#40;this.IsPolicySet&#41;&#32;&#123;&#32;context.Policies.Clear&#40;context.BuildKey&#41;&#59;&#32;this.IsPolicySet&#32;&#61;&#32;false&#59;&#32;&#125;&#32;&#125;&#32;private&#32;static&#32;Type&#32;GetLogType&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;Type&#32;logType&#32;&#61;&#32;typeof&#40;T&#41;&#59;&#32;IBuildTrackingPolicy&#32;buildTrackingPolicy&#32;&#61;&#32;BuildTracking.GetPolicy&#40;context&#41;&#59;&#32;if&#32;&#40;&#40;buildTrackingPolicy&#32;&#33;&#61;&#32;null&#41;&#32;&#38;amp&#59;&#38;amp&#59;&#32;&#40;buildTrackingPolicy.BuildKeys.Count&#32;&#38;gt&#59;&#61;&#32;2&#41;&#41;&#32;&#123;&#32;logType&#32;&#61;&#32;&#40;&#40;NamedTypeBuildKey&#41;buildTrackingPolicy.BuildKeys.ElementAt&#40;1&#41;&#41;.Type&#59;&#32;&#125;&#32;else&#32;&#123;&#32;StackTrace&#32;stackTrace&#32;&#61;&#32;new&#32;StackTrace&#40;&#41;&#59;&#32;&#47;&#47;first&#32;two&#32;are&#32;in&#32;the&#32;log&#32;creation&#32;strategy,&#32;can&#32;skip&#32;over&#32;them&#32;for&#32;&#40;int&#32;i&#32;&#61;&#32;2&#59;&#32;i&#32;&#38;lt&#59;&#32;stackTrace.FrameCount&#59;&#32;i&#43;&#43;&#41;&#32;&#123;&#32;StackFrame&#32;frame&#32;&#61;&#32;stackTrace.GetFrame&#40;i&#41;&#59;&#32;logType&#32;&#61;&#32;frame.GetMethod&#40;&#41;.DeclaringType&#59;&#32;&#47;&#47;Console.WriteLine&#40;logType.FullName&#41;&#59;&#32;if&#32;&#40;&#33;logType.FullName.StartsWith&#40;&#34;Microsoft.Practices&#34;&#41;&#41;&#32;&#123;&#32;break&#59;&#32;&#125;&#32;&#125;&#32;&#125;&#32;return&#32;logType&#59;&#32;&#125;&#32;&#125;&#32;public&#32;class&#32;LogBuildPlanPolicy&#32;&#58;&#32;IBuildPlanPolicy&#32;&#123;&#32;private&#32;ILogFactory&#32;logFactory&#59;&#32;public&#32;LogBuildPlanPolicy&#40;Type&#32;logType,&#32;ILogFactory&#32;factory&#41;&#32;&#123;&#32;this.LogType&#32;&#61;&#32;logType&#59;&#32;logFactory&#32;&#61;&#32;factory&#59;&#32;&#125;&#32;public&#32;Type&#32;LogType&#32;&#123;&#32;get&#59;&#32;private&#32;set&#59;&#32;&#125;&#32;public&#32;void&#32;BuildUp&#40;IBuilderContext&#32;context&#41;&#32;&#123;&#32;if&#32;&#40;context.Existing&#32;&#61;&#61;&#32;null&#41;&#32;&#123;&#32;context.Existing&#32;&#61;&#32;logFactory.GetLogger&#40;this.LogType&#41;&#59;&#32;&#125;&#32;&#125;&#32;&#125;&#32;&#125;&#32;&#32;&#38;nbsp&#59;&#32;This&#32;would&#32;make&#32;the&#32;usage&#32;&#40;from&#32;CtrlAltDel&#41;&#32;look&#32;like&#32;this...&#32;&#38;nbsp&#59;&#32;&#32;using&#32;log4net&#59;&#32;public&#32;class&#32;Program&#32;&#123;&#32;internal&#32;class&#32;Log4NetFactory&#32;&#58;&#32;UnityContrib.ILogFactory&#32;&#123;&#32;public&#32;object&#32;GetLogger&#40;Type&#32;parentType&#41;&#32;&#123;&#32;return&#32;LogManager.GetLogger&#40;parentType&#41;&#59;&#32;&#125;&#32;&#125;&#32;public&#32;static&#32;void&#32;Main&#40;string&#91;&#93;&#32;args&#41;&#32;&#123;&#32;UnityContainer&#32;container&#32;&#61;&#32;new&#32;UnityContainer&#40;&#41;&#59;&#32;container&#32;.AddNewExtension&#38;lt&#59;BuildTracking&#38;gt&#59;&#40;&#41;&#32;.AddNewExtension&#38;lt&#59;LogCreation&#38;lt&#59;ILog,Log4NetFactory&#38;gt&#59;&#40;&#41;&#59;&#32;&#47;&#47;&#32;register&#32;your&#32;other&#32;types&#32;here&#32;ILog&#32;logger&#32;&#61;&#32;container.Resolve&#38;lt&#59;ILog&#38;gt&#59;&#40;&#41;&#59;&#32;var&#32;myCode&#32;&#61;&#32;new&#32;MyClassWithLoggerDependency&#40;logger&#41;&#59;&#32;myCode.DoStuff&#40;&#41;&#59;&#32;&#125;&#32;&#125;&#32;&#32;&#32;&#38;nbsp&#59;&#32;Thanks&#32;for&#32;your&#32;contributions.">
        
<p>Hello fellow coders,</p>
<p>I found this solution to be exactly what I was looking for. I just wanted to take this solution one step further. The problem I saw was that the LogCreation implementation as presented is strictly tied to the log4Net framework. I have not used many other
 logging frameworks, but I would conjecture that I might want to switch to another framework at some point, I would like to on visit a very small amount and very focused piece of code the make the switch. So, I set out to adapt the LogCreation implementation
 to be generic for any Logging facility. Thus, I made a generic parameter for the Logger interface, and provided an interface to extract the creation of the logger from this implementation.</p>
<p>I'll just present the finished product, which includes the edits provided previously by ThunderEagle.</p>
<p>&nbsp;</p>
<pre>using System;
using System.Diagnostics;
using System.Linq;
using Microsoft.Practices.ObjectBuilder2;
using Microsoft.Practices.Unity;
using Microsoft.Practices.Unity.ObjectBuilder;

namespace UnityContrib
{
    /// 
    /// This class decouples the following classes from any specific logging framework.
    /// 
    public interface ILogFactory
    {
        /// 
        /// This method must return an instance of a Logger.
        /// 
        /// The type of the class that is using the logger.
        /// An instance of a logger.
        object GetLogger(Type parentType);
    }

    public class LogCreation&lt;T,U&gt; : UnityContainerExtension where U : ILogFactory, new() {

        protected override void Initialize() {
            this.Context.Strategies.AddNew&gt;(UnityBuildStage.PreCreation);
        }
    }
    public class LogCreationStrategy&lt;T,U&gt; : BuilderStrategy where U : ILogFactory, new() 
    {

        public bool IsPolicySet { get; private set; }

        public override void PreBuildUp(IBuilderContext context) {
            Type typeToBuild = context.BuildKey.Type;
            if (typeof(T).Equals(typeToBuild)) {

                if (context.Policies.Get(context.BuildKey) == null) {
                    Type typeForLog = LogCreationStrategy.GetLogType(context);
                    ILogFactory factory = new U();
                    IBuildPlanPolicy policy = new LogBuildPlanPolicy(typeForLog, factory);
                    context.Policies.Set(policy, context.BuildKey);

                    this.IsPolicySet = true;
                }
            }
        }

        public override void PostBuildUp(IBuilderContext context) {
            if (this.IsPolicySet) {
                context.Policies.Clear(context.BuildKey);
                this.IsPolicySet = false;
            }
        }

        private static Type GetLogType(IBuilderContext context) {

            Type logType = typeof(T);

            IBuildTrackingPolicy buildTrackingPolicy = BuildTracking.GetPolicy(context);
            if ((buildTrackingPolicy != null) &amp;&amp; (buildTrackingPolicy.BuildKeys.Count &gt;= 2)) {
                logType = ((NamedTypeBuildKey)buildTrackingPolicy.BuildKeys.ElementAt(1)).Type;
            }
            else
            {
                StackTrace stackTrace = new StackTrace();
                //first two are in the log creation strategy, can skip over them
                for (int i = 2; i &lt; stackTrace.FrameCount; i&#43;&#43;)
                {
                    StackFrame frame = stackTrace.GetFrame(i);
                    logType = frame.GetMethod().DeclaringType;
                    //Console.WriteLine(logType.FullName);
                    if (!logType.FullName.StartsWith(&quot;Microsoft.Practices&quot;))
                    {
                        break;
                    }
                }
            }

            return logType;
        }
    }

    public class LogBuildPlanPolicy : IBuildPlanPolicy {

        private ILogFactory logFactory;
        public LogBuildPlanPolicy(Type logType, ILogFactory factory) {
            this.LogType = logType;
            logFactory = factory;
        }

        public Type LogType { get; private set; }

        public void BuildUp(IBuilderContext context) {
            if (context.Existing == null) {
                context.Existing = logFactory.GetLogger(this.LogType);
            }
        }
    }

}
</pre>
<p>&nbsp;</p>
<p>This would make the usage (from CtrlAltDel) look like this...</p>
<p>&nbsp;</p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">using</span> log4net;

<span style="color:blue">public</span> <span style="color:blue">class</span> Program
{
       <span style="color:blue">internal</span> <span style="color:blue">class</span> Log4NetFactory : UnityContrib.ILogFactory
       {
                <span style="color:blue">public</span> <span style="color:blue">object</span> GetLogger(Type parentType)
                {
                        <span style="color:blue">return</span> LogManager.GetLogger(parentType);
                }
       }

	<span style="color:blue">public</span> <span style="color:blue">static</span> <span style="color:blue">void</span> Main(<span style="color:blue">string</span>[] args)
	{
		UnityContainer container = <span style="color:blue">new</span> UnityContainer();
		container
			.AddNewExtension&lt;BuildTracking&gt;()
			.AddNewExtension&lt;LogCreation&lt;ILog,Log4NetFactory&gt;();

		<span style="color:green">// register your other types here</span>

		ILog logger = container.Resolve&lt;ILog&gt;();
		<span style="color:blue">var</span> myCode = <span style="color:blue">new</span> MyClassWithLoggerDependency(logger);
		myCode.DoStuff();
	}
}
</pre>
</div>
<p>&nbsp;</p>
<p>Thanks for your contributions.</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_834894" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="925105">
    <td id="PostDetailsCell_925105" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post925105"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/baretomas">baretomas</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/11/2012 8:23:55 AM" LocalTimeTicks="1349969035">Oct 11, 2012 at 8:23 AM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="10/11/2012 9:14:14 AM" LocalTimeTicks="1349972054">Oct 11, 2012 at 9:14 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_925105" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;Won&#39;t&#32;your&#32;classes&#32;need&#32;to&#32;know&#32;about&#32;log4net&#32;to&#32;use&#32;its&#32;interface,&#32;which&#32;kind&#32;of&#32;defeat&#32;the&#32;point&#63;&#32;Maybe&#32;you&#32;should&#32;define&#32;your&#32;own&#32;common&#32;interface&#32;and&#32;create&#32;wrapper&#32;classes&#32;for&#32;the&#32;logging&#32;frameworks&#32;you&#32;want&#32;to&#32;support&#63;&#32;">
        
<p>Won't your classes need to know about log4net to use its interface, which kind of defeat the point?</p>
<p>Maybe you should define your own common interface and create wrapper classes for the logging frameworks you want to support?</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_925105" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="925235">
    <td id="PostDetailsCell_925235" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post925235"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/randylevy">randylevy</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/11/2012 1:36:31 PM" LocalTimeTicks="1349987791">Oct 11, 2012 at 1:36 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_925235" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="CommonLogging&#32;already&#32;supports&#32;Enterprise&#32;Library&#32;&#40;Version&#32;3,&#32;4,&#32;and&#32;5&#41;,&#32;log4Net,&#32;and&#32;NLog.&#32;&#38;nbsp&#59;It&#32;presents&#32;a&#32;log4Net&#32;type&#32;interface&#32;that&#32;works&#32;with&#32;all&#32;3&#32;frameworks&#32;and&#32;is&#32;extensible&#32;so&#32;you&#32;can&#32;create&#32;other&#32;providers.&#32;--Randy&#32;LevyEnterprise&#32;Library&#32;support&#32;engineerentlib.support&#64;live.com&#38;nbsp&#59;">
        
<p><a href="http://netcommon.sourceforge.net/" target="_self" rel="nofollow">CommonLogging</a> already supports Enterprise Library (Version 3, 4, and 5), log4Net, and NLog. &nbsp;It presents a log4Net type interface that works with all 3 frameworks and is extensible so you
 can create other providers.</p>
<p>--<br>
Randy Levy<br>
Enterprise Library support engineer<br>
<a href="mailto:entlib.support@live.com" rel="nofollow">entlib.support@live.com</a>&nbsp;</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_925235" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1067001">
    <td id="PostDetailsCell_1067001" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1067001"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/PhilMurray">PhilMurray</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="7/11/2013 12:40:15 PM" LocalTimeTicks="1373571615">Jul 11, 2013 at 12:40 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1067001" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="Very&#32;nice&#32;guys.&#32;I&#32;do&#32;have&#32;one&#32;issue&#32;though.&#32;How&#32;does&#32;the&#32;ILog&#32;instance&#32;pick&#32;up&#32;the&#32;config&#63;&#32;I&#32;have&#32;it&#32;in&#32;the&#32;App.Config&#32;section&#32;buts&#32;its&#32;not&#32;picking&#32;it&#32;up.">
        <div class="markDownOutput ">Very nice guys. I do have one issue though. How does the ILog instance pick up the config? I have it in the App.Config section buts its not picking it up.<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1067001" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1067032">
    <td id="PostDetailsCell_1067032" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1067032"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/randylevy">randylevy</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="7/11/2013 1:51:04 PM" LocalTimeTicks="1373575864">Jul 11, 2013 at 1:51 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1067032" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="You&#32;need&#32;to&#32;&#91;configure&#32;common.logging&#93;&#40;http&#58;&#47;&#47;netcommon.sourceforge.net&#47;docs&#47;2.1.0&#47;reference&#47;html&#47;ch01.html&#35;logging-declarative-config&#41;&#32;as&#32;well&#32;as&#32;Enterprise&#32;Library.&#32;&#32;It&#32;should&#32;be&#32;loaded&#32;automatically&#58;&#13;&#10;&#13;&#10;&#96;&#96;&#96;&#32;xml&#13;&#10;&#32;&#32;&#60;configSections&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#60;section&#32;name&#61;&#34;loggingConfiguration&#34;&#32;type&#61;&#34;Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.LoggingSettings,&#32;Microsoft.Practices.EnterpriseLibrary.Logging,&#32;Version&#61;5.0.505.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35&#34;&#32;requirePermission&#61;&#34;true&#34;&#47;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#60;sectionGroup&#32;name&#61;&#34;common&#34;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#60;section&#32;name&#61;&#34;logging&#34;&#32;type&#61;&#34;Common.Logging.ConfigurationSectionHandler,&#32;Common.Logging&#34;&#47;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#60;&#47;sectionGroup&#62;&#13;&#10;&#32;&#32;&#60;&#47;configSections&#62;&#13;&#10;&#32;&#32;&#60;loggingConfiguration&#32;name&#61;&#34;&#34;&#32;tracingEnabled&#61;&#34;true&#34;&#32;defaultCategory&#61;&#34;General&#34;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#60;listeners&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#60;add&#32;name&#61;&#34;Flat&#32;File&#32;Trace&#32;Listener&#34;&#32;type&#61;&#34;Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.FlatFileTraceListener,&#32;Microsoft.Practices.EnterpriseLibrary.Logging,&#32;Version&#61;5.0.505.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35&#34;&#32;listenerDataType&#61;&#34;Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.FlatFileTraceListenerData,&#32;Microsoft.Practices.EnterpriseLibrary.Logging,&#32;Version&#61;5.0.505.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35&#34;&#32;fileName&#61;&#34;errors.log&#34;&#32;formatter&#61;&#34;&#34;&#47;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#60;add&#32;name&#61;&#34;Rolling&#32;Flat&#32;File&#32;Trace&#32;Listener&#34;&#32;type&#61;&#34;Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.RollingFlatFileTraceListener,&#32;Microsoft.Practices.EnterpriseLibrary.Logging,&#32;Version&#61;5.0.505.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35&#34;&#32;listenerDataType&#61;&#34;Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.RollingFlatFileTraceListenerData,&#32;Microsoft.Practices.EnterpriseLibrary.Logging,&#32;Version&#61;5.0.505.0,&#32;Culture&#61;neutral,&#32;PublicKeyToken&#61;31bf3856ad364e35&#34;&#32;fileName&#61;&#34;rolling.log&#34;&#32;formatter&#61;&#34;&#34;&#32;rollInterval&#61;&#34;Midnight&#34;&#32;maxArchivedFiles&#61;&#34;7&#34;&#47;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#60;&#47;listeners&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#60;formatters&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#60;&#47;formatters&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#60;categorySources&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#60;add&#32;switchValue&#61;&#34;All&#34;&#32;name&#61;&#34;General&#34;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#60;listeners&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#60;add&#32;name&#61;&#34;Rolling&#32;Flat&#32;File&#32;Trace&#32;Listener&#34;&#47;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#60;&#47;listeners&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#60;&#47;add&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#60;&#47;categorySources&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#60;specialSources&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#60;allEvents&#32;switchValue&#61;&#34;All&#34;&#32;name&#61;&#34;All&#32;Events&#34;&#47;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#60;notProcessed&#32;switchValue&#61;&#34;All&#34;&#32;name&#61;&#34;Unprocessed&#32;Category&#34;&#47;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#60;errors&#32;switchValue&#61;&#34;All&#34;&#32;name&#61;&#34;Logging&#32;Errors&#32;&#38;amp&#59;&#32;Warnings&#34;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#60;listeners&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#60;add&#32;name&#61;&#34;Flat&#32;File&#32;Trace&#32;Listener&#34;&#47;&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#60;&#47;listeners&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#60;&#47;errors&#62;&#13;&#10;&#32;&#32;&#32;&#32;&#60;&#47;specialSources&#62;&#13;&#10;&#32;&#32;&#60;&#47;loggingConfiguration&#62;&#13;&#10;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#13;&#10;&#126;&#126;&#13;&#10;Randy&#32;Levy&#13;&#10;&#91;entlib.support&#64;live.com&#93;&#40;mailto&#58;entlib.support&#64;live.com&#41;&#13;&#10;Enterprise&#32;Library&#32;support&#32;engineer&#13;&#10;&#91;Support&#32;How-to&#93;&#40;http&#58;&#47;&#47;entlib.codeplex.com&#47;wikipage&#63;title&#61;Support&#37;20How-to&#41;&#32;">
        <div class="markDownOutput ">You need to <a href="http://netcommon.sourceforge.net/docs/2.1.0/reference/html/ch01.html#logging-declarative-config"  rel="nofollow">
configure common.logging</a> as well as Enterprise Library. It should be loaded automatically:<br>
<div style="color:Black; background-color:White">
<pre>
  <span style="color:Blue">&lt;</span><span style="color:#A31515">configSections</span><span style="color:Blue">&gt;</span>
    <span style="color:Blue">&lt;</span><span style="color:#A31515">section</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">loggingConfiguration</span><span style="color:Black">&quot;</span> <span style="color:Red">type</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.LoggingSettings, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.505.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35</span><span style="color:Black">&quot;</span> <span style="color:Red">requirePermission</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">true</span><span style="color:Black">&quot;</span><span style="color:Blue">/&gt;</span>
    <span style="color:Blue">&lt;</span><span style="color:#A31515">sectionGroup</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">common</span><span style="color:Black">&quot;</span><span style="color:Blue">&gt;</span>
      <span style="color:Blue">&lt;</span><span style="color:#A31515">section</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">logging</span><span style="color:Black">&quot;</span> <span style="color:Red">type</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Common.Logging.ConfigurationSectionHandler, Common.Logging</span><span style="color:Black">&quot;</span><span style="color:Blue">/&gt;</span>
    <span style="color:Blue">&lt;/</span><span style="color:#A31515">sectionGroup</span><span style="color:Blue">&gt;</span>
  <span style="color:Blue">&lt;/</span><span style="color:#A31515">configSections</span><span style="color:Blue">&gt;</span>
  <span style="color:Blue">&lt;</span><span style="color:#A31515">loggingConfiguration</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">&quot; tracingEnabled=&quot;true</span><span style="color:Black">&quot;</span> <span style="color:Red">defaultCategory</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">General</span><span style="color:Black">&quot;</span><span style="color:Blue">&gt;</span>
    <span style="color:Blue">&lt;</span><span style="color:#A31515">listeners</span><span style="color:Blue">&gt;</span>
      <span style="color:Blue">&lt;</span><span style="color:#A31515">add</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Flat File Trace Listener</span><span style="color:Black">&quot;</span> <span style="color:Red">type</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.FlatFileTraceListener, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.505.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35</span><span style="color:Black">&quot;</span> <span style="color:Red">listenerDataType</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.FlatFileTraceListenerData, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.505.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35</span><span style="color:Black">&quot;</span> <span style="color:Red">fileName</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">errors.log&quot; formatter=&quot;</span><span style="color:Black">&quot;</span><span style="color:Blue">/&gt;</span>
      <span style="color:Blue">&lt;</span><span style="color:#A31515">add</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Rolling Flat File Trace Listener</span><span style="color:Black">&quot;</span> <span style="color:Red">type</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.RollingFlatFileTraceListener, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.505.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35</span><span style="color:Black">&quot;</span> <span style="color:Red">listenerDataType</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.RollingFlatFileTraceListenerData, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.505.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35</span><span style="color:Black">&quot;</span> <span style="color:Red">fileName</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">rolling.log</span><span style="color:Black">&quot;</span> <span style="color:Red">formatter</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">&quot; rollInterval=&quot;Midnight</span><span style="color:Black">&quot;</span> <span style="color:Red">maxArchivedFiles</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">7</span><span style="color:Black">&quot;</span><span style="color:Blue">/&gt;</span>
    <span style="color:Blue">&lt;/</span><span style="color:#A31515">listeners</span><span style="color:Blue">&gt;</span>
    <span style="color:Blue">&lt;</span><span style="color:#A31515">formatters</span><span style="color:Blue">&gt;</span>
    <span style="color:Blue">&lt;/</span><span style="color:#A31515">formatters</span><span style="color:Blue">&gt;</span>
    <span style="color:Blue">&lt;</span><span style="color:#A31515">categorySources</span><span style="color:Blue">&gt;</span>
      <span style="color:Blue">&lt;</span><span style="color:#A31515">add</span> <span style="color:Red">switchValue</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">All</span><span style="color:Black">&quot;</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">General</span><span style="color:Black">&quot;</span><span style="color:Blue">&gt;</span>
        <span style="color:Blue">&lt;</span><span style="color:#A31515">listeners</span><span style="color:Blue">&gt;</span>
          <span style="color:Blue">&lt;</span><span style="color:#A31515">add</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Rolling Flat File Trace Listener</span><span style="color:Black">&quot;</span><span style="color:Blue">/&gt;</span>
        <span style="color:Blue">&lt;/</span><span style="color:#A31515">listeners</span><span style="color:Blue">&gt;</span>
      <span style="color:Blue">&lt;/</span><span style="color:#A31515">add</span><span style="color:Blue">&gt;</span>
    <span style="color:Blue">&lt;/</span><span style="color:#A31515">categorySources</span><span style="color:Blue">&gt;</span>
    <span style="color:Blue">&lt;</span><span style="color:#A31515">specialSources</span><span style="color:Blue">&gt;</span>
      <span style="color:Blue">&lt;</span><span style="color:#A31515">allEvents</span> <span style="color:Red">switchValue</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">All</span><span style="color:Black">&quot;</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">All Events</span><span style="color:Black">&quot;</span><span style="color:Blue">/&gt;</span>
      <span style="color:Blue">&lt;</span><span style="color:#A31515">notProcessed</span> <span style="color:Red">switchValue</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">All</span><span style="color:Black">&quot;</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Unprocessed Category</span><span style="color:Black">&quot;</span><span style="color:Blue">/&gt;</span>
      <span style="color:Blue">&lt;</span><span style="color:#A31515">errors</span> <span style="color:Red">switchValue</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">All</span><span style="color:Black">&quot;</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Logging Errors &amp;amp; Warnings</span><span style="color:Black">&quot;</span><span style="color:Blue">&gt;</span>
        <span style="color:Blue">&lt;</span><span style="color:#A31515">listeners</span><span style="color:Blue">&gt;</span>
          <span style="color:Blue">&lt;</span><span style="color:#A31515">add</span> <span style="color:Red">name</span><span style="color:Blue">=</span><span style="color:Black">&quot;</span><span style="color:Blue">Flat File Trace Listener</span><span style="color:Black">&quot;</span><span style="color:Blue">/&gt;</span>
        <span style="color:Blue">&lt;/</span><span style="color:#A31515">listeners</span><span style="color:Blue">&gt;</span>
      <span style="color:Blue">&lt;/</span><span style="color:#A31515">errors</span><span style="color:Blue">&gt;</span>
    <span style="color:Blue">&lt;/</span><span style="color:#A31515">specialSources</span><span style="color:Blue">&gt;</span>
  <span style="color:Blue">&lt;/</span><span style="color:#A31515">loggingConfiguration</span><span style="color:Blue">&gt;</span>

</pre>
</div>
~~ <br>
Randy Levy <br>
<a href="mailto:entlib.support@live.com" rel="nofollow">&#x65;n&#x74;&#108;&#105;&#x62;&#46;&#115;&#x75;&#112;&#112;&#x6f;&#x72;&#x74;&#x40;&#x6c;&#x69;&#118;&#x65;&#x2e;c&#x6f;&#x6d;</a>
<br>
Enterprise Library support engineer <br>
<a href="http://entlib.codeplex.com/wikipage?title=Support%20How-to"  rel="nofollow">Support How-to</a>
<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1067032" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1067044">
    <td id="PostDetailsCell_1067044" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1067044"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/ThunderEagle">ThunderEagle</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="7/11/2013 2:07:35 PM" LocalTimeTicks="1373576855">Jul 11, 2013 at 2:07 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1067044" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="&#42;&#42;PhilMurray&#32;wrote&#58;&#42;&#42;&#13;&#10;&#62;&#32;Very&#32;nice&#32;guys.&#32;I&#32;do&#32;have&#32;one&#32;issue&#32;though.&#32;How&#32;does&#32;the&#32;ILog&#32;instance&#32;pick&#32;up&#32;the&#32;config&#63;&#32;I&#32;have&#32;it&#32;in&#32;the&#32;App.Config&#32;section&#32;buts&#32;its&#32;not&#32;picking&#32;it&#32;up.&#13;&#10;&#13;&#10;In&#32;my&#32;particular&#32;case,&#32;I&#32;explicitly&#32;configure&#32;it&#32;in&#32;my&#32;startup&#32;code.&#13;&#10;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#47;&#47;logging&#32;configuration&#13;&#10;FileInfo&#32;logConfig&#32;&#61;&#32;new&#32;FileInfo&#40;&#34;log4net.config&#34;&#41;&#59;&#13;&#10;if&#40;logConfig.Exists&#41;&#32;&#123;&#13;&#10;&#9;XmlConfigurator.Configure&#40;logConfig&#41;&#59;&#13;&#10;&#125;&#13;&#10;&#96;&#96;&#96;">
        <div class="markDownOutput "><strong>PhilMurray wrote:</strong><br>
<blockquote>Very nice guys. I do have one issue though. How does the ILog instance pick up the config? I have it in the App.Config section buts its not picking it up.<br>
</blockquote>
In my particular case, I explicitly configure it in my startup code.<br>
<pre><code>//logging configuration
FileInfo logConfig = new FileInfo(&quot;log4net.config&quot;);
if(logConfig.Exists) {
    XmlConfigurator.Configure(logConfig);
}</code></pre>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1067044" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1067048">
    <td id="PostDetailsCell_1067048" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1067048"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/PhilMurray">PhilMurray</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="7/11/2013 2:13:09 PM" LocalTimeTicks="1373577189">Jul 11, 2013 at 2:13 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1067048" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="Thanks&#32;ThunderEagle.&#32;&#13;&#10;&#13;&#10;I&#32;figured&#32;that&#32;one&#32;out.">
        <div class="markDownOutput ">Thanks ThunderEagle. <br>
<br>
I figured that one out.<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1067048" class="Options" >
            
        </div>
        
    </td>
</tr>

</table>
    </div>

    
        <div class="StandardMarginTop">
            <a id="SignInToAddCommentLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2funity.codeplex.com%2fdiscussions%2f203744">
                Sign in to post message or set email notifications
            </a>
        </div>
    


    <div id="PostEditorContainer">
        <a name="editor"></a>
        <div id="Editor" style="display: none;">
            

<div class="MarkdownEditor" data-options-id="294fa8c8-7a2a-4b44-82e9-705752982a0e">
    <script class="options" defer="defer" id="294fa8c8-7a2a-4b44-82e9-705752982a0e" type="application/json">{"maxLength":10000,"styleSheetLocation":""}</script>

    <div class="MarkdownEditorControls">
        <a href="#" tabindex="-1" class="control md_help" title="Markdown Syntax Guide"></a>
        <div class="control md_divider"></div>
        <a href="#" tabindex="-1" class="control md_header" title="Insert Header (CTRL + H)"></a>
        <a href="#" tabindex="-1" class="control md_code" title="Insert Code (CTRL + K)"></a>
        <a href="#" tabindex="-1" class="control md_quote" title="Insert Quote (CTRL + Q)"></a>
        <a href="#" tabindex="-1" class="control md_img" title="Insert Img (CTRL + G)"></a>
        <a href="#" tabindex="-1" class="control md_link" title="Insert Link (CTRL + L)"></a>
        <a href="#" tabindex="-1" class="control md_ulist" title="Unordered List (CTRL + U)"></a>
        <a href="#" tabindex="-1" class="control md_olist" title="Ordered List (CTRL + O)"></a>
        <a href="#" tabindex="-1" class="control md_italics" title="Italic Text (CTRL + I)"></a>
        <a href="#" tabindex="-1" class="control md_bold" title="Bold Text (CTRL + B)"></a>
    </div>

    

<div class="tab_control">
    <!-- Generate the basic HTML for the tabs. -->
    
        <div id="Compose"
              class="tab selected"
              data-custom-header-id=""
              data-tab-contents-id="compose_contents_fc9d1e38-96bc-43af-9028-c740622d378b">
            Compose
        </div>
    
        <div id="Preview"
              class="tab "
              data-custom-header-id=""
              data-tab-contents-id="preview_contents_b6fb276a-55fb-4897-8cb3-0a6eebe499f4">
            Preview
        </div>
    
    <div class="clear"></div>
</div>


    <div id="compose_contents_fc9d1e38-96bc-43af-9028-c740622d378b" class="compose_tab_content">
        <textarea class=" MarkdownEditorDimensions" cols="20" id="MarkdownEditor" name="content" rows="2">
</textarea>
        <div class="ClearBoth"></div>

        <div class="markdownGuide" style="display: none">
            <table>
                <tr>
                    <td class="markdownGuideColumn">
                        <h1>Text Formatting</h1>
                        <div># Header 1</div>
                        <div>## Header 2</div>
                        <br />
                        <div>*italics* (or _italics_)</div>
                        <div>**bold** (or __bold__)</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Lists</h1>
                        <div>* Unordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp * SubItem</div>
                        <br />
                        <div>1. Ordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 1. SubItem</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Quotes</h1>
                        <div>> Lorem ipsum</div>
                        <div>dolor sitamet </div>
                        <div>non. Lectus at</div>
                        <div>nam nunc...</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Code</h1>
                        <div>`Inline Code`</div>
                        <br />
                        <div>``` C#</div>
                        <div>if (foo==bar)</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbspbar++</div>
                        <div>```</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>References</h1>
                        <div>[Link Text](URL)</div>
                        <br />
                        <div>![Image](URL)</div>
                        <br />
                        <a class="Reference" target="_blank" href="http://codeplex.codeplex.com/wikipage?title=Markdown&referringTitle=Documentation">Markdown Reference</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div id="preview_contents_b6fb276a-55fb-4897-8cb3-0a6eebe499f4" class="preview_tab_content markDownOutput">
        
            <div></div>
        
    </div>
    <div class="clear"></div>
</div>

            
            <div class="row" id="recaptcha_row">
                
<script type="text/javascript">
    $(document).ready(function () {
        $('#recaptcha_reload').attr('src', '../assets/recaptcha_refresh.png');
        $('#recaptcha_switch_audio').attr('src', '../assets/recaptcha_audio.png');
        $('#recaptcha_switch_img').attr('src', '../assets/recaptcha_text.png');
        $('#recaptcha_whatsthis').attr('src', '../assets/recaptcha_help.png');
        $('#recaptcha_area tr:first').attr('height', '35');
    });
</script>

                <div class="clear"></div>
                <span id="ReCaptchaError"></span>
            </div>
            <div style="padding-top: 6px;">
                <input type="button" id="SaveButton" value="Save" class="ok" />
                <input type="button" id="CancelButton" value="Cancel" class="cancel" />
                <div class="clear"></div>
            </div>
        </div>
    </div>
</div>

<div id="DeletePostPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Post <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this post? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="ClosePostCancel" value="Cancel" class="cancel" />
            <input type="button" id="ClosePostOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>
        
            <!-- Email notification / Subscription details -->
            
    </div>
</div>
    
<div id="DeleteThreadPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Thread <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this thread? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="CloseThreadCancel" value="Cancel" class="cancel" />
            <input type="button" id="CloseThreadOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>

<script type="text/javascript" language="javascript">
    $(function () {

        $('#recaptcha_response_field')
            .bind('keypress', function (event) { return $submitKeyPressElement(this, event); });


        if ($('#DeleteThreadLink')) {
            $('#DeleteThreadLink').click(function () {
                OpenDialog('#DeleteThreadPanel', true, '41em');
            });
        }
        
        $('#DeleteThreadPanel #CloseThreadOk').click(function () {
            var url = 'http://unity.codeplex.com/discussions/203744';
            $.ajax({
                url: url,
                type: 'DELETE',
                success: function (x) {
                    location.href = x.RedirectUrl;
                }
            });
        });
    });

    workItemMention = new codeplex.ui.WorkItemMention();
    workItemMention.addLinks(".discussionPost");
</script>


        
        
                
                <div class="clear"></div>
                
                <div id="footer">
                    <div class="row">
                        <hr />
                        <ul>
                            <li>Â© 2006-2017 Microsoft</li>
                            <li><a href="http://www.codeplex.com/site/help">Get Help</a></li>
                            <li><a href="/site/legal/privacy">Privacy Statement</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/terms">Terms of Use</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/conduct">Code of Conduct</a></li>
                            <li><a href="http://developermedia.com/" target="_blank">Advertise With Us</a></li>
                            <li>Version 2017.10.3.21062</li>
                        </ul>
                    </div>
                </div>
            </div>
        </form>
    </body>

</html>